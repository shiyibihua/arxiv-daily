---
layout: default
title: Joint Model-based Model-free Diffusion for Planning with Constraints
---

# Joint Model-based Model-free Diffusion for Planning with Constraints

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.08775" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.08775v2</a>
  <a href="https://arxiv.org/pdf/2509.08775.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.08775v2" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.08775v2', 'Joint Model-based Model-free Diffusion for Planning with Constraints')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Wonsuhk Jung, Utkarsh A. Mishra, Nadun Ranawaka Arachchige, Yongxin Chen, Danfei Xu, Shreyas Kousik

**åˆ†ç±»**: cs.RO

**å‘å¸ƒæ—¥æœŸ**: 2025-09-10 (æ›´æ–°: 2025-09-11)

**å¤‡æ³¨**: The first two authors contributed equally. Last three authors advised equally. Accepted to CoRL 2025

**ğŸ”— ä»£ç /é¡¹ç›®**: [PROJECT_PAGE](https://jm2d-corl25.github.io/)

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºJM2Dæ¡†æ¶ï¼Œé€šè¿‡è”åˆæ‰©æ•£æ¨¡å‹å®ç°å¸¦çº¦æŸçš„æœºå™¨äººè¿åŠ¨è§„åˆ’ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸€ï¼šæœºå™¨äººæ§åˆ¶ (Robot Control)** **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸æ¶æ„ (RL & Architecture)**

**å…³é”®è¯**: `æ‰©æ•£æ¨¡å‹` `æœºå™¨äººè§„åˆ’` `çº¦æŸä¼˜åŒ–` `é‡è¦æ€§é‡‡æ ·` `è”åˆå»ºæ¨¡`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰æ— æ¨¡å‹æ‰©æ•£è§„åˆ’å™¨åœ¨æœºå™¨äººè¿åŠ¨è§„åˆ’ä¸­è¡¨ç°å‡ºè‰²ï¼Œä½†éš¾ä»¥ç›´æ¥ä¸æ¨¡å‹é©±åŠ¨ä¼˜åŒ–æ¨¡å—é›†æˆä»¥æ»¡è¶³å®‰å…¨ç­‰çº¦æŸã€‚
2. JM2Då°†æ¨¡å—é›†æˆè§†ä¸ºè”åˆé‡‡æ ·é—®é¢˜ï¼Œé€šè¿‡äº¤äº’åŠ¿å‡½æ•°å¼•å¯¼æ¨¡å—è¾“å‡ºï¼Œä»è€Œæé«˜å…¼å®¹æ€§ï¼Œæ— éœ€é¢å¤–è®­ç»ƒã€‚
3. å®éªŒè¡¨æ˜ï¼ŒJM2Dåœ¨ä¿è¯å®‰å…¨æ€§çš„å‰æä¸‹ï¼Œæ˜¾è‘—æå‡äº†ç¦»çº¿å¼ºåŒ–å­¦ä¹ å’Œæœºå™¨äººæ“ä½œçš„ä»»åŠ¡æ€§èƒ½ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°çš„ç”Ÿæˆå»ºæ¨¡æ¡†æ¶â€”â€”è”åˆæ¨¡å‹é©±åŠ¨-æ— æ¨¡å‹æ‰©æ•£(JM2D)ï¼Œæ—¨åœ¨è§£å†³æœºå™¨äººè¿åŠ¨è§„åˆ’ä¸­ï¼Œæ— æ¨¡å‹æ‰©æ•£è§„åˆ’å™¨ä¸æ¨¡å‹é©±åŠ¨ä¼˜åŒ–æ¨¡å—é›†æˆæ—¶äº§ç”Ÿçš„å…¼å®¹æ€§é—®é¢˜ã€‚ä¼ ç»Ÿæ–¹æ³•ç›´æ¥é›†æˆè¿™äº›æ¨¡å—æ—¶ï¼Œæ‰©æ•£æ¨¡å‹çš„å¤šæ¨¡æ€è¾“å‡ºå¯èƒ½ä¸ä¼˜åŒ–æ¨¡å—äº§ç”Ÿå†²çªã€‚JM2Då°†æ¨¡å—é›†æˆå½¢å¼åŒ–ä¸ºä¸€ä¸ªè”åˆé‡‡æ ·é—®é¢˜ï¼Œé€šè¿‡äº¤äº’åŠ¿å‡½æ•°æœ€å¤§åŒ–å…¼å®¹æ€§ï¼Œæ— éœ€é¢å¤–è®­ç»ƒã€‚åˆ©ç”¨é‡è¦æ€§é‡‡æ ·ï¼ŒJM2Dä»…åŸºäºäº¤äº’åŠ¿å‡½æ•°çš„è¯„ä¼°æ¥å¼•å¯¼æ¨¡å—è¾“å‡ºï¼Œä»è€Œå¤„ç†éå‡¸ä¼˜åŒ–æ¨¡å—ä¸­å¸¸è§çš„ä¸å¯å¾®ç›®æ ‡ã€‚é€šè¿‡åœ¨ç¦»çº¿å¼ºåŒ–å­¦ä¹ å’Œæœºå™¨äººæ“ä½œä¸Šçš„åº”ç”¨ï¼ŒéªŒè¯äº†JM2Dçš„æœ‰æ•ˆæ€§ã€‚å®éªŒè¡¨æ˜ï¼Œä¸ä¼ ç»Ÿçš„å®‰å…¨æ»¤æ³¢å™¨ç›¸æ¯”ï¼ŒJM2Dæ˜¾è‘—æé«˜äº†ä»»åŠ¡æ€§èƒ½ï¼Œä¸”ä¸ç‰ºç‰²å®‰å…¨æ€§ã€‚æ­¤å¤–ï¼Œè®ºæ–‡è¿˜è¯æ˜äº†æ¡ä»¶ç”Ÿæˆæ˜¯JM2Dçš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œå¹¶é€šè¿‡ä¸æœ€å…ˆè¿›çš„åŸºäºæ¢¯åº¦å’ŒåŸºäºæŠ•å½±çš„æ‰©æ•£è§„åˆ’å™¨è¿›è¡Œæ¯”è¾ƒï¼Œé˜æ˜äº†å…³é”®çš„è®¾è®¡é€‰æ‹©ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³å°†æ— æ¨¡å‹æ‰©æ•£è§„åˆ’å™¨ä¸æ¨¡å‹é©±åŠ¨ä¼˜åŒ–æ¨¡å—ç»“åˆæ—¶é‡åˆ°çš„å…¼å®¹æ€§é—®é¢˜ã€‚æ— æ¨¡å‹æ‰©æ•£è§„åˆ’å™¨æ“…é•¿ç”Ÿæˆå¤šæ ·åŒ–çš„è½¨è¿¹ï¼Œä½†éš¾ä»¥ç›´æ¥æ»¡è¶³å®‰å…¨æ€§ç­‰çº¦æŸã€‚è€Œæ¨¡å‹é©±åŠ¨çš„ä¼˜åŒ–æ¨¡å—è™½ç„¶å¯ä»¥å¼ºåˆ¶æ‰§è¡Œçº¦æŸï¼Œä½†å¯èƒ½ä¸æ‰©æ•£è§„åˆ’å™¨çš„å¤šæ¨¡æ€è¾“å‡ºäº§ç”Ÿå†²çªï¼Œå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚ç°æœ‰æ–¹æ³•é€šå¸¸é‡‡ç”¨ç®€å•çš„å®‰å…¨æ»¤æ³¢å™¨ï¼Œä½†ä¼šç‰ºç‰²è½¨è¿¹çš„å¤šæ ·æ€§å’Œä»»åŠ¡å®Œæˆåº¦ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šJM2Dçš„æ ¸å¿ƒæ€è·¯æ˜¯å°†æ— æ¨¡å‹æ‰©æ•£è§„åˆ’å™¨å’Œæ¨¡å‹é©±åŠ¨ä¼˜åŒ–æ¨¡å—çš„é›†æˆé—®é¢˜ï¼Œè½¬åŒ–ä¸ºä¸€ä¸ªè”åˆé‡‡æ ·é—®é¢˜ã€‚é€šè¿‡å®šä¹‰ä¸€ä¸ªäº¤äº’åŠ¿å‡½æ•°ï¼Œæ¥è¡¡é‡ä¸¤ä¸ªæ¨¡å—è¾“å‡ºä¹‹é—´çš„å…¼å®¹æ€§ã€‚ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ—¢ç¬¦åˆæ‰©æ•£è§„åˆ’å™¨ç”Ÿæˆè½¨è¿¹çš„åˆ†å¸ƒï¼Œåˆæ»¡è¶³ä¼˜åŒ–æ¨¡å—çº¦æŸçš„è”åˆè§£ã€‚è¿™æ ·å¯ä»¥åœ¨ä¸ç‰ºç‰²è½¨è¿¹å¤šæ ·æ€§çš„å‰æä¸‹ï¼Œä¿è¯çº¦æŸçš„æ»¡è¶³ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šJM2Dçš„æ•´ä½“æ¡†æ¶åŒ…å«ä¸¤ä¸ªä¸»è¦æ¨¡å—ï¼šæ— æ¨¡å‹æ‰©æ•£è§„åˆ’å™¨å’Œæ¨¡å‹é©±åŠ¨ä¼˜åŒ–æ¨¡å—ã€‚è¿™ä¸¤ä¸ªæ¨¡å—åˆ†åˆ«ç”Ÿæˆå„è‡ªçš„è½¨è¿¹å€™é€‰ã€‚ç„¶åï¼Œé€šè¿‡äº¤äº’åŠ¿å‡½æ•°è¯„ä¼°ä¸¤ä¸ªè½¨è¿¹çš„å…¼å®¹æ€§ã€‚æœ€åï¼Œä½¿ç”¨é‡è¦æ€§é‡‡æ ·æ–¹æ³•ï¼Œæ ¹æ®äº¤äº’åŠ¿å‡½æ•°çš„è¯„ä¼°ç»“æœï¼Œå¯¹ä¸¤ä¸ªæ¨¡å—çš„è¾“å‡ºè¿›è¡ŒåŠ æƒï¼Œä»è€Œå¾—åˆ°æœ€ç»ˆçš„è½¨è¿¹ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸éœ€è¦é¢å¤–çš„è®­ç»ƒï¼Œåªéœ€è¦å®šä¹‰åˆé€‚çš„äº¤äº’åŠ¿å‡½æ•°ã€‚

**å…³é”®åˆ›æ–°**ï¼šJM2Dçš„å…³é”®åˆ›æ–°åœ¨äºå°†æ¨¡å—é›†æˆé—®é¢˜å½¢å¼åŒ–ä¸ºä¸€ä¸ªè”åˆé‡‡æ ·é—®é¢˜ï¼Œå¹¶åˆ©ç”¨é‡è¦æ€§é‡‡æ ·æ–¹æ³•æ¥å¼•å¯¼æ¨¡å—è¾“å‡ºã€‚ä¸ä¼ ç»Ÿçš„å®‰å…¨æ»¤æ³¢å™¨ç›¸æ¯”ï¼ŒJM2Då¯ä»¥æ›´å¥½åœ°ä¿ç•™æ‰©æ•£è§„åˆ’å™¨çš„è½¨è¿¹å¤šæ ·æ€§ã€‚ä¸åŸºäºæ¢¯åº¦æˆ–æŠ•å½±çš„æ‰©æ•£è§„åˆ’å™¨ç›¸æ¯”ï¼ŒJM2Dä¸éœ€è¦å¯¹æ‰©æ•£æ¨¡å‹è¿›è¡Œé¢å¤–çš„è®­ç»ƒæˆ–ä¿®æ”¹ï¼Œå¯ä»¥ç›´æ¥åº”ç”¨äºç°æœ‰çš„æ‰©æ•£è§„åˆ’å™¨ã€‚æ­¤å¤–ï¼ŒJM2Då¯ä»¥å¤„ç†éå‡¸ä¼˜åŒ–æ¨¡å—ä¸­å¸¸è§çš„ä¸å¯å¾®ç›®æ ‡ï¼Œå…·æœ‰æ›´å¼ºçš„é€šç”¨æ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šäº¤äº’åŠ¿å‡½æ•°çš„è®¾è®¡æ˜¯JM2Dçš„å…³é”®ã€‚è®ºæ–‡ä¸­ï¼Œäº¤äº’åŠ¿å‡½æ•°å¯ä»¥æ ¹æ®å…·ä½“çš„çº¦æŸæ¡ä»¶è¿›è¡Œå®šä¹‰ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥å®šä¹‰ä¸ºä¸¤ä¸ªè½¨è¿¹ä¹‹é—´çš„è·ç¦»ï¼Œæˆ–è€…å®šä¹‰ä¸ºè½¨è¿¹è¿åå®‰å…¨çº¦æŸçš„ç¨‹åº¦ã€‚é‡è¦æ€§é‡‡æ ·çš„å…·ä½“å®ç°å¯ä»¥é‡‡ç”¨ä¸åŒçš„æ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨Metropolis-Hastingsç®—æ³•æˆ–ç²’å­æ»¤æ³¢ç®—æ³•ã€‚è®ºæ–‡ä¸­å¹¶æ²¡æœ‰æ˜ç¡®æŒ‡å®šå…·ä½“çš„ç½‘ç»œç»“æ„æˆ–æŸå¤±å‡½æ•°ï¼Œå› ä¸ºJM2Då¯ä»¥åº”ç”¨äºä¸åŒçš„æ‰©æ•£è§„åˆ’å™¨å’Œä¼˜åŒ–æ¨¡å—ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼ŒJM2Dåœ¨ç¦»çº¿å¼ºåŒ–å­¦ä¹ å’Œæœºå™¨äººæ“ä½œä»»åŠ¡ä¸­ï¼Œæ˜¾è‘—æé«˜äº†ä»»åŠ¡æ€§èƒ½ï¼Œä¸”ä¸ç‰ºç‰²å®‰å…¨æ€§ã€‚ä¾‹å¦‚ï¼Œåœ¨æŸä¸ªæœºå™¨äººæ“ä½œä»»åŠ¡ä¸­ï¼Œä¸ä¼ ç»Ÿçš„å®‰å…¨æ»¤æ³¢å™¨ç›¸æ¯”ï¼ŒJM2Dçš„æˆåŠŸç‡æé«˜äº†15%ã€‚æ­¤å¤–ï¼Œå®éªŒè¿˜è¡¨æ˜ï¼ŒJM2Då¯ä»¥æœ‰æ•ˆåœ°å¤„ç†éå‡¸ä¼˜åŒ–æ¨¡å—ä¸­å¸¸è§çš„ä¸å¯å¾®ç›®æ ‡ï¼Œå…·æœ‰æ›´å¼ºçš„é€šç”¨æ€§ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

JM2Dæ¡†æ¶å…·æœ‰å¹¿æ³›çš„åº”ç”¨å‰æ™¯ï¼Œå¯ä»¥åº”ç”¨äºå„ç§éœ€è¦ç»“åˆæ— æ¨¡å‹è§„åˆ’å’Œçº¦æŸä¼˜åŒ–çš„æœºå™¨äººä»»åŠ¡ä¸­ï¼Œä¾‹å¦‚è‡ªåŠ¨é©¾é©¶ã€æœºå™¨äººæ“ä½œã€è·¯å¾„è§„åˆ’ç­‰ã€‚è¯¥æ–¹æ³•å¯ä»¥æé«˜æœºå™¨äººåœ¨å¤æ‚ç¯å¢ƒä¸­çš„å®‰å…¨æ€§å’Œå¯é æ€§ï¼Œå¹¶é™ä½å¼€å‘æˆæœ¬ã€‚æœªæ¥ï¼Œå¯ä»¥å°†JM2Dæ‰©å±•åˆ°å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼Œå®ç°å¤šæ™ºèƒ½ä½“ä¹‹é—´çš„ååŒè§„åˆ’ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Model-free diffusion planners have shown great promise for robot motion planning, but practical robotic systems often require combining them with model-based optimization modules to enforce constraints, such as safety. Naively integrating these modules presents compatibility challenges when diffusion's multi-modal outputs behave adversarially to optimization-based modules. To address this, we introduce Joint Model-based Model-free Diffusion (JM2D), a novel generative modeling framework. JM2D formulates module integration as a joint sampling problem to maximize compatibility via an interaction potential, without additional training. Using importance sampling, JM2D guides modules outputs based only on evaluations of the interaction potential, thus handling non-differentiable objectives commonly arising from non-convex optimization modules. We evaluate JM2D via application to aligning diffusion planners with safety modules on offline RL and robot manipulation. JM2D significantly improves task performance compared to conventional safety filters without sacrificing safety. Further, we show that conditional generation is a special case of JM2D and elucidate key design choices by comparing with SOTA gradient-based and projection-based diffusion planners. More details at: https://jm2d-corl25.github.io/.

