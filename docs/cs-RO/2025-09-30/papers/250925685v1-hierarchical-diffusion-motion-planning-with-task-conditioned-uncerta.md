---
layout: default
title: Hierarchical Diffusion Motion Planning with Task-Conditioned Uncertainty-Aware Priors
---

# Hierarchical Diffusion Motion Planning with Task-Conditioned Uncertainty-Aware Priors

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.25685" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.25685v1</a>
  <a href="https://arxiv.org/pdf/2509.25685.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.25685v1" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.25685v1', 'Hierarchical Diffusion Motion Planning with Task-Conditioned Uncertainty-Aware Priors')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Amelie Minji Kim, Anqi Wu, Ye Zhao

**åˆ†ç±»**: cs.RO

**å‘å¸ƒæ—¥æœŸ**: 2025-09-30

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºå±‚çº§æ‰©æ•£è¿åŠ¨è§„åˆ’æ–¹æ³•ï¼Œåˆ©ç”¨ä»»åŠ¡æ¡ä»¶çš„ä¸ç¡®å®šæ€§æ„ŸçŸ¥å…ˆéªŒæå‡è§„åˆ’æ•ˆæœã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸€ï¼šæœºå™¨äººæ§åˆ¶ (Robot Control)**

**å…³é”®è¯**: `æ‰©æ•£æ¨¡å‹` `è¿åŠ¨è§„åˆ’` `æœºå™¨äºº` `é«˜æ–¯è¿‡ç¨‹` `ä»»åŠ¡æ¡ä»¶` `å±‚çº§è§„åˆ’` `ä¸ç¡®å®šæ€§æ„ŸçŸ¥`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ä¼ ç»Ÿæ‰©æ•£è¿åŠ¨è§„åˆ’å™¨ä½¿ç”¨é›¶å‡å€¼é«˜æ–¯å™ªå£°ï¼Œå¿½ç•¥äº†ä»»åŠ¡ä¿¡æ¯å’Œè¿åŠ¨ç»“æ„ï¼Œå¯¼è‡´è§„åˆ’æ•ˆç‡å’Œè´¨é‡å—é™ã€‚
2. è¯¥æ–¹æ³•æå‡ºå±‚çº§æ‰©æ•£è§„åˆ’å™¨ï¼Œåˆ©ç”¨é«˜æ–¯è¿‡ç¨‹è¿åŠ¨è§„åˆ’ï¼ˆGPMPï¼‰ç”Ÿæˆä»»åŠ¡æ¡ä»¶ç»“æ„åŒ–é«˜æ–¯å…ˆéªŒï¼ŒæŒ‡å¯¼è½¨è¿¹ç”Ÿæˆã€‚
3. å®éªŒè¡¨æ˜ï¼Œè¯¥æ–¹æ³•åœ¨æˆåŠŸç‡ã€è½¨è¿¹å¹³æ»‘æ€§å’Œä»»åŠ¡å¯¹é½æ–¹é¢ä¼˜äºä¼ ç»Ÿæ–¹æ³•ï¼Œå¹¶éªŒè¯äº†ç»“æ„åŒ–æ‰°åŠ¨çš„æœ‰æ•ˆæ€§ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°é¢–çš„å±‚çº§æ‰©æ•£è§„åˆ’å™¨ï¼Œå®ƒå°†ä»»åŠ¡å’Œè¿åŠ¨ç»“æ„ç›´æ¥åµŒå…¥åˆ°å™ªå£°æ¨¡å‹ä¸­ã€‚ä¸ä½¿ç”¨é›¶å‡å€¼ã€å„å‘åŒæ€§é«˜æ–¯å™ªå£°çš„æ ‡å‡†æ‰©æ•£è§„åˆ’å™¨ä¸åŒï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä¸€ç³»åˆ—ä»»åŠ¡æ¡ä»¶ç»“æ„åŒ–é«˜æ–¯åˆ†å¸ƒï¼Œå…¶å‡å€¼å’Œåæ–¹å·®æ¥æºäºé«˜æ–¯è¿‡ç¨‹è¿åŠ¨è§„åˆ’ï¼ˆGPMPï¼‰ï¼šç¨€ç–çš„ã€ä»¥ä»»åŠ¡ä¸ºä¸­å¿ƒçš„å…³é”®çŠ¶æ€æˆ–å®ƒä»¬ç›¸å…³çš„æ—¶é—´ä¿¡æ¯ï¼ˆæˆ–ä¸¤è€…ï¼‰è¢«è§†ä¸ºå™ªå£°è§‚æµ‹ï¼Œä»¥äº§ç”Ÿå…ˆéªŒå®ä¾‹ã€‚æˆ‘ä»¬é¦–å…ˆå°†æ ‡å‡†æ‰©æ•£è¿‡ç¨‹æ¨å¹¿åˆ°å…·æœ‰é—­å¼å‰å‘å’ŒåéªŒè¡¨è¾¾å¼çš„åå·®ã€éå„å‘åŒæ€§æ‰°åŠ¨ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬çš„å±‚çº§ç»“æ„å°†å…ˆéªŒå®ä¾‹åŒ–ä¸è½¨è¿¹å»å™ªåˆ†ç¦»ï¼šä¸Šå±‚å®ä¾‹åŒ–ä¸€ä¸ªä»»åŠ¡æ¡ä»¶ç»“æ„åŒ–é«˜æ–¯åˆ†å¸ƒï¼ˆå‡å€¼å’Œåæ–¹å·®ï¼‰ï¼Œä¸‹å±‚åœ¨è¯¥å›ºå®šå…ˆéªŒä¸‹å¯¹å®Œæ•´è½¨è¿¹è¿›è¡Œå»å™ªã€‚åœ¨Maze2Dç›®æ ‡åˆ°è¾¾å’ŒKUKAç§¯æœ¨å †å å®éªŒä¸­ï¼Œä¸å„å‘åŒæ€§åŸºçº¿ç›¸æ¯”ï¼Œè¯¥æ–¹æ³•æé«˜äº†æˆåŠŸç‡ï¼Œç”Ÿæˆäº†æ›´å¹³æ»‘çš„è½¨è¿¹ï¼Œå¹¶å®ç°äº†æ›´å¼ºçš„ä»»åŠ¡å¯¹é½ã€‚æ¶ˆèç ”ç©¶è¡¨æ˜ï¼Œæ˜¾å¼åœ°æ„å»ºæ‰°åŠ¨è¿‡ç¨‹æ¯”ç®€å•åœ°è°ƒèŠ‚ç¥ç»ç½‘ç»œæ›´æœ‰ç›Šã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬çš„æ–¹æ³•åœ¨ä¿æŒå¯å¤„ç†æ€§çš„åŒæ—¶ï¼Œå°†å…ˆéªŒçš„æ¦‚ç‡è´¨é‡é›†ä¸­åœ¨å¯è¡Œã€å¹³æ»‘å’Œè¯­ä¹‰ä¸Šæœ‰æ„ä¹‰çš„è½¨è¿¹é™„è¿‘ã€‚é¡¹ç›®ä¸»é¡µè§https://hta-diffusion.github.ioã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šç°æœ‰çš„åŸºäºæ‰©æ•£æ¨¡å‹çš„è¿åŠ¨è§„åˆ’æ–¹æ³•é€šå¸¸é‡‡ç”¨é›¶å‡å€¼ã€å„å‘åŒæ€§çš„é«˜æ–¯å™ªå£°è¿›è¡Œè½¨è¿¹çš„é€æ­¥æ‰°åŠ¨å’Œå»å™ªã€‚è¿™ç§æ–¹å¼å¿½ç•¥äº†ä»»åŠ¡æœ¬èº«çš„çº¦æŸå’Œè¿åŠ¨ç»“æ„çš„ç‰¹ç‚¹ï¼Œå¯¼è‡´è§„åˆ’å‡ºçš„è½¨è¿¹å¯èƒ½ä¸ç¬¦åˆä»»åŠ¡è¦æ±‚ï¼Œæˆ–è€…ä¸å¤Ÿå¹³æ»‘è‡ªç„¶ã€‚å› æ­¤ï¼Œå¦‚ä½•å°†ä»»åŠ¡ä¿¡æ¯å’Œè¿åŠ¨ç»“æ„èå…¥åˆ°æ‰©æ•£æ¨¡å‹çš„å™ªå£°æ¨¡å‹ä¸­ï¼Œä»è€Œæå‡è¿åŠ¨è§„åˆ’çš„æ•ˆç‡å’Œè´¨é‡ï¼Œæ˜¯ä¸€ä¸ªäºŸå¾…è§£å†³çš„é—®é¢˜ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šæœ¬æ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯åˆ©ç”¨é«˜æ–¯è¿‡ç¨‹è¿åŠ¨è§„åˆ’ï¼ˆGPMPï¼‰ç”Ÿæˆä»»åŠ¡æ¡ä»¶çš„ç»“æ„åŒ–é«˜æ–¯å…ˆéªŒï¼Œå¹¶å°†å…¶èå…¥åˆ°æ‰©æ•£æ¨¡å‹çš„å™ªå£°æ¨¡å‹ä¸­ã€‚å…·ä½“æ¥è¯´ï¼ŒGPMPå¯ä»¥æ ¹æ®ä»»åŠ¡ç›®æ ‡ç”Ÿæˆä¸€ç³»åˆ—ç¨€ç–çš„å…³é”®çŠ¶æ€æˆ–æ—¶é—´ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥è¢«è§†ä¸ºå¸¦å™ªå£°çš„è§‚æµ‹å€¼ï¼Œä»è€Œæ„å»ºä¸€ä¸ªä»»åŠ¡ç›¸å…³çš„å…ˆéªŒåˆ†å¸ƒã€‚é€šè¿‡å°†è¿™ä¸ªå…ˆéªŒåˆ†å¸ƒä½œä¸ºæ‰©æ•£è¿‡ç¨‹çš„å™ªå£°æ¨¡å‹ï¼Œå¯ä»¥å¼•å¯¼æ‰©æ•£æ¨¡å‹ç”Ÿæˆæ›´ç¬¦åˆä»»åŠ¡è¦æ±‚ã€æ›´å¹³æ»‘çš„è½¨è¿¹ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šè¯¥æ–¹æ³•é‡‡ç”¨å±‚çº§æ‰©æ•£è§„åˆ’æ¡†æ¶ï¼ŒåŒ…å«ä¸¤ä¸ªä¸»è¦å±‚çº§ï¼šå…ˆéªŒå®ä¾‹åŒ–å±‚å’Œè½¨è¿¹å»å™ªå±‚ã€‚å…ˆéªŒå®ä¾‹åŒ–å±‚åˆ©ç”¨GPMPç”Ÿæˆä»»åŠ¡æ¡ä»¶çš„ç»“æ„åŒ–é«˜æ–¯å…ˆéªŒï¼ˆå‡å€¼å’Œåæ–¹å·®ï¼‰ã€‚è½¨è¿¹å»å™ªå±‚åˆ™åœ¨ç»™å®šçš„å…ˆéªŒæ¡ä»¶ä¸‹ï¼Œåˆ©ç”¨æ‰©æ•£æ¨¡å‹é€æ­¥å¯¹è½¨è¿¹è¿›è¡Œå»å™ªï¼Œæœ€ç»ˆç”Ÿæˆå®Œæ•´çš„è¿åŠ¨è½¨è¿¹ã€‚æ•´ä¸ªæ¡†æ¶çš„å…³é”®åœ¨äºå¦‚ä½•å°†GPMPç”Ÿæˆçš„å…ˆéªŒä¿¡æ¯æœ‰æ•ˆåœ°èå…¥åˆ°æ‰©æ•£æ¨¡å‹çš„å™ªå£°æ¨¡å‹ä¸­ï¼Œä»è€Œå¼•å¯¼è½¨è¿¹ç”Ÿæˆã€‚

**å…³é”®åˆ›æ–°**ï¼šè¯¥æ–¹æ³•æœ€é‡è¦çš„åˆ›æ–°ç‚¹åœ¨äºå°†ä»»åŠ¡ä¿¡æ¯å’Œè¿åŠ¨ç»“æ„ç›´æ¥åµŒå…¥åˆ°æ‰©æ•£æ¨¡å‹çš„å™ªå£°æ¨¡å‹ä¸­ã€‚ä¸ä¼ ç»Ÿçš„æ‰©æ•£æ¨¡å‹ä½¿ç”¨é›¶å‡å€¼ã€å„å‘åŒæ€§é«˜æ–¯å™ªå£°ä¸åŒï¼Œè¯¥æ–¹æ³•ä½¿ç”¨ä»»åŠ¡æ¡ä»¶çš„ç»“æ„åŒ–é«˜æ–¯åˆ†å¸ƒä½œä¸ºå™ªå£°æ¨¡å‹ï¼Œä»è€Œå¯ä»¥æ›´å¥½åœ°å¼•å¯¼è½¨è¿¹ç”Ÿæˆã€‚æ­¤å¤–ï¼Œè¯¥æ–¹æ³•è¿˜æå‡ºäº†ä¸€ä¸ªå±‚çº§æ‰©æ•£è§„åˆ’æ¡†æ¶ï¼Œå°†å…ˆéªŒå®ä¾‹åŒ–å’Œè½¨è¿¹å»å™ªåˆ†ç¦»ï¼Œä½¿å¾—æ•´ä¸ªè§„åˆ’è¿‡ç¨‹æ›´åŠ é«˜æ•ˆå’Œå¯æ§ã€‚

**å…³é”®è®¾è®¡**ï¼šåœ¨å…ˆéªŒå®ä¾‹åŒ–å±‚ï¼ŒGPMPç”Ÿæˆçš„å…³é”®çŠ¶æ€æˆ–æ—¶é—´ä¿¡æ¯è¢«è§†ä¸ºå¸¦å™ªå£°çš„è§‚æµ‹å€¼ï¼Œç”¨äºæ„å»ºç»“æ„åŒ–é«˜æ–¯å…ˆéªŒã€‚åœ¨è½¨è¿¹å»å™ªå±‚ï¼Œæ‰©æ•£æ¨¡å‹çš„ç›®æ ‡æ˜¯æ ¹æ®ç»™å®šçš„å…ˆéªŒåˆ†å¸ƒï¼Œé€æ­¥å¯¹è½¨è¿¹è¿›è¡Œå»å™ªã€‚å…·ä½“çš„ç½‘ç»œç»“æ„å’ŒæŸå¤±å‡½æ•°çš„è®¾è®¡éœ€è¦æ ¹æ®å…·ä½“çš„ä»»åŠ¡å’Œç¯å¢ƒè¿›è¡Œè°ƒæ•´ã€‚ä¸€ä¸ªé‡è¦çš„è®¾è®¡é€‰æ‹©æ˜¯å¦‚ä½•å¹³è¡¡å…ˆéªŒä¿¡æ¯å’Œæ•°æ®é©±åŠ¨çš„å­¦ä¹ ï¼Œä»¥è·å¾—æœ€ä½³çš„è§„åˆ’æ•ˆæœã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

åœ¨Maze2Dç›®æ ‡åˆ°è¾¾å’ŒKUKAç§¯æœ¨å †å å®éªŒä¸­ï¼Œè¯¥æ–¹æ³•ç›¸æ¯”äºå„å‘åŒæ€§åŸºçº¿ï¼Œæé«˜äº†æˆåŠŸç‡ï¼Œç”Ÿæˆäº†æ›´å¹³æ»‘çš„è½¨è¿¹ï¼Œå¹¶å®ç°äº†æ›´å¼ºçš„ä»»åŠ¡å¯¹é½ã€‚æ¶ˆèç ”ç©¶è¡¨æ˜ï¼Œæ˜¾å¼åœ°æ„å»ºæ‰°åŠ¨è¿‡ç¨‹æ¯”ç®€å•åœ°è°ƒèŠ‚ç¥ç»ç½‘ç»œæ›´æœ‰ç›Šã€‚å…·ä½“æ€§èƒ½æå‡æ•°æ®éœ€è¦åœ¨è®ºæ–‡åŸæ–‡ä¸­æŸ¥æ‰¾ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæœå¯åº”ç”¨äºæœºå™¨äººè¿åŠ¨è§„åˆ’ã€è‡ªåŠ¨é©¾é©¶ã€æ¸¸æˆAIç­‰é¢†åŸŸã€‚é€šè¿‡å°†ä»»åŠ¡ä¿¡æ¯èå…¥è¿åŠ¨è§„åˆ’è¿‡ç¨‹ï¼Œå¯ä»¥æé«˜æœºå™¨äººåœ¨å¤æ‚ç¯å¢ƒä¸­çš„è¿åŠ¨èƒ½åŠ›å’Œä»»åŠ¡å®Œæˆæ•ˆç‡ã€‚ä¾‹å¦‚ï¼Œåœ¨è‡ªåŠ¨é©¾é©¶ä¸­ï¼Œå¯ä»¥åˆ©ç”¨è¯¥æ–¹æ³•ç”Ÿæˆæ›´å®‰å…¨ã€æ›´èˆ’é€‚çš„è¡Œé©¶è½¨è¿¹ï¼›åœ¨æ¸¸æˆä¸­ï¼Œå¯ä»¥ç”Ÿæˆæ›´æ™ºèƒ½ã€æ›´è‡ªç„¶çš„NPCè¿åŠ¨ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> We propose a novel hierarchical diffusion planner that embeds task and motion structure directly in the noise model. Unlike standard diffusion-based planners that use zero-mean, isotropic Gaussian noise, we employ a family of task-conditioned structured Gaussians whose means and covariances are derived from Gaussian Process Motion Planning (GPMP): sparse, task-centric key states or their associated timings (or both) are treated as noisy observations to produce a prior instance. We first generalize the standard diffusion process to biased, non-isotropic corruption with closed-form forward and posterior expressions. Building on this, our hierarchy separates prior instantiation from trajectory denoising: the upper level instantiates a task-conditioned structured Gaussian (mean and covariance), and the lower level denoises the full trajectory under that fixed prior. Experiments on Maze2D goal-reaching and KUKA block stacking show improved success rates, smoother trajectories, and stronger task alignment compared to isotropic baselines. Ablation studies indicate that explicitly structuring the corruption process offers benefits beyond simply conditioning the neural network. Overall, our method concentrates probability mass of prior near feasible, smooth, and semantically meaningful trajectories while maintaining tractability. Our project page is available at https://hta-diffusion.github.io.

