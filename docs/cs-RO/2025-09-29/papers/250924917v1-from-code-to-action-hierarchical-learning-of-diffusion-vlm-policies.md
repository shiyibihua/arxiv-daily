---
layout: default
title: From Code to Action: Hierarchical Learning of Diffusion-VLM Policies
---

# From Code to Action: Hierarchical Learning of Diffusion-VLM Policies

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.24917" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.24917v1</a>
  <a href="https://arxiv.org/pdf/2509.24917.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.24917v1" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.24917v1', 'From Code to Action: Hierarchical Learning of Diffusion-VLM Policies')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Markus Peschl, Pietro Mazzaglia, Daniel Dijkman

**åˆ†ç±»**: cs.RO, cs.LG

**å‘å¸ƒæ—¥æœŸ**: 2025-09-29

**å¤‡æ³¨**: 19 pages including references, 6 figures. Accepted to CoRL LEAP 2025

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºåŸºäºæ‰©æ•£-VLMç­–ç•¥çš„åˆ†å±‚æ¨¡ä»¿å­¦ä¹ æ¡†æ¶ï¼Œæå‡æœºå™¨äººæ“ä½œçš„æ³›åŒ–æ€§å’Œæ•°æ®æ•ˆç‡**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸€ï¼šæœºå™¨äººæ§åˆ¶ (Robot Control)** **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸æ¶æ„ (RL & Architecture)**

**å…³é”®è¯**: `æœºå™¨äººæ“ä½œ` `æ¨¡ä»¿å­¦ä¹ ` `è§†è§‰è¯­è¨€æ¨¡å‹` `æ‰©æ•£æ¨¡å‹` `åˆ†å±‚ç­–ç•¥` `ä»£ç ç”Ÿæˆ` `éé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. æœºå™¨äººæ“ä½œçš„æ¨¡ä»¿å­¦ä¹ é¢ä¸´æ³›åŒ–èƒ½åŠ›æœ‰é™å’Œæ•°æ®ç¨€ç¼ºçš„æŒ‘æˆ˜ï¼Œå°¤å…¶æ˜¯åœ¨å¤æ‚çš„é•¿æ—¶ç¨‹ä»»åŠ¡ä¸­ã€‚
2. è®ºæ–‡æå‡ºä¸€ç§åˆ†å±‚æ¡†æ¶ï¼Œåˆ©ç”¨VLMç”Ÿæˆä»£ç å¹¶ç»“åˆæ‰©æ•£ç­–ç•¥ï¼Œå°†ä»»åŠ¡åˆ†è§£ä¸ºå¯æ‰§è¡Œçš„å­ç¨‹åºï¼Œæå‡æ³›åŒ–èƒ½åŠ›ã€‚
3. è¯¥æ–¹æ³•é€šè¿‡å®éªŒéªŒè¯äº†å…¶æœ‰æ•ˆæ€§ï¼Œå®ç°äº†å¯è§£é‡Šçš„ç­–ç•¥åˆ†è§£ï¼Œå¹¶æé«˜äº†æ³›åŒ–èƒ½åŠ›ï¼ŒåŒæ—¶æ”¯æŒå¯¹é«˜çº§è§„åˆ’å’Œä½çº§æ§åˆ¶çš„ç‹¬ç«‹è¯„ä¼°ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æå‡ºäº†ä¸€ç§åˆ†å±‚æ¡†æ¶ï¼Œè¯¥æ¡†æ¶åˆ©ç”¨ä»£ç ç”Ÿæˆçš„è§†è§‰è¯­è¨€æ¨¡å‹ï¼ˆVLMï¼‰ä¸ä½çº§æ‰©æ•£ç­–ç•¥ç›¸ç»“åˆï¼Œä»¥æœ‰æ•ˆåœ°æ¨¡ä»¿å’Œæ³›åŒ–æœºå™¨äººè¡Œä¸ºã€‚æ ¸å¿ƒæ€æƒ³æ˜¯å°†å¼€æºæœºå™¨äººAPIä¸ä»…è§†ä¸ºæ‰§è¡Œæ¥å£ï¼Œè¿˜è§†ä¸ºç»“æ„åŒ–ç›‘ç£çš„æ¥æºï¼šç›¸å…³çš„å­ä»»åŠ¡å‡½æ•°ï¼ˆå¦‚æœå…¬å¼€ï¼‰å¯ä»¥ä½œä¸ºæ¨¡å—åŒ–ã€è¯­ä¹‰ä¸Šæœ‰æ„ä¹‰çš„æ ‡ç­¾ã€‚æˆ‘ä»¬è®­ç»ƒVLMå°†ä»»åŠ¡æè¿°åˆ†è§£ä¸ºå¯æ‰§è¡Œçš„å­ç¨‹åºï¼Œç„¶åé€šè¿‡è®­ç»ƒæ‰©æ•£ç­–ç•¥æ¥æ¨¡ä»¿ç›¸åº”çš„æœºå™¨äººè¡Œä¸ºï¼Œä»è€Œå°†è¿™äº›å­ç¨‹åºè½åœ°æ‰§è¡Œã€‚ä¸ºäº†å¤„ç†ä»£ç æ‰§è¡Œå’ŒæŸäº›ç°å®ä¸–ç•Œä»»åŠ¡ï¼ˆå¦‚å¯¹è±¡äº¤æ¢ï¼‰çš„éé©¬å°”å¯å¤«æ€§è´¨ï¼Œæˆ‘ä»¬çš„æ¶æ„åŒ…å«ä¸€ç§è®°å¿†æœºåˆ¶ï¼Œè¯¥æœºåˆ¶å¯ä»¥è·¨æ—¶é—´ç»´æŠ¤å­ä»»åŠ¡ä¸Šä¸‹æ–‡ã€‚æˆ‘ä»¬å‘ç°ï¼Œè¿™ç§è®¾è®¡èƒ½å¤Ÿå®ç°å¯è§£é‡Šçš„ç­–ç•¥åˆ†è§£ï¼Œä¸æ‰å¹³ç­–ç•¥ç›¸æ¯”æé«˜äº†æ³›åŒ–èƒ½åŠ›ï¼Œå¹¶èƒ½å¤Ÿå¯¹é«˜çº§è§„åˆ’å’Œä½çº§æ§åˆ¶è¿›è¡Œå•ç‹¬è¯„ä¼°ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šæœºå™¨äººæ“ä½œçš„æ¨¡ä»¿å­¦ä¹ é€šå¸¸å—é™äºæ³›åŒ–èƒ½åŠ›å’Œæ•°æ®é‡ã€‚å°¤å…¶æ˜¯åœ¨é•¿æ—¶ç¨‹ä»»åŠ¡ä¸­ï¼Œæ•°æ®ç¨€ç¼ºé—®é¢˜æ›´åŠ çªå‡ºã€‚ç°æœ‰çš„æ‰å¹³ç­–ç•¥éš¾ä»¥å¤„ç†å¤æ‚çš„ä»»åŠ¡åˆ†è§£å’Œéé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼Œå¯¼è‡´æ³›åŒ–èƒ½åŠ›ä¸è¶³ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯å°†ä»»åŠ¡åˆ†è§£ä¸ºå¯æ‰§è¡Œçš„å­ç¨‹åºï¼Œå¹¶åˆ©ç”¨è§†è§‰è¯­è¨€æ¨¡å‹ï¼ˆVLMï¼‰ç”Ÿæˆè¿™äº›å­ç¨‹åºå¯¹åº”çš„ä»£ç ã€‚ç„¶åï¼Œé€šè¿‡æ‰©æ•£ç­–ç•¥å­¦ä¹ ä½çº§åˆ«çš„æœºå™¨äººæ§åˆ¶ï¼Œå°†è¿™äº›ä»£ç æŒ‡ä»¤è½¬åŒ–ä¸ºå…·ä½“çš„åŠ¨ä½œã€‚è¿™ç§åˆ†å±‚ç»“æ„ä½¿å¾—ç­–ç•¥æ›´æ˜“äºç†è§£å’Œæ³›åŒ–ï¼ŒåŒæ—¶åˆ©ç”¨äº†å¼€æºæœºå™¨äººAPIæä¾›çš„ç»“æ„åŒ–ä¿¡æ¯ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šæ•´ä½“æ¡†æ¶åŒ…å«ä¸¤ä¸ªä¸»è¦æ¨¡å—ï¼š1) VLMä»£ç ç”Ÿæˆå™¨ï¼šå°†ä»»åŠ¡æè¿°ä½œä¸ºè¾“å…¥ï¼Œç”Ÿæˆä¸€ç³»åˆ—å¯æ‰§è¡Œçš„å­ç¨‹åºä»£ç ã€‚è¿™äº›ä»£ç å¯¹åº”äºæœºå™¨äººAPIä¸­çš„å‡½æ•°è°ƒç”¨ã€‚2) æ‰©æ•£ç­–ç•¥æ§åˆ¶å™¨ï¼šæ¥æ”¶VLMç”Ÿæˆçš„ä»£ç ä½œä¸ºè¾“å…¥ï¼Œå¹¶ç”Ÿæˆç›¸åº”çš„æœºå™¨äººåŠ¨ä½œã€‚ä¸ºäº†å¤„ç†éé©¬å°”å¯å¤«æ€§ï¼Œæ¡†æ¶è¿˜åŒ…å«ä¸€ä¸ªè®°å¿†æ¨¡å—ï¼Œç”¨äºç»´æŠ¤å­ä»»åŠ¡çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚æ•´ä½“æµç¨‹æ˜¯ï¼Œé¦–å…ˆVLMæ ¹æ®ä»»åŠ¡æè¿°ç”Ÿæˆä»£ç åºåˆ—ï¼Œç„¶åæ‰©æ•£ç­–ç•¥æ ¹æ®å½“å‰ä»£ç å’Œå†å²ä¿¡æ¯ç”ŸæˆåŠ¨ä½œï¼Œæ‰§è¡ŒåŠ¨ä½œåæ›´æ–°è®°å¿†æ¨¡å—ï¼Œå¹¶é‡å¤æ­¤è¿‡ç¨‹ç›´åˆ°ä»»åŠ¡å®Œæˆã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„åˆ›æ–°ç‚¹åœ¨äºåˆ©ç”¨VLMå°†ä»»åŠ¡åˆ†è§£ä¸ºå¯æ‰§è¡Œçš„ä»£ç ï¼Œå¹¶å°†å¼€æºæœºå™¨äººAPIä½œä¸ºç»“æ„åŒ–ç›‘ç£ä¿¡å·ã€‚è¿™ç§æ–¹æ³•å°†é«˜çº§è§„åˆ’å’Œä½çº§æ§åˆ¶è§£è€¦ï¼Œä½¿å¾—ç­–ç•¥æ›´æ˜“äºç†è§£å’Œæ³›åŒ–ã€‚ä¸ä¼ ç»Ÿçš„æ‰å¹³ç­–ç•¥ç›¸æ¯”ï¼Œè¯¥æ–¹æ³•èƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†å¤æ‚çš„ä»»åŠ¡å’Œéé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ã€‚

**å…³é”®è®¾è®¡**ï¼šVLMä½¿ç”¨é¢„è®­ç»ƒçš„è§†è§‰è¯­è¨€æ¨¡å‹ï¼Œå¹¶é’ˆå¯¹æœºå™¨äººæ“ä½œä»»åŠ¡è¿›è¡Œå¾®è°ƒã€‚æ‰©æ•£ç­–ç•¥ä½¿ç”¨æ¡ä»¶æ‰©æ•£æ¨¡å‹ï¼Œä»¥VLMç”Ÿæˆçš„ä»£ç å’Œè®°å¿†æ¨¡å—çš„è¾“å‡ºä½œä¸ºæ¡ä»¶ã€‚æŸå¤±å‡½æ•°åŒ…æ‹¬æ¨¡ä»¿å­¦ä¹ æŸå¤±å’Œæ­£åˆ™åŒ–é¡¹ï¼Œç”¨äºæé«˜ç­–ç•¥çš„ç¨³å®šæ€§å’Œæ³›åŒ–èƒ½åŠ›ã€‚è®°å¿†æ¨¡å—å¯ä»¥ä½¿ç”¨LSTMæˆ–Transformerç­‰åºåˆ—æ¨¡å‹å®ç°ï¼Œç”¨äºå­˜å‚¨å’Œæ›´æ–°å­ä»»åŠ¡çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼Œè¯¥æ–¹æ³•åœ¨æœºå™¨äººæ“ä½œä»»åŠ¡ä¸­å–å¾—äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚ä¸æ‰å¹³ç­–ç•¥ç›¸æ¯”ï¼Œè¯¥æ–¹æ³•èƒ½å¤Ÿæ›´å¥½åœ°æ³›åŒ–åˆ°æ–°çš„ä»»åŠ¡å’Œç¯å¢ƒã€‚æ­¤å¤–ï¼Œè¯¥æ–¹æ³•è¿˜å®ç°äº†å¯è§£é‡Šçš„ç­–ç•¥åˆ†è§£ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥æ›´å®¹æ˜“åœ°ç†è§£å’Œè°ƒè¯•æœºå™¨äººç­–ç•¥ã€‚å…·ä½“çš„æ€§èƒ½æ•°æ®å’Œå¯¹æ¯”åŸºçº¿åœ¨è®ºæ–‡ä¸­è¿›è¡Œäº†è¯¦ç»†çš„å±•ç¤ºã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæœå¯åº”ç”¨äºå„ç§æœºå™¨äººæ“ä½œä»»åŠ¡ï¼Œä¾‹å¦‚è‡ªåŠ¨åŒ–è£…é…ã€ç‰©æµåˆ†æ‹£ã€å®¶åº­æœåŠ¡æœºå™¨äººç­‰ã€‚é€šè¿‡åˆ©ç”¨VLMå’Œæ‰©æ•£ç­–ç•¥ï¼Œå¯ä»¥é™ä½æœºå™¨äººç¼–ç¨‹çš„éš¾åº¦ï¼Œæé«˜æœºå™¨äººçš„è‡ªä¸»æ€§å’Œé€‚åº”æ€§ã€‚æœªæ¥ï¼Œè¯¥æ–¹æ³•æœ‰æœ›åº”ç”¨äºæ›´å¤æ‚çš„ç¯å¢ƒå’Œä»»åŠ¡ï¼Œä¾‹å¦‚ç¾éš¾æ•‘æ´ã€å¤ªç©ºæ¢ç´¢ç­‰ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Imitation learning for robotic manipulation often suffers from limited generalization and data scarcity, especially in complex, long-horizon tasks. In this work, we introduce a hierarchical framework that leverages code-generating vision-language models (VLMs) in combination with low-level diffusion policies to effectively imitate and generalize robotic behavior. Our key insight is to treat open-source robotic APIs not only as execution interfaces but also as sources of structured supervision: the associated subtask functions - when exposed - can serve as modular, semantically meaningful labels. We train a VLM to decompose task descriptions into executable subroutines, which are then grounded through a diffusion policy trained to imitate the corresponding robot behavior. To handle the non-Markovian nature of both code execution and certain real-world tasks, such as object swapping, our architecture incorporates a memory mechanism that maintains subtask context across time. We find that this design enables interpretable policy decomposition, improves generalization when compared to flat policies and enables separate evaluation of high-level planning and low-level control.

