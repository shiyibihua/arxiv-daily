---
layout: default
title: Long-Horizon Visual Imitation Learning via Plan and Code Reflection
---

# Long-Horizon Visual Imitation Learning via Plan and Code Reflection

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.05368" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.05368v2</a>
  <a href="https://arxiv.org/pdf/2509.05368.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.05368v2" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.05368v2', 'Long-Horizon Visual Imitation Learning via Plan and Code Reflection')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Quan Chen, Chenrui Shi, Qi Chen, Yuwei Wu, Zhi Gao, Xintong Zhang, Rui Gao, Kun Wu, Yunde Jia

**åˆ†ç±»**: cs.RO, cs.AI, cs.LG

**å‘å¸ƒæ—¥æœŸ**: 2025-09-04 (æ›´æ–°: 2025-09-30)

**å¤‡æ³¨**: 9 pages, 4 figures

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºåŸºäºè®¡åˆ’ä¸ä»£ç åæ€çš„é•¿æ—¶ç¨‹è§†è§‰æ¨¡ä»¿å­¦ä¹ æ¡†æ¶ï¼Œè§£å†³å¤æ‚åŠ¨ä½œåºåˆ—çš„æ—¶åºå’Œç©ºé—´å…³ç³»å»ºæ¨¡éš¾é¢˜ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸æ¶æ„ (RL & Architecture)** **æ”¯æŸ±ä¸ƒï¼šåŠ¨ä½œé‡å®šå‘ (Motion Retargeting)**

**å…³é”®è¯**: `è§†è§‰æ¨¡ä»¿å­¦ä¹ ` `é•¿æ—¶ç¨‹ä»»åŠ¡` `è®¡åˆ’åæ€` `ä»£ç åæ€` `æ—¶åºå…³ç³»å»ºæ¨¡` `ç©ºé—´å…³ç³»å»ºæ¨¡` `æœºå™¨äººå­¦ä¹ ` `åŠ¨ä½œåºåˆ—ç”Ÿæˆ`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰è§†è§‰æ¨¡ä»¿å­¦ä¹ æ–¹æ³•éš¾ä»¥æœ‰æ•ˆå¤„ç†é•¿æ—¶ç¨‹ã€å¤æ‚åŠ¨ä½œåºåˆ—ä¸­çš„æ—¶åºå’Œç©ºé—´å…³ç³»ï¼Œå¯¼è‡´æ€§èƒ½ç“¶é¢ˆã€‚
2. è®ºæ–‡æå‡ºè®¡åˆ’ä¸ä»£ç åæ€æ¡†æ¶ï¼Œé€šè¿‡åæ€æ¨¡å—éªŒè¯å’Œä¿®æ­£è®¡åˆ’ä¸ä»£ç ï¼Œæå‡æ™ºèƒ½ä½“å¯¹æ—¶åºå’Œç©ºé—´å…³ç³»çš„ç†è§£ã€‚
3. å¼•å…¥LongVILBenchåŸºå‡†æµ‹è¯•ï¼Œå®éªŒè¡¨æ˜ç°æœ‰æ–¹æ³•è¡¨ç°ä¸ä½³ï¼Œè€Œæå‡ºçš„æ¡†æ¶å»ºç«‹äº†æ–°çš„æ€§èƒ½åŸºçº¿ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡é’ˆå¯¹è§†è§‰æ¨¡ä»¿å­¦ä¹ ä¸­ï¼Œä»åŒ…å«å¤æ‚åŠ¨ä½œåºåˆ—çš„é•¿æ—¶ç¨‹æ¼”ç¤ºè§†é¢‘ä¸­å­¦ä¹ çš„æŒ‘æˆ˜ï¼Œç‰¹åˆ«æ˜¯ç†è§£åŠ¨ä½œçš„æ—¶åºå…³ç³»å’Œç‰©ä½“é—´çš„ç©ºé—´å…³ç³»ã€‚æå‡ºäº†ä¸€ç§æ–°çš„æ™ºèƒ½ä½“æ¡†æ¶ï¼Œè¯¥æ¡†æ¶åŒ…å«ä¸¤ä¸ªä¸“é—¨çš„åæ€æ¨¡å—ï¼Œä»¥å¢å¼ºè®¡åˆ’å’Œä»£ç çš„ç”Ÿæˆã€‚è®¡åˆ’ç”Ÿæˆæ¨¡å—äº§ç”Ÿåˆå§‹åŠ¨ä½œåºåˆ—ï¼Œç„¶åç”±è®¡åˆ’åæ€æ¨¡å—éªŒè¯ï¼Œä»¥ç¡®ä¿ä¸æ¼”ç¤ºè§†é¢‘çš„æ—¶åºè¿è´¯æ€§å’Œç©ºé—´å¯¹é½ã€‚ä»£ç ç”Ÿæˆæ¨¡å—å°†è®¡åˆ’è½¬æ¢ä¸ºå¯æ‰§è¡Œä»£ç ï¼Œè€Œä»£ç åæ€æ¨¡å—éªŒè¯å’Œç»†åŒ–ç”Ÿæˆçš„ä»£ç ï¼Œä»¥ç¡®ä¿ä¸ç”Ÿæˆçš„è®¡åˆ’çš„æ­£ç¡®æ€§å’Œä¸€è‡´æ€§ã€‚è¿™ä¸¤ä¸ªåæ€æ¨¡å—å…±åŒä½¿æ™ºèƒ½ä½“èƒ½å¤Ÿæ£€æµ‹å’Œçº æ­£è®¡åˆ’ç”Ÿæˆå’Œä»£ç ç”Ÿæˆä¸­çš„é”™è¯¯ï¼Œä»è€Œæé«˜åœ¨å…·æœ‰å¤æ‚æ—¶åºå’Œç©ºé—´ä¾èµ–æ€§çš„ä»»åŠ¡ä¸­çš„æ€§èƒ½ã€‚ä¸ºäº†æ”¯æŒç³»ç»Ÿè¯„ä¼°ï¼Œæˆ‘ä»¬å¼•å…¥äº†LongVILBenchï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ…å«300ä¸ªäººå·¥æ¼”ç¤ºçš„åŸºå‡†ï¼ŒåŠ¨ä½œåºåˆ—æœ€å¤šåŒ…å«18ä¸ªæ­¥éª¤ã€‚LongVILBenchå¼ºè°ƒè·¨å¤šç§ä»»åŠ¡ç±»å‹çš„æ—¶åºå’Œç©ºé—´å¤æ‚æ€§ã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œç°æœ‰æ–¹æ³•åœ¨æ­¤åŸºå‡†ä¸Šè¡¨ç°ä¸ä½³ï¼Œè€Œæˆ‘ä»¬çš„æ–°æ¡†æ¶ä¸ºé•¿æ—¶ç¨‹è§†è§‰æ¨¡ä»¿å­¦ä¹ å»ºç«‹äº†ä¸€ä¸ªå¼ºå¤§çš„åŸºçº¿ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šç°æœ‰çš„è§†è§‰æ¨¡ä»¿å­¦ä¹ æ–¹æ³•åœ¨å¤„ç†é•¿æ—¶ç¨‹ã€å¤æ‚åŠ¨ä½œåºåˆ—æ—¶ï¼Œéš¾ä»¥æœ‰æ•ˆåœ°å»ºæ¨¡åŠ¨ä½œä¹‹é—´çš„æ—¶åºå…³ç³»ä»¥åŠç‰©ä½“ä¹‹é—´çš„ç©ºé—´å…³ç³»ã€‚è¿™å¯¼è‡´æ™ºèƒ½ä½“åœ¨æ‰§è¡Œå¤æ‚ä»»åŠ¡æ—¶å®¹æ˜“å‡ºé”™ï¼Œæ³›åŒ–èƒ½åŠ›è¾ƒå·®ã€‚å°¤å…¶æ˜¯åœ¨åŠ¨ä½œåºåˆ—è¾ƒé•¿æ—¶ï¼Œè¯¯å·®ä¼šéšç€æ—¶é—´ç´¯ç§¯ï¼Œä¸¥é‡å½±å“æœ€ç»ˆæ€§èƒ½ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯é€šè¿‡å¼•å…¥â€œåæ€â€æœºåˆ¶ï¼Œè®©æ™ºèƒ½ä½“åœ¨ç”Ÿæˆè®¡åˆ’å’Œä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œèƒ½å¤Ÿè‡ªæˆ‘æ£€æŸ¥å’Œä¿®æ­£é”™è¯¯ã€‚å…·ä½“æ¥è¯´ï¼Œæ™ºèƒ½ä½“é¦–å…ˆç”Ÿæˆä¸€ä¸ªåˆæ­¥çš„åŠ¨ä½œè®¡åˆ’ï¼Œç„¶åé€šè¿‡â€œè®¡åˆ’åæ€â€æ¨¡å—æ¥éªŒè¯è¯¥è®¡åˆ’æ˜¯å¦ä¸æ¼”ç¤ºè§†é¢‘åœ¨æ—¶åºå’Œç©ºé—´ä¸Šä¿æŒä¸€è‡´ã€‚æ¥ç€ï¼Œæ™ºèƒ½ä½“å°†è®¡åˆ’è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„ä»£ç ï¼Œå¹¶é€šè¿‡â€œä»£ç åæ€â€æ¨¡å—æ¥éªŒè¯ä»£ç æ˜¯å¦æ­£ç¡®åœ°å®ç°äº†è®¡åˆ’çš„æ„å›¾ã€‚é€šè¿‡è¿™ä¸¤ä¸ªåæ€æ¨¡å—çš„è¿­ä»£ä¿®æ­£ï¼Œæ™ºèƒ½ä½“å¯ä»¥é€æ­¥æé«˜è®¡åˆ’å’Œä»£ç çš„è´¨é‡ï¼Œä»è€Œæ›´å¥½åœ°æ¨¡ä»¿æ¼”ç¤ºè§†é¢‘ä¸­çš„è¡Œä¸ºã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šæ•´ä½“æ¡†æ¶åŒ…å«å››ä¸ªä¸»è¦æ¨¡å—ï¼šè®¡åˆ’ç”Ÿæˆæ¨¡å—ã€è®¡åˆ’åæ€æ¨¡å—ã€ä»£ç ç”Ÿæˆæ¨¡å—å’Œä»£ç åæ€æ¨¡å—ã€‚è®¡åˆ’ç”Ÿæˆæ¨¡å—è´Ÿè´£æ ¹æ®è§‚å¯Ÿåˆ°çš„è§†è§‰ä¿¡æ¯ç”Ÿæˆä¸€ä¸ªåˆæ­¥çš„åŠ¨ä½œåºåˆ—è®¡åˆ’ã€‚è®¡åˆ’åæ€æ¨¡å—æ¥æ”¶è®¡åˆ’ç”Ÿæˆæ¨¡å—çš„è¾“å‡ºä»¥åŠæ¼”ç¤ºè§†é¢‘ï¼Œé€šè¿‡å¯¹æ¯”åˆ†æï¼Œåˆ¤æ–­è®¡åˆ’æ˜¯å¦åˆç†ï¼Œå¹¶è¿›è¡Œä¿®æ­£ã€‚ä»£ç ç”Ÿæˆæ¨¡å—å°†ä¿®æ­£åçš„è®¡åˆ’è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„ä»£ç ã€‚ä»£ç åæ€æ¨¡å—åˆ™è´Ÿè´£éªŒè¯ç”Ÿæˆçš„ä»£ç æ˜¯å¦æ­£ç¡®åœ°å®ç°äº†è®¡åˆ’çš„æ„å›¾ï¼Œå¹¶è¿›è¡Œå¿…è¦çš„è°ƒæ•´ã€‚è¿™ä¸¤ä¸ªåæ€æ¨¡å—å¾ªç¯è¿­ä»£ï¼Œç›´åˆ°ç”Ÿæˆé«˜è´¨é‡çš„è®¡åˆ’å’Œä»£ç ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„åˆ›æ–°ç‚¹åœ¨äºå¼•å…¥äº†è®¡åˆ’å’Œä»£ç çš„åŒé‡åæ€æœºåˆ¶ã€‚ä¸ä¼ ç»Ÿçš„æ¨¡ä»¿å­¦ä¹ æ–¹æ³•ç›¸æ¯”ï¼Œè¯¥æ–¹æ³•ä¸ä»…å…³æ³¨åŠ¨ä½œçš„ç”Ÿæˆï¼Œæ›´å…³æ³¨åŠ¨ä½œèƒŒåçš„é€»è¾‘å’Œæ„å›¾ã€‚é€šè¿‡åæ€æœºåˆ¶ï¼Œæ™ºèƒ½ä½“å¯ä»¥æ›´å¥½åœ°ç†è§£æ¼”ç¤ºè§†é¢‘ä¸­çš„æ—¶åºå’Œç©ºé—´å…³ç³»ï¼Œä»è€Œç”Ÿæˆæ›´åˆç†ã€æ›´å¯é çš„åŠ¨ä½œåºåˆ—ã€‚è¿™ç§åŒé‡åæ€æœºåˆ¶èƒ½å¤Ÿæœ‰æ•ˆåœ°å‡å°‘è¯¯å·®ç´¯ç§¯ï¼Œæé«˜æ™ºèƒ½ä½“çš„æ³›åŒ–èƒ½åŠ›ã€‚

**å…³é”®è®¾è®¡**ï¼šè®¡åˆ’åæ€æ¨¡å—å’Œä»£ç åæ€æ¨¡å—æ˜¯å…³é”®ã€‚è®¡åˆ’åæ€æ¨¡å—å¯èƒ½ä½¿ç”¨æ³¨æ„åŠ›æœºåˆ¶æ¥å…³æ³¨æ¼”ç¤ºè§†é¢‘ä¸­çš„å…³é”®å¸§ï¼Œå¹¶ä½¿ç”¨å¾ªç¯ç¥ç»ç½‘ç»œæ¥å»ºæ¨¡åŠ¨ä½œåºåˆ—çš„æ—¶åºå…³ç³»ã€‚ä»£ç åæ€æ¨¡å—å¯èƒ½ä½¿ç”¨ç¬¦å·æ‰§è¡Œæˆ–å½¢å¼åŒ–éªŒè¯ç­‰æŠ€æœ¯æ¥æ£€æŸ¥ä»£ç çš„æ­£ç¡®æ€§ã€‚å…·ä½“çš„æŸå¤±å‡½æ•°è®¾è®¡å¯èƒ½åŒ…æ‹¬æ¨¡ä»¿å­¦ä¹ æŸå¤±ã€æ—¶åºä¸€è‡´æ€§æŸå¤±å’Œç©ºé—´å¯¹é½æŸå¤±ç­‰ã€‚ç½‘ç»œç»“æ„çš„é€‰æ‹©å–å†³äºå…·ä½“çš„ä»»åŠ¡å’Œæ•°æ®é›†ï¼Œä½†é€šå¸¸ä¼šé‡‡ç”¨å·ç§¯ç¥ç»ç½‘ç»œæ¥å¤„ç†è§†è§‰ä¿¡æ¯ï¼Œå¹¶ä½¿ç”¨å¾ªç¯ç¥ç»ç½‘ç»œæˆ–Transformeræ¥å»ºæ¨¡åŠ¨ä½œåºåˆ—ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼Œåœ¨LongVILBenchåŸºå‡†æµ‹è¯•ä¸­ï¼Œç°æœ‰æ–¹æ³•è¡¨ç°ä¸ä½³ï¼Œè€Œæå‡ºçš„æ¡†æ¶æ˜¾è‘—æå‡äº†é•¿æ—¶ç¨‹è§†è§‰æ¨¡ä»¿å­¦ä¹ çš„æ€§èƒ½ï¼Œä¸ºè¯¥é¢†åŸŸå»ºç«‹äº†ä¸€ä¸ªæ–°çš„åŸºçº¿ã€‚å…·ä½“æ€§èƒ½æ•°æ®ï¼ˆä¾‹å¦‚æˆåŠŸç‡ã€åŠ¨ä½œå‡†ç¡®ç‡ç­‰ï¼‰æœªåœ¨æ‘˜è¦ä¸­ç»™å‡ºï¼Œä½†å¼ºè°ƒäº†è¯¥æ¡†æ¶åœ¨å¤„ç†å¤æ‚æ—¶åºå’Œç©ºé—´ä¾èµ–æ€§ä»»åŠ¡ä¸Šçš„ä¼˜åŠ¿ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæœå¯åº”ç”¨äºæœºå™¨äººæµç¨‹è‡ªåŠ¨åŒ–ã€è‡ªåŠ¨é©¾é©¶ã€æ¸¸æˆAIç­‰é¢†åŸŸã€‚ä¾‹å¦‚ï¼Œåœ¨æœºå™¨äººæµç¨‹è‡ªåŠ¨åŒ–ä¸­ï¼Œæœºå™¨äººå¯ä»¥é€šè¿‡æ¨¡ä»¿äººç±»æ“ä½œè§†é¢‘æ¥å­¦ä¹ å¤æ‚çš„ä»»åŠ¡æµç¨‹ã€‚åœ¨è‡ªåŠ¨é©¾é©¶é¢†åŸŸï¼Œè‡ªåŠ¨é©¾é©¶ç³»ç»Ÿå¯ä»¥é€šè¿‡æ¨¡ä»¿äººç±»é©¾é©¶è¡Œä¸ºæ¥æé«˜é©¾é©¶å®‰å…¨æ€§ã€‚è¯¥ç ”ç©¶çš„æœªæ¥å½±å“åœ¨äºï¼Œå®ƒæœ‰æœ›æ¨åŠ¨æ™ºèƒ½ä½“è‡ªä¸»å­¦ä¹ èƒ½åŠ›çš„æå‡ï¼Œä½¿å…¶èƒ½å¤Ÿæ›´å¥½åœ°é€‚åº”å¤æ‚å¤šå˜çš„ç¯å¢ƒã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Learning from long-horizon demonstrations with complex action sequences presents significant challenges for visual imitation learning, particularly in understanding temporal relationships of actions and spatial relationships between objects. In this paper, we propose a new agent framework that incorporates two dedicated reflection modules to enhance both plan and code generation. The plan generation module produces an initial action sequence, which is then verified by the plan reflection module to ensure temporal coherence and spatial alignment with the demonstration video. The code generation module translates the plan into executable code, while the code reflection module verifies and refines the generated code to ensure correctness and consistency with the generated plan. These two reflection modules jointly enable the agent to detect and correct errors in both the plan generation and code generation, improving performance in tasks with intricate temporal and spatial dependencies. To support systematic evaluation, we introduce LongVILBench, a benchmark comprising 300 human demonstrations with action sequences of up to 18 steps. LongVILBench emphasizes temporal and spatial complexity across multiple task types. Experimental results demonstrate that existing methods perform poorly on this benchmark, whereas our new framework establishes a strong baseline for long-horizon visual imitation learning.

