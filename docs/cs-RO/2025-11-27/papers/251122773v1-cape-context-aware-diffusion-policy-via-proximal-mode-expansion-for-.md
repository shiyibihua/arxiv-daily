---
layout: default
title: CAPE: Context-Aware Diffusion Policy Via Proximal Mode Expansion for Collision Avoidance
---

# CAPE: Context-Aware Diffusion Policy Via Proximal Mode Expansion for Collision Avoidance

**arXiv**: [2511.22773v1](https://arxiv.org/abs/2511.22773) | [PDF](https://arxiv.org/pdf/2511.22773.pdf)

**ä½œè€…**: Rui Heng Yang, Xuan Zhao, Leo Maxime Brunswic, Montgomery Alban, Mateo Clemente, Tongtong Cao, Jun Jin, Amir Rasouli

**åˆ†ç±»**: cs.RO, cs.AI

**å‘å¸ƒæ—¥æœŸ**: 2025-11-27

**å¤‡æ³¨**: 4 tables, 9 figures

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**CAPEï¼šåŸºäºŽè¿‘ç«¯æ¨¡å¼æ‰©å±•çš„ä¸Šä¸‹æ–‡æ„ŸçŸ¥æ‰©æ•£ç­–ç•¥ï¼Œç”¨äºŽæœºå™¨äººé¿éšœ**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸€ï¼šæœºå™¨äººæŽ§åˆ¶ (Robot Control)** **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸Žæž¶æž„ (RL & Architecture)**

**å…³é”®è¯**: `æ‰©æ•£æ¨¡åž‹` `æ¨¡ä»¿å­¦ä¹ ` `æœºå™¨äººé¿éšœ` `ä¸Šä¸‹æ–‡æ„ŸçŸ¥` `è½¨è¿¹ç”Ÿæˆ`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. çŽ°æœ‰æ¨¡ä»¿å­¦ä¹ æ–¹æ³•åœ¨é¿éšœç­‰å¤æ‚ä»»åŠ¡ä¸­ï¼Œéœ€è¦å¤§é‡æ•°æ®æ‰èƒ½ä¿è¯æ³›åŒ–æ€§ï¼Œæ•°æ®é‡‡é›†æˆæœ¬é«˜æ˜‚ã€‚
2. CAPEé€šè¿‡ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„å…ˆéªŒå¼•å¯¼è¿­ä»£ç»†åŒ–ï¼Œæ‰©å±•è½¨è¿¹åˆ†å¸ƒæ¨¡å¼ï¼Œä»Žè€Œåœ¨æŽ¨ç†æ—¶ç”Ÿæˆæ›´ä¼˜çš„é¿éšœè½¨è¿¹ã€‚
3. CAPEåœ¨æ¨¡æ‹Ÿå’ŒçœŸå®žä¸–ç•Œçš„å®žéªŒä¸­ï¼Œç›¸è¾ƒäºŽçŽ°æœ‰æ–¹æ³•ï¼ŒæˆåŠŸçŽ‡åˆ†åˆ«æå‡äº†26%å’Œ80%ï¼Œå±•ç¤ºäº†å…¶ä¼˜è¶Šçš„æ³›åŒ–èƒ½åŠ›ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æ‰©æ•£æ¨¡åž‹èƒ½å¤Ÿä»Žæ¼”ç¤ºæ•°æ®ä¸­æ•èŽ·å¤šæ¨¡æ€è½¨è¿¹ï¼Œä½¿å…¶æˆä¸ºæ¨¡ä»¿å­¦ä¹ ä¸­ä¸€ç§å˜é©æ€§çš„æ–¹æ³•ã€‚ç„¶è€Œï¼Œè¦è¾¾åˆ°æœ€ä½³æ€§èƒ½éœ€è¦å¤§è§„æ¨¡æ•°æ®é›†ï¼Œè¿™å¯¹äºŽå…·æœ‰æŒ‘æˆ˜æ€§çš„ä»»åŠ¡ï¼ˆå¦‚é¿éšœï¼‰è€Œè¨€æˆæœ¬é«˜æ˜‚ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†åŸºäºŽè¿‘ç«¯æ¨¡å¼æ‰©å±•çš„ä¸Šä¸‹æ–‡æ„ŸçŸ¥æ‰©æ•£ç­–ç•¥ï¼ˆCAPEï¼‰ï¼Œè¯¥æ¡†æž¶é€šè¿‡ä¸€ç§æ–°é¢–çš„å…ˆéªŒå¼•å¯¼è¿­ä»£ç»†åŒ–ç¨‹åºï¼Œåœ¨æŽ¨ç†æ—¶åˆ©ç”¨ä¸Šä¸‹æ–‡æ„ŸçŸ¥å…ˆéªŒå’ŒæŒ‡å¯¼æ¥æ‰©å±•è½¨è¿¹åˆ†å¸ƒæ¨¡å¼ã€‚è¯¥æ¡†æž¶ç”Ÿæˆåˆå§‹è½¨è¿¹è§„åˆ’å¹¶æ‰§è¡Œä¸€ä¸ªçŸ­è½¨è¿¹å‰ç¼€ï¼Œç„¶åŽå°†å‰©ä½™è½¨è¿¹æ®µæ‰°åŠ¨åˆ°ä¸­é—´å™ªå£°æ°´å¹³ï¼Œå½¢æˆè½¨è¿¹å…ˆéªŒã€‚è¿™ç§å…ˆéªŒæ˜¯ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„ï¼Œå¹¶ä¿ç•™äº†ä»»åŠ¡æ„å›¾ã€‚é€šè¿‡ä¸Šä¸‹æ–‡æ„ŸçŸ¥å¼•å¯¼åŽ»å™ªé‡å¤è¯¥è¿‡ç¨‹ï¼Œè¿­ä»£åœ°æ‰©å±•æ¨¡å¼æ”¯æŒï¼Œä»Žè€Œå…è®¸æ‰¾åˆ°æ›´å¹³æ»‘ã€æ›´å°‘ç¢°æ’žçš„è½¨è¿¹ã€‚å¯¹äºŽé¿éšœï¼ŒCAPEä½¿ç”¨ç¢°æ’žæ„ŸçŸ¥ä¸Šä¸‹æ–‡æ‰©å±•è½¨è¿¹åˆ†å¸ƒæ¨¡å¼ï¼Œä»Žè€Œèƒ½å¤Ÿåœ¨ä»¥å‰æœªè§è¿‡çš„çŽ¯å¢ƒä¸­é‡‡æ ·æ— ç¢°æ’žè½¨è¿¹ï¼ŒåŒæ—¶ä¿æŒç›®æ ‡ä¸€è‡´æ€§ã€‚æˆ‘ä»¬åœ¨å„ç§æ‚ä¹±çš„ã€æœªè§è¿‡çš„æ¨¡æ‹Ÿå’ŒçœŸå®žä¸–ç•ŒçŽ¯å¢ƒä¸­è¯„ä¼°äº†CAPEï¼Œå¹¶è¡¨æ˜Žä¸ŽSOTAæ–¹æ³•ç›¸æ¯”ï¼ŒæˆåŠŸçŽ‡åˆ†åˆ«æé«˜äº†é«˜è¾¾26%å’Œ80%ï¼Œè¯æ˜Žäº†å¯¹æœªè§çŽ¯å¢ƒçš„æ›´å¥½æ³›åŒ–ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³æœºå™¨äººé¿éšœä»»åŠ¡ä¸­ï¼Œæ¨¡ä»¿å­¦ä¹ æ–¹æ³•å¯¹æ–°çŽ¯å¢ƒæ³›åŒ–èƒ½åŠ›ä¸è¶³çš„é—®é¢˜ã€‚çŽ°æœ‰æ–¹æ³•ä¾èµ–å¤§é‡æ•°æ®ï¼Œéš¾ä»¥è¦†ç›–æ‰€æœ‰å¯èƒ½çš„éšœç¢ç‰©ç±»åž‹å’Œç©ºé—´é…ç½®ï¼Œå¯¼è‡´åœ¨æœªè§è¿‡çš„çŽ¯å¢ƒä¸­å®¹æ˜“å‘ç”Ÿç¢°æ’žã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯åˆ©ç”¨æ‰©æ•£æ¨¡åž‹ç”Ÿæˆè½¨è¿¹ï¼Œå¹¶é€šè¿‡ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„å…ˆéªŒä¿¡æ¯å¼•å¯¼è½¨è¿¹çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œä»Žè€Œæ‰©å±•è½¨è¿¹åˆ†å¸ƒçš„æ¨¡å¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¦†ç›–æ›´å¤šå®‰å…¨ã€æ— ç¢°æ’žçš„è½¨è¿¹ã€‚è¿™ç§æ–¹æ³•èƒ½å¤Ÿåœ¨å°‘é‡æ•°æ®çš„åŸºç¡€ä¸Šï¼Œæå‡æ¨¡åž‹å¯¹æ–°çŽ¯å¢ƒçš„æ³›åŒ–èƒ½åŠ›ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šCAPEæ¡†æž¶åŒ…å«ä»¥ä¸‹å‡ ä¸ªä¸»è¦é˜¶æ®µï¼š1) ç”Ÿæˆåˆå§‹è½¨è¿¹è§„åˆ’ï¼›2) æ‰§è¡Œè½¨è¿¹å‰ç¼€ï¼›3) å°†å‰©ä½™è½¨è¿¹æ®µæ‰°åŠ¨åˆ°ä¸­é—´å™ªå£°æ°´å¹³ï¼Œå½¢æˆä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„è½¨è¿¹å…ˆéªŒï¼›4) é€šè¿‡ä¸Šä¸‹æ–‡æ„ŸçŸ¥å¼•å¯¼åŽ»å™ªï¼Œè¿­ä»£åœ°ç»†åŒ–è½¨è¿¹ï¼Œæ‰©å±•æ¨¡å¼æ”¯æŒã€‚è¯¥æ¡†æž¶é€šè¿‡ä¸æ–­åœ°è¿­ä»£ï¼Œé€æ­¥ç”Ÿæˆæ›´å¹³æ»‘ã€æ›´å°‘ç¢°æ’žçš„è½¨è¿¹ã€‚

**å…³é”®åˆ›æ–°**ï¼šCAPEçš„å…³é”®åˆ›æ–°åœ¨äºŽæå‡ºäº†ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„å…ˆéªŒå¼•å¯¼è¿­ä»£ç»†åŒ–ç¨‹åºã€‚è¯¥ç¨‹åºåˆ©ç”¨å·²æ‰§è¡Œçš„è½¨è¿¹å‰ç¼€ä½œä¸ºä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œç”Ÿæˆè½¨è¿¹å…ˆéªŒï¼Œå¹¶åˆ©ç”¨è¯¥å…ˆéªŒå¼•å¯¼æ‰©æ•£æ¨¡åž‹çš„åŽ»å™ªè¿‡ç¨‹ï¼Œä»Žè€Œæ‰©å±•è½¨è¿¹åˆ†å¸ƒçš„æ¨¡å¼ã€‚è¿™ç§æ–¹æ³•èƒ½å¤Ÿæœ‰æ•ˆåœ°åˆ©ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œç”Ÿæˆæ›´ç¬¦åˆä»»åŠ¡éœ€æ±‚çš„è½¨è¿¹ã€‚

**å…³é”®è®¾è®¡**ï¼šCAPEçš„å…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) ä½¿ç”¨æ‰©æ•£æ¨¡åž‹ä½œä¸ºè½¨è¿¹ç”Ÿæˆå™¨ï¼›2) è®¾è®¡ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„è½¨è¿¹å…ˆéªŒï¼Œè¯¥å…ˆéªŒåŸºäºŽå·²æ‰§è¡Œçš„è½¨è¿¹å‰ç¼€ç”Ÿæˆï¼›3) è®¾è®¡ä¸Šä¸‹æ–‡æ„ŸçŸ¥å¼•å¯¼åŽ»å™ªè¿‡ç¨‹ï¼Œè¯¥è¿‡ç¨‹åˆ©ç”¨è½¨è¿¹å…ˆéªŒå¼•å¯¼æ‰©æ•£æ¨¡åž‹çš„åŽ»å™ªè¿‡ç¨‹ã€‚å…·ä½“çš„å‚æ•°è®¾ç½®å’Œç½‘ç»œç»“æž„ç­‰ç»†èŠ‚åœ¨è®ºæ–‡ä¸­è¿›è¡Œäº†è¯¦ç»†æè¿°ï¼Œä½†æ‘˜è¦ä¸­æœªæåŠå…·ä½“æ•°å€¼ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

CAPEåœ¨æ¨¡æ‹Ÿå’ŒçœŸå®žä¸–ç•Œçš„å®žéªŒä¸­è¡¨çŽ°å‡ºè‰²ã€‚åœ¨æ¨¡æ‹ŸçŽ¯å¢ƒä¸­ï¼ŒCAPEçš„æˆåŠŸçŽ‡æ¯”çŽ°æœ‰æ–¹æ³•æé«˜äº†26%ã€‚åœ¨æ›´å…·æŒ‘æˆ˜æ€§çš„çœŸå®žä¸–ç•ŒçŽ¯å¢ƒä¸­ï¼ŒCAPEçš„æˆåŠŸçŽ‡æ›´æ˜¯æé«˜äº†80%ã€‚è¿™äº›ç»“æžœè¡¨æ˜Žï¼ŒCAPEå…·æœ‰å¾ˆå¼ºçš„æ³›åŒ–èƒ½åŠ›ï¼Œèƒ½å¤Ÿåœ¨æœªè§è¿‡çš„çŽ¯å¢ƒä¸­ç”Ÿæˆå®‰å…¨ã€æœ‰æ•ˆçš„é¿éšœè½¨è¿¹ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

CAPEæ¡†æž¶å¯åº”ç”¨äºŽå„ç§æœºå™¨äººé¿éšœåœºæ™¯ï¼Œä¾‹å¦‚è‡ªåŠ¨é©¾é©¶ã€æ— äººæœºå¯¼èˆªã€å·¥ä¸šæœºå™¨äººç­‰ã€‚è¯¥ç ”ç©¶èƒ½å¤Ÿé™ä½Žæœºå™¨äººå¯¹çŽ¯å¢ƒæ„ŸçŸ¥çš„è¦æ±‚ï¼Œæé«˜æœºå™¨äººåœ¨å¤æ‚çŽ¯å¢ƒä¸­çš„å®‰å…¨æ€§å’Œå¯é æ€§ï¼Œå…·æœ‰é‡è¦çš„å®žé™…åº”ç”¨ä»·å€¼å’Œå¹¿é˜”çš„æœªæ¥å‘å±•å‰æ™¯ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> In robotics, diffusion models can capture multi-modal trajectories from demonstrations, making them a transformative approach in imitation learning. However, achieving optimal performance following this regiment requires a large-scale dataset, which is costly to obtain, especially for challenging tasks, such as collision avoidance. In those tasks, generalization at test time demands coverage of many obstacles types and their spatial configurations, which are impractical to acquire purely via data. To remedy this problem, we propose Context-Aware diffusion policy via Proximal mode Expansion (CAPE), a framework that expands trajectory distribution modes with context-aware prior and guidance at inference via a novel prior-seeded iterative guided refinement procedure. The framework generates an initial trajectory plan and executes a short prefix trajectory, and then the remaining trajectory segment is perturbed to an intermediate noise level, forming a trajectory prior. Such a prior is context-aware and preserves task intent. Repeating the process with context-aware guided denoising iteratively expands mode support to allow finding smoother, less collision-prone trajectories. For collision avoidance, CAPE expands trajectory distribution modes with collision-aware context, enabling the sampling of collision-free trajectories in previously unseen environments while maintaining goal consistency. We evaluate CAPE on diverse manipulation tasks in cluttered unseen simulated and real-world settings and show up to 26% and 80% higher success rates respectively compared to SOTA methods, demonstrating better generalization to unseen environments.

