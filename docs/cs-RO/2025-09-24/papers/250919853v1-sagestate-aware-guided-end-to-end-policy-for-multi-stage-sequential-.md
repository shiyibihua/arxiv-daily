---
layout: default
title: SAGE:State-Aware Guided End-to-End Policy for Multi-Stage Sequential Tasks via Hidden Markov Decision Process
---

# SAGE:State-Aware Guided End-to-End Policy for Multi-Stage Sequential Tasks via Hidden Markov Decision Process

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.19853" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.19853v1</a>
  <a href="https://arxiv.org/pdf/2509.19853.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.19853v1" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.19853v1', 'SAGE:State-Aware Guided End-to-End Policy for Multi-Stage Sequential Tasks via Hidden Markov Decision Process')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: BinXu Wu, TengFei Zhang, Chen Yang, JiaHao Wen, HaoCheng Li, JingTian Ma, Zhen Chen, JingYuan Wang

**åˆ†ç±»**: cs.RO

**å‘å¸ƒæ—¥æœŸ**: 2025-09-24

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**SAGEï¼šåŸºäºéšé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„çŠ¶æ€æ„ŸçŸ¥å¼•å¯¼ç«¯åˆ°ç«¯å¤šé˜¶æ®µåºåˆ—ä»»åŠ¡ç­–ç•¥**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸€ï¼šæœºå™¨äººæ§åˆ¶ (Robot Control)** **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸æ¶æ„ (RL & Architecture)**

**å…³é”®è¯**: `å¤šé˜¶æ®µåºåˆ—ä»»åŠ¡` `æ¨¡ä»¿å­¦ä¹ ` `éšé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹` `çŠ¶æ€æ„ŸçŸ¥` `æœºå™¨äººæ“ä½œ` `çŠ¶æ€æ¨¡ç³Š` `ä¸»åŠ¨å­¦ä¹ ` `åŠè‡ªåŠ¨æ ‡æ³¨`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. å¤šé˜¶æ®µåºåˆ—æœºå™¨äººæ“ä½œä»»åŠ¡ä¸­ï¼Œè§†è§‰ç›¸ä¼¼çš„è§‚æµ‹å¯èƒ½å¯¹åº”ä¸åŒçš„åŠ¨ä½œï¼Œå¯¼è‡´çŠ¶æ€æ¨¡ç³Šï¼Œç°æœ‰æ–¹æ³•éš¾ä»¥æœ‰æ•ˆå¤„ç†ã€‚
2. SAGEå°†ä»»åŠ¡å»ºæ¨¡ä¸ºéšé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼Œé€šè¿‡çŠ¶æ€è½¬ç§»ç½‘ç»œæ¨æ–­éšè—çŠ¶æ€ï¼Œå¹¶ä½¿ç”¨çŠ¶æ€æ„ŸçŸ¥åŠ¨ä½œç­–ç•¥æ¥æ¶ˆé™¤æ­§ä¹‰ã€‚
3. å®éªŒè¡¨æ˜ï¼ŒSAGEåœ¨çœŸå®ä¸–ç•Œå¤æ‚ä»»åŠ¡ä¸­å®ç°äº†100%çš„ä»»åŠ¡æˆåŠŸç‡ï¼Œä¸”ä»…éœ€å°‘é‡æ‰‹åŠ¨æ ‡æ³¨å³å¯ç»´æŒé«˜æ€§èƒ½ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æå‡ºäº†ä¸€ç§åä¸ºSAGEçš„çŠ¶æ€æ„ŸçŸ¥å¼•å¯¼æ¨¡ä»¿å­¦ä¹ æ¡†æ¶ï¼Œç”¨äºè§£å†³æœºå™¨äººå¤šé˜¶æ®µåºåˆ—ï¼ˆMSSï¼‰æ“ä½œä»»åŠ¡ä¸­çš„çŠ¶æ€æ¨¡ç³Šé—®é¢˜ã€‚SAGEå°†ä»»åŠ¡å»ºæ¨¡ä¸ºéšé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆHMDPï¼‰ï¼Œæ˜¾å¼åœ°æ•è·æ½œåœ¨çš„ä»»åŠ¡é˜¶æ®µå¹¶æ¶ˆé™¤æ­§ä¹‰ã€‚è¯¥æ¡†æ¶åŒ…å«ä¸€ä¸ªç”¨äºæ¨æ–­éšè—çŠ¶æ€çš„çŠ¶æ€è½¬ç§»ç½‘ç»œå’Œä¸€ä¸ªçŠ¶æ€æ„ŸçŸ¥åŠ¨ä½œç­–ç•¥ï¼Œè¯¥ç­–ç•¥ä»¥è§‚æµ‹å’Œéšè—çŠ¶æ€ä¸ºæ¡ä»¶ç”ŸæˆåŠ¨ä½œï¼Œä»è€Œå®ç°è·¨ä»»åŠ¡é˜¶æ®µçš„æ¶ˆæ­§ã€‚ä¸ºäº†å‡å°‘æ‰‹åŠ¨æ ‡æ³¨å·¥ä½œé‡ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€ç§ç»“åˆä¸»åŠ¨å­¦ä¹ å’Œè½¯æ ‡ç­¾æ’å€¼çš„åŠè‡ªåŠ¨æ ‡æ³¨æµç¨‹ã€‚åœ¨å…·æœ‰çŠ¶æ€æ¨¡ç³Šçš„å¤šä¸ªå¤æ‚MSSä»»åŠ¡çš„çœŸå®ä¸–ç•Œå®éªŒä¸­ï¼ŒSAGEåœ¨æ ‡å‡†è¯„ä¼°åè®®ä¸‹å®ç°äº†100%çš„ä»»åŠ¡æˆåŠŸç‡ï¼Œæ˜¾è‘—ä¼˜äºåŸºçº¿æ–¹æ³•ã€‚æ¶ˆèç ”ç©¶è¡¨æ˜ï¼Œä»…éœ€å¯¹çº¦13%çš„çŠ¶æ€è¿›è¡Œæ‰‹åŠ¨æ ‡æ³¨å³å¯ç»´æŒè¿™ç§æ€§èƒ½ï¼Œè¡¨æ˜å…¶å…·æœ‰å¾ˆå¼ºçš„æœ‰æ•ˆæ€§ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šå¤šé˜¶æ®µåºåˆ—æœºå™¨äººæ“ä½œä»»åŠ¡æ™®éå­˜åœ¨çŠ¶æ€æ¨¡ç³Šé—®é¢˜ï¼Œå³è§†è§‰ä¸Šç›¸ä¼¼çš„è§‚æµ‹å¯èƒ½å¯¹åº”ä¸åŒçš„ä»»åŠ¡é˜¶æ®µï¼Œéœ€è¦æ‰§è¡Œä¸åŒçš„åŠ¨ä½œã€‚ç°æœ‰çš„æ–¹æ³•éš¾ä»¥æœ‰æ•ˆåŒºåˆ†è¿™äº›çŠ¶æ€ï¼Œå¯¼è‡´ç­–ç•¥å­¦ä¹ å›°éš¾ï¼Œä»»åŠ¡æˆåŠŸç‡ä½ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šSAGEçš„æ ¸å¿ƒæ€è·¯æ˜¯å°†å¤šé˜¶æ®µåºåˆ—ä»»åŠ¡å»ºæ¨¡ä¸ºéšé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆHMDPï¼‰ï¼Œæ˜¾å¼åœ°å­¦ä¹ å’Œåˆ©ç”¨ä»»åŠ¡çš„æ½œåœ¨é˜¶æ®µä¿¡æ¯ã€‚é€šè¿‡å¼•å…¥éšè—çŠ¶æ€æ¥è¡¨ç¤ºä»»åŠ¡é˜¶æ®µï¼Œå¹¶ä½¿ç”¨çŠ¶æ€è½¬ç§»ç½‘ç»œæ¥æ¨æ–­è¿™äº›éšè—çŠ¶æ€ï¼Œä»è€Œæ¶ˆé™¤çŠ¶æ€æ¨¡ç³Šæ€§ã€‚çŠ¶æ€æ„ŸçŸ¥çš„åŠ¨ä½œç­–ç•¥åˆ™æ ¹æ®è§‚æµ‹å’Œæ¨æ–­çš„éšè—çŠ¶æ€æ¥é€‰æ‹©åˆé€‚çš„åŠ¨ä½œã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šSAGEæ¡†æ¶ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ¨¡å—ï¼š1) çŠ¶æ€è½¬ç§»ç½‘ç»œï¼šç”¨äºæ ¹æ®å½“å‰è§‚æµ‹æ¨æ–­éšè—çŠ¶æ€ï¼›2) çŠ¶æ€æ„ŸçŸ¥åŠ¨ä½œç­–ç•¥ï¼šæ ¹æ®è§‚æµ‹å’Œæ¨æ–­çš„éšè—çŠ¶æ€ç”ŸæˆåŠ¨ä½œï¼›3) åŠè‡ªåŠ¨æ ‡æ³¨æµç¨‹ï¼šç»“åˆä¸»åŠ¨å­¦ä¹ å’Œè½¯æ ‡ç­¾æ’å€¼ï¼Œå‡å°‘æ‰‹åŠ¨æ ‡æ³¨å·¥ä½œé‡ã€‚æ•´ä½“æµç¨‹æ˜¯ï¼Œé¦–å…ˆä½¿ç”¨åŠè‡ªåŠ¨æ ‡æ³¨æµç¨‹ç”Ÿæˆè®­ç»ƒæ•°æ®ï¼Œç„¶åè®­ç»ƒçŠ¶æ€è½¬ç§»ç½‘ç»œå’ŒçŠ¶æ€æ„ŸçŸ¥åŠ¨ä½œç­–ç•¥ï¼Œæœ€ååœ¨çœŸå®æœºå™¨äººä¸Šéƒ¨ç½²è®­ç»ƒå¥½çš„ç­–ç•¥ã€‚

**å…³é”®åˆ›æ–°**ï¼šSAGEçš„å…³é”®åˆ›æ–°åœ¨äºå°†éšé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹å¼•å…¥åˆ°å¤šé˜¶æ®µåºåˆ—æœºå™¨äººæ“ä½œä»»åŠ¡ä¸­ï¼Œæ˜¾å¼åœ°å»ºæ¨¡å’Œåˆ©ç”¨ä»»åŠ¡çš„æ½œåœ¨é˜¶æ®µä¿¡æ¯ã€‚ä¸ä¼ ç»Ÿçš„æ¨¡ä»¿å­¦ä¹ æ–¹æ³•ç›¸æ¯”ï¼ŒSAGEèƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†çŠ¶æ€æ¨¡ç³Šé—®é¢˜ï¼Œæé«˜ä»»åŠ¡æˆåŠŸç‡ã€‚æ­¤å¤–ï¼ŒåŠè‡ªåŠ¨æ ‡æ³¨æµç¨‹ä¹Ÿæ˜¾è‘—å‡å°‘äº†æ‰‹åŠ¨æ ‡æ³¨å·¥ä½œé‡ã€‚

**å…³é”®è®¾è®¡**ï¼šçŠ¶æ€è½¬ç§»ç½‘ç»œå¯ä»¥ä½¿ç”¨å„ç§ç¥ç»ç½‘ç»œç»“æ„ï¼Œä¾‹å¦‚å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰æˆ–Transformerã€‚çŠ¶æ€æ„ŸçŸ¥åŠ¨ä½œç­–ç•¥å¯ä»¥ä½¿ç”¨å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰æˆ–æ›´å¤æ‚çš„ç½‘ç»œç»“æ„ã€‚æŸå¤±å‡½æ•°åŒ…æ‹¬çŠ¶æ€è½¬ç§»ç½‘ç»œçš„äº¤å‰ç†µæŸå¤±å’ŒåŠ¨ä½œç­–ç•¥çš„æ¨¡ä»¿å­¦ä¹ æŸå¤±ã€‚ä¸»åŠ¨å­¦ä¹ ç­–ç•¥é€‰æ‹©ä¿¡æ¯é‡æœ€å¤§çš„æ ·æœ¬è¿›è¡Œæ ‡æ³¨ï¼Œè½¯æ ‡ç­¾æ’å€¼åˆ™åˆ©ç”¨ç›¸é‚»çŠ¶æ€çš„æ ‡ç­¾ä¿¡æ¯æ¥ç”Ÿæˆæœªæ ‡æ³¨çŠ¶æ€çš„æ ‡ç­¾ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

SAGEåœ¨å¤šä¸ªçœŸå®ä¸–ç•Œå¤æ‚MSSä»»åŠ¡ä¸­å®ç°äº†100%çš„ä»»åŠ¡æˆåŠŸç‡ï¼Œæ˜¾è‘—ä¼˜äºåŸºçº¿æ–¹æ³•ã€‚æ¶ˆèå®éªŒè¡¨æ˜ï¼Œå³ä½¿ä»…å¯¹çº¦13%çš„çŠ¶æ€è¿›è¡Œæ‰‹åŠ¨æ ‡æ³¨ï¼ŒSAGEä»èƒ½ä¿æŒé«˜æ€§èƒ½ï¼ŒéªŒè¯äº†å…¶æœ‰æ•ˆæ€§å’Œæ•°æ®æ•ˆç‡ã€‚è¿™äº›ç»“æœè¡¨æ˜SAGEåœ¨è§£å†³çŠ¶æ€æ¨¡ç³Šé—®é¢˜å’Œæé«˜æœºå™¨äººæ“ä½œæ€§èƒ½æ–¹é¢å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

SAGEå¯åº”ç”¨äºå„ç§éœ€è¦æœºå™¨äººæ‰§è¡Œå¤šé˜¶æ®µåºåˆ—æ“ä½œä»»åŠ¡çš„åœºæ™¯ï¼Œä¾‹å¦‚è£…é…ã€æ‹†å¸ã€æŠ“å–ã€æ”¾ç½®ç­‰ã€‚è¯¥ç ”ç©¶æˆæœèƒ½å¤Ÿæå‡æœºå™¨äººåœ¨å¤æ‚ç¯å¢ƒä¸­çš„æ“ä½œèƒ½åŠ›å’Œé²æ£’æ€§ï¼Œé™ä½äººå·¥å¹²é¢„çš„éœ€æ±‚ï¼Œå…·æœ‰å¹¿æ³›çš„åº”ç”¨å‰æ™¯ï¼Œä¾‹å¦‚æ™ºèƒ½åˆ¶é€ ã€è‡ªåŠ¨åŒ–ç‰©æµã€å®¶åº­æœåŠ¡ç­‰ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Multi-stage sequential (MSS) robotic manipulation tasks are prevalent and crucial in robotics. They often involve state ambiguity, where visually similar observations correspond to different actions. We present SAGE, a state-aware guided imitation learning framework that models tasks as a Hidden Markov Decision Process (HMDP) to explicitly capture latent task stages and resolve ambiguity. We instantiate the HMDP with a state transition network that infers hidden states, and a state-aware action policy that conditions on both observations and hidden states to produce actions, thereby enabling disambiguation across task stages. To reduce manual annotation effort, we propose a semi-automatic labeling pipeline combining active learning and soft label interpolation. In real-world experiments across multiple complex MSS tasks with state ambiguity, SAGE achieved 100% task success under the standard evaluation protocol, markedly surpassing the baselines. Ablation studies further show that such performance can be maintained with manual labeling for only about 13% of the states, indicating its strong effectiveness.

