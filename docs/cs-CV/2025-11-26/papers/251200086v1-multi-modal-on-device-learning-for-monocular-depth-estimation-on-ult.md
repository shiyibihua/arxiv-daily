---
layout: default
title: Multi-modal On-Device Learning for Monocular Depth Estimation on Ultra-low-power MCUs
---

# Multi-modal On-Device Learning for Monocular Depth Estimation on Ultra-low-power MCUs

**arXiv**: [2512.00086v1](https://arxiv.org/abs/2512.00086) | [PDF](https://arxiv.org/pdf/2512.00086.pdf)

**ä½œè€…**: Davide Nadalini, Manuele Rusci, Elia Cereda, Luca Benini, Francesco Conti, Daniele Palossi

**åˆ†ç±»**: cs.CV

**å‘å¸ƒæ—¥æœŸ**: 2025-11-26

**å¤‡æ³¨**: 14 pages, 9 figures, 3 tables. Associated open-source release available at: https://github.com/dnadalini/ondevice_learning_for_monocular_depth_estimation

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºä¸€ç§å¤šæ¨¡æ€ç‰‡ä¸Šå­¦ä¹ æ–¹æ³•ï¼Œç”¨äºŽè¶…ä½ŽåŠŸè€—MCUä¸Šçš„å•ç›®æ·±åº¦ä¼°è®¡ã€‚**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸‰ï¼šç©ºé—´æ„ŸçŸ¥ (Perception & SLAM)**

**å…³é”®è¯**: `å•ç›®æ·±åº¦ä¼°è®¡` `ç‰‡ä¸Šå­¦ä¹ ` `å¤šæ¨¡æ€èžåˆ` `ç‰©è”ç½‘` `è¶…ä½ŽåŠŸè€—` `é¢†åŸŸè‡ªé€‚åº”` `ç¨€ç–æ›´æ–°`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. çŽ°æœ‰å•ç›®æ·±åº¦ä¼°è®¡æ¨¡åž‹åœ¨IoTè®¾å¤‡ä¸Šéƒ¨ç½²æ—¶ï¼Œç”±äºŽé¢†åŸŸè¿ç§»å¯¼è‡´ç²¾åº¦æ˜¾è‘—ä¸‹é™ã€‚
2. æå‡ºä¸€ç§å¤šæ¨¡æ€ç‰‡ä¸Šå­¦ä¹ æ–¹æ³•ï¼Œåˆ©ç”¨æ·±åº¦ä¼ æ„Ÿå™¨ç”Ÿæˆä¼ªæ ‡ç­¾ï¼Œå¹¶åœ¨MCUä¸Šè¿›è¡Œæ¨¡åž‹å¾®è°ƒã€‚
3. å®žéªŒè¡¨æ˜Žï¼Œè¯¥æ–¹æ³•åœ¨å®žé™…åœºæ™¯ä¸­èƒ½æœ‰æ•ˆé™ä½Žæ·±åº¦ä¼°è®¡è¯¯å·®ï¼Œä¸”å¾®è°ƒè¿‡ç¨‹é«˜æ•ˆã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

å•ç›®æ·±åº¦ä¼°è®¡(MDE)åœ¨è¶…ä½ŽåŠŸè€—(ULP)ç‰©è”ç½‘(IoT)å¹³å°ä¸­å®žçŽ°ç©ºé—´æ„ŸçŸ¥åº”ç”¨æ–¹é¢èµ·ç€å…³é”®ä½œç”¨ã€‚ç„¶è€Œï¼Œä¸ºIoTèŠ‚ç‚¹è®¾è®¡çš„MDEæ·±åº¦ç¥žç»ç½‘ç»œçš„å‚æ•°æ•°é‡æœ‰é™ï¼Œå¯¼è‡´å½“çŽ°åœºè§‚å¯Ÿåˆ°çš„ä¼ æ„Ÿå™¨æ•°æ®ä¸Žè®­ç»ƒæ•°æ®é›†æ˜¾è‘—ä¸åŒæ—¶ï¼Œç²¾åº¦ä¼šä¸¥é‡ä¸‹é™ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé¢†åŸŸè¿ç§»é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§å¤šæ¨¡æ€ç‰‡ä¸Šå­¦ä¹ (ODL)æŠ€æœ¯ï¼Œéƒ¨ç½²åœ¨é›†æˆäº†Greenwaves GAP9å¾®æŽ§åˆ¶å™¨å•å…ƒ(MCU)ã€80mWå•ç›®ç›¸æœºå’Œ8x8åƒç´ æ·±åº¦ä¼ æ„Ÿå™¨çš„IoTè®¾å¤‡ä¸Šï¼ŒåŠŸè€—çº¦ä¸º300mWã€‚åœ¨æ­£å¸¸è¿è¡Œä¸­ï¼Œè¯¥è®¾ç½®ä½¿ç”¨å•ç›®å›¾åƒä¸ºå¾®åž‹107kå‚æ•°çš„Î¼PyD-Netæ¨¡åž‹æä¾›æŽ¨ç†ã€‚æ·±åº¦ä¼ æ„Ÿå™¨é€šå¸¸è¢«åœç”¨ä»¥æœ€å°åŒ–èƒ½è€—ï¼Œä»…å½“ç³»ç»Ÿæ”¾ç½®åœ¨æ–°çš„çŽ¯å¢ƒä¸­æ—¶ï¼Œæ‰ä¸Žç›¸æœºä¸€èµ·æ¿€æ´»ä»¥æ”¶é›†ä¼ªæ ‡ç­¾ã€‚ç„¶åŽï¼Œä½¿ç”¨æ–°æ•°æ®å®Œå…¨åœ¨MCUä¸Šæ‰§è¡Œå¾®è°ƒä»»åŠ¡ã€‚ä¸ºäº†ä¼˜åŒ–æˆ‘ä»¬åŸºäºŽåå‘ä¼ æ’­çš„ç‰‡ä¸Šè®­ç»ƒï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ç§æ–°é¢–çš„å†…å­˜é©±åŠ¨çš„ç¨€ç–æ›´æ–°æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆå°†å¾®è°ƒå†…å­˜æœ€å°åŒ–åˆ°1.2MBï¼Œæ¯”å®Œæ•´æ›´æ–°å°‘2.2å€ï¼ŒåŒæ—¶ä¿æŒç²¾åº¦ï¼ˆå³ï¼Œåœ¨KITTIå’ŒNYUv2æ•°æ®é›†ä¸Šä»…ä¸‹é™2%å’Œ1.5%ï¼‰ã€‚æˆ‘ä»¬çš„çŽ°åœºæµ‹è¯•é¦–æ¬¡è¯æ˜Žï¼ŒMDEçš„ODLå¯ä»¥åœ¨IoTèŠ‚ç‚¹ä¸Šåœ¨17.8åˆ†é’Ÿå†…å®Œæˆï¼Œä»…ä½¿ç”¨åœ¨å®žé™…éƒ¨ç½²åœºæ™¯ä¸­æ”¶é›†çš„3kä¸ªè‡ªæ ‡è®°æ ·æœ¬ï¼Œå°±å°†å‡æ–¹æ ¹è¯¯å·®ä»Ž4.9ç±³é™ä½Žåˆ°0.6ç±³ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³å•ç›®æ·±åº¦ä¼°è®¡æ¨¡åž‹åœ¨å®žé™…IoTéƒ¨ç½²ä¸­ï¼Œç”±äºŽæ•°æ®åˆ†å¸ƒä¸Žè®­ç»ƒé›†å·®å¼‚è¿‡å¤§å¯¼è‡´çš„ç²¾åº¦ä¸‹é™é—®é¢˜ã€‚çŽ°æœ‰æ–¹æ³•é€šå¸¸ä¾èµ–äºŽé¢„è®­ç»ƒæ¨¡åž‹ï¼Œéš¾ä»¥é€‚åº”æ–°çš„çŽ¯å¢ƒï¼Œä¸”åœ¨èµ„æºå—é™çš„MCUä¸Šè¿›è¡Œæ¨¡åž‹æ›´æ–°é¢ä¸´æŒ‘æˆ˜ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯åˆ©ç”¨ç‰‡ä¸Šæ·±åº¦ä¼ æ„Ÿå™¨èŽ·å–ä¼ªæ ‡ç­¾ï¼Œå¹¶ç»“åˆå•ç›®å›¾åƒæ•°æ®ï¼Œåœ¨MCUä¸Šè¿›è¡Œæ¨¡åž‹çš„åœ¨çº¿å¾®è°ƒã€‚é€šè¿‡å¤šæ¨¡æ€ä¿¡æ¯çš„èžåˆï¼Œä½¿æ¨¡åž‹èƒ½å¤Ÿå¿«é€Ÿé€‚åº”æ–°çš„çŽ¯å¢ƒï¼Œæé«˜æ·±åº¦ä¼°è®¡çš„å‡†ç¡®æ€§ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šè¯¥æ–¹æ³•çš„æŠ€æœ¯æ¡†æž¶ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªé˜¶æ®µï¼š1) ä½¿ç”¨å•ç›®ç›¸æœºè¿›è¡Œå›¾åƒé‡‡é›†ï¼›2) åœ¨æ–°çŽ¯å¢ƒä¸­ï¼Œæ¿€æ´»æ·±åº¦ä¼ æ„Ÿå™¨ï¼Œä¸Žå•ç›®ç›¸æœºåŒæ­¥é‡‡é›†æ•°æ®ï¼Œç”Ÿæˆä¼ªæ ‡ç­¾ï¼›3) ä½¿ç”¨é‡‡é›†åˆ°çš„æ•°æ®ï¼Œåœ¨MCUä¸Šå¯¹é¢„è®­ç»ƒçš„å•ç›®æ·±åº¦ä¼°è®¡æ¨¡åž‹è¿›è¡Œå¾®è°ƒï¼›4) å¾®è°ƒåŽçš„æ¨¡åž‹ç”¨äºŽåŽç»­çš„å•ç›®æ·±åº¦ä¼°è®¡ä»»åŠ¡ã€‚

**å…³é”®åˆ›æ–°**ï¼šè¯¥æ–¹æ³•æœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°ç‚¹åœ¨äºŽæå‡ºäº†ä¸€ç§å†…å­˜é©±åŠ¨çš„ç¨€ç–æ›´æ–°æ–¹æ¡ˆï¼Œç”¨äºŽä¼˜åŒ–ç‰‡ä¸Šè®­ç»ƒè¿‡ç¨‹ã€‚è¯¥æ–¹æ¡ˆé€šè¿‡é€‰æ‹©æ€§åœ°æ›´æ–°æ¨¡åž‹å‚æ•°ï¼Œæ˜¾è‘—é™ä½Žäº†å¾®è°ƒæ‰€éœ€çš„å†…å­˜ç©ºé—´ï¼Œä½¿å¾—åœ¨èµ„æºå—é™çš„MCUä¸Šè¿›è¡Œæ¨¡åž‹å¾®è°ƒæˆä¸ºå¯èƒ½ã€‚

**å…³é”®è®¾è®¡**ï¼šè®ºæ–‡çš„å…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) ä½¿ç”¨å¾®åž‹åŒ–çš„å•ç›®æ·±åº¦ä¼°è®¡æ¨¡åž‹ï¼ˆÎ¼PyD-Netï¼‰ï¼Œä»¥é€‚åº”MCUçš„è®¡ç®—èƒ½åŠ›ï¼›2) è®¾è®¡äº†ä¸€ç§å†…å­˜é©±åŠ¨çš„ç¨€ç–æ›´æ–°æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆæ ¹æ®å‚æ•°çš„é‡è¦æ€§é€‰æ‹©æ€§åœ°æ›´æ–°å‚æ•°ï¼Œä»Žè€Œå‡å°‘å†…å­˜å ç”¨ï¼›3) é‡‡ç”¨åå‘ä¼ æ’­ç®—æ³•è¿›è¡Œæ¨¡åž‹å¾®è°ƒï¼Œå¹¶ä¼˜åŒ–äº†åå‘ä¼ æ’­è¿‡ç¨‹ï¼Œä»¥æé«˜è®­ç»ƒæ•ˆçŽ‡ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

å®žéªŒç»“æžœè¡¨æ˜Žï¼Œè¯¥æ–¹æ³•åœ¨IoTèŠ‚ç‚¹ä¸Šä»…ç”¨17.8åˆ†é’Ÿå³å¯å®Œæˆå•ç›®æ·±åº¦ä¼°è®¡æ¨¡åž‹çš„ç‰‡ä¸Šå­¦ä¹ ï¼Œå¹¶ä¸”ä»…ä½¿ç”¨3kä¸ªè‡ªæ ‡è®°æ ·æœ¬ï¼Œå°±å°†å‡æ–¹æ ¹è¯¯å·®ä»Ž4.9ç±³é™ä½Žåˆ°0.6ç±³ã€‚åŒæ—¶ï¼Œæå‡ºçš„å†…å­˜é©±åŠ¨ç¨€ç–æ›´æ–°æ–¹æ¡ˆå°†å¾®è°ƒå†…å­˜é™ä½Žåˆ°1.2MBï¼Œæ¯”å®Œæ•´æ›´æ–°å‡å°‘2.2å€ï¼Œè€Œç²¾åº¦ä»…ä¸‹é™2%ï¼ˆKITTIï¼‰å’Œ1.5%ï¼ˆNYUv2ï¼‰ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæžœå¯å¹¿æ³›åº”ç”¨äºŽèµ„æºå—é™çš„ç‰©è”ç½‘è®¾å¤‡ï¼Œä¾‹å¦‚æ™ºèƒ½å®¶å±…ã€æœºå™¨äººå¯¼èˆªã€çŽ¯å¢ƒç›‘æµ‹ç­‰é¢†åŸŸã€‚é€šè¿‡ç‰‡ä¸Šå­¦ä¹ ï¼Œè®¾å¤‡èƒ½å¤Ÿé€‚åº”ä¸åŒçš„çŽ¯å¢ƒå’Œåœºæ™¯ï¼Œæé«˜æ„ŸçŸ¥èƒ½åŠ›å’Œæ™ºèƒ½åŒ–æ°´å¹³ã€‚è¯¥æŠ€æœ¯è¿˜æœ‰åŠ©äºŽé™ä½Žå¯¹äº‘ç«¯è®¡ç®—çš„ä¾èµ–ï¼Œæé«˜æ•°æ®éšç§æ€§ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Monocular depth estimation (MDE) plays a crucial role in enabling spatially-aware applications in Ultra-low-power (ULP) Internet-of-Things (IoT) platforms. However, the limited number of parameters of Deep Neural Networks for the MDE task, designed for IoT nodes, results in severe accuracy drops when the sensor data observed in the field shifts significantly from the training dataset. To address this domain shift problem, we present a multi-modal On-Device Learning (ODL) technique, deployed on an IoT device integrating a Greenwaves GAP9 MicroController Unit (MCU), a 80 mW monocular camera and a 8 x 8 pixel depth sensor, consuming $\approx$300mW. In its normal operation, this setup feeds a tiny 107 k-parameter $Î¼$PyD-Net model with monocular images for inference. The depth sensor, usually deactivated to minimize energy consumption, is only activated alongside the camera to collect pseudo-labels when the system is placed in a new environment. Then, the fine-tuning task is performed entirely on the MCU, using the new data. To optimize our backpropagation-based on-device training, we introduce a novel memory-driven sparse update scheme, which minimizes the fine-tuning memory to 1.2 MB, 2.2x less than a full update, while preserving accuracy (i.e., only 2% and 1.5% drops on the KITTI and NYUv2 datasets). Our in-field tests demonstrate, for the first time, that ODL for MDE can be performed in 17.8 minutes on the IoT node, reducing the root mean squared error from 4.9 to 0.6m with only 3 k self-labeled samples, collected in a real-life deployment scenario.

