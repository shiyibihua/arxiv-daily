---
layout: default
title: Towards Unbiased Cross-Modal Representation Learning for Food Image-to-Recipe Retrieval
---

# Towards Unbiased Cross-Modal Representation Learning for Food Image-to-Recipe Retrieval

**arXiv**: [2511.15201v1](https://arxiv.org/abs/2511.15201) | [PDF](https://arxiv.org/pdf/2511.15201.pdf)

**ä½œè€…**: Qing Wang, Chong-Wah Ngo, Ee-Peng Lim

**åˆ†ç±»**: cs.CV, cs.MM

**å‘å¸ƒæ—¥æœŸ**: 2025-11-19

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºåŸºäºŽå› æžœæŽ¨æ–­çš„è§£åæ–¹æ³•ï¼Œæå‡é£Ÿç‰©å›¾åƒ-èœè°±è·¨æ¨¡æ€æ£€ç´¢æ€§èƒ½**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸Žæž¶æž„ (RL & Architecture)**

**å…³é”®è¯**: `è·¨æ¨¡æ€æ£€ç´¢` `å› æžœæŽ¨æ–­` `è¡¨å¾å­¦ä¹ ` `é£Ÿç‰©å›¾åƒ` `èœè°±æ£€ç´¢` `åå·®æ¶ˆé™¤` `Recipe1Mæ•°æ®é›†`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. çŽ°æœ‰é£Ÿç‰©å›¾åƒ-èœè°±æ£€ç´¢æ–¹æ³•å°†èœè°±è§†ä¸ºå›¾åƒçš„æ–‡æœ¬æè¿°ï¼Œå¿½ç•¥äº†äºŒè€…ä¹‹é—´çš„å› æžœå…³ç³»ï¼Œå¯¼è‡´æ¨¡åž‹å­¦ä¹ äº§ç”Ÿåå·®ã€‚
2. è®ºæ–‡åˆ©ç”¨å› æžœæŽ¨æ–­ç†è®ºï¼Œå°†é£Ÿæè§†ä¸ºæ··æ·†å› ç´ ï¼Œé€šè¿‡åŽé—¨è°ƒæ•´æ¥å‡è½»åå·®ï¼Œä»Žè€Œæ¶ˆé™¤ç›¸ä¼¼æ€§åˆ¤æ–­ä¸­çš„æ½œåœ¨åå·®ã€‚
3. å®žéªŒç»“æžœè¡¨æ˜Žï¼Œè¯¥æ–¹æ³•åœ¨Recipe1Mæ•°æ®é›†ä¸Šå–å¾—äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼Œå¹¶æå‡ºäº†ä¸€ä¸ªå³æ’å³ç”¨çš„ç¥žç»æ¨¡å—ç”¨äºŽåŽ»åã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æ—¨åœ¨è§£å†³è·¨æ¨¡æ€æ£€ç´¢ä¸­èœè°±å’Œé£Ÿç‰©å›¾åƒè¡¨å¾å­¦ä¹ çš„æŒ‘æˆ˜ã€‚çŽ°æœ‰æ–¹æ³•å°†èœè°±è§†ä¸ºé£Ÿç‰©å›¾åƒçš„æ–‡æœ¬æè¿°ï¼Œå¿½ç•¥äº†èœè°±ä¸Žé£Ÿç‰©ä¹‹é—´çš„å› æžœå…³ç³»ï¼Œå¯¼è‡´è¡¨å¾å­¦ä¹ äº§ç”Ÿåå·®ï¼Œè¯¯å¯¼å›¾åƒ-èœè°±ç›¸ä¼¼æ€§åˆ¤æ–­ã€‚å…·ä½“è€Œè¨€ï¼Œç”±äºŽçƒ¹é¥ªè¿‡ç¨‹ã€é£Ÿç‰©å‘ˆçŽ°å’Œå›¾åƒæ‹æ‘„æ¡ä»¶ç­‰å› ç´ ï¼Œé£Ÿç‰©å›¾åƒå¯èƒ½æ— æ³•å®Œå…¨æ•æ‰èœè°±ä¸­çš„æ‰€æœ‰ç»†èŠ‚ã€‚å½“å‰çš„è¡¨å¾å­¦ä¹ å€¾å‘äºŽæ•æ‰ä¸»è¦çš„è§†è§‰-æ–‡æœ¬å¯¹é½ï¼Œè€Œå¿½ç•¥äº†å†³å®šæ£€ç´¢ç›¸å…³æ€§çš„ç»†å¾®å˜åŒ–ã€‚æœ¬æ–‡åˆ©ç”¨å› æžœç†è®ºå¯¹è·¨æ¨¡æ€è¡¨å¾å­¦ä¹ ä¸­çš„è¿™ç§åå·®è¿›è¡Œå»ºæ¨¡ï¼Œè®¤ä¸ºé£Ÿææ˜¯æ··æ·†å› ç´ ä¹‹ä¸€ï¼Œå¹¶é‡‡ç”¨ç®€å•çš„åŽé—¨è°ƒæ•´æ¥å‡è½»åå·®ã€‚é€šè¿‡å› æžœå¹²é¢„ï¼Œæœ¬æ–‡é‡æ–°æž„å»ºäº†ä¼ ç»Ÿçš„é£Ÿç‰©-èœè°±æ£€ç´¢æ¨¡åž‹ï¼Œå¢žåŠ äº†ä¸€ä¸ªé¢å¤–çš„é¡¹æ¥æ¶ˆé™¤ç›¸ä¼¼æ€§åˆ¤æ–­ä¸­çš„æ½œåœ¨åå·®ã€‚åŸºäºŽè¯¥ç†è®ºé©±åŠ¨çš„å…¬å¼ï¼Œç»éªŒè¯å®žåœ¨Recipe1Mæ•°æ®é›†ä¸Šï¼Œæ£€ç´¢çš„oracleæ€§èƒ½åœ¨1Kã€10Kç”šè‡³50Kçš„æµ‹è¯•æ•°æ®è§„æ¨¡ä¸‹å‡è¾¾åˆ°MedR=1ã€‚æ­¤å¤–ï¼Œæœ¬æ–‡è¿˜æå‡ºäº†ä¸€ç§å³æ’å³ç”¨çš„ç¥žç»æ¨¡å—ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç”¨äºŽåŽ»åçš„å¤šæ ‡ç­¾é£Ÿæåˆ†ç±»å™¨ã€‚åœ¨Recipe1Mæ•°æ®é›†ä¸ŠæŠ¥å‘Šäº†æ–°çš„æœ€å…ˆè¿›çš„æœç´¢æ€§èƒ½ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³é£Ÿç‰©å›¾åƒåˆ°èœè°±æ£€ç´¢ä»»åŠ¡ä¸­ï¼Œç”±äºŽèœè°±å’Œé£Ÿç‰©å›¾åƒä¹‹é—´å­˜åœ¨å› æžœå…³ç³»ï¼ˆèœè°±æ˜¯å› ï¼Œé£Ÿç‰©å›¾åƒæ˜¯æžœï¼‰ï¼Œè€ŒçŽ°æœ‰æ–¹æ³•å°†å…¶è§†ä¸ºç®€å•çš„æ–‡æœ¬æè¿°ï¼Œä»Žè€Œå¼•å…¥çš„åå·®é—®é¢˜ã€‚è¿™ç§åå·®å¯¼è‡´æ¨¡åž‹åœ¨å­¦ä¹ è¡¨å¾æ—¶ï¼Œè¿‡åº¦å…³æ³¨å›¾åƒä¸­æ˜¾è‘—çš„è§†è§‰ç‰¹å¾ï¼Œè€Œå¿½ç•¥äº†èœè°±ä¸­ç»†å¾®ä½†é‡è¦çš„ä¿¡æ¯ï¼Œæœ€ç»ˆå½±å“æ£€ç´¢çš„å‡†ç¡®æ€§ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯åˆ©ç”¨å› æžœæŽ¨æ–­ç†è®ºæ¥å»ºæ¨¡å’Œæ¶ˆé™¤è¿™ç§åå·®ã€‚å…·ä½“æ¥è¯´ï¼Œè®ºæ–‡å°†é£Ÿæè§†ä¸ºèœè°±å’Œé£Ÿç‰©å›¾åƒä¹‹é—´çš„æ··æ·†å› ç´ ï¼Œå› ä¸ºé£Ÿææ—¢å½±å“èœè°±çš„æè¿°ï¼Œä¹Ÿå½±å“é£Ÿç‰©å›¾åƒçš„è§†è§‰å‘ˆçŽ°ã€‚é€šè¿‡å› æžœå¹²é¢„ï¼Œå¯ä»¥æ¶ˆé™¤é£Ÿæè¿™ä¸ªæ··æ·†å› ç´ å¯¹å›¾åƒ-èœè°±ç›¸ä¼¼æ€§åˆ¤æ–­çš„å½±å“ï¼Œä»Žè€Œå®žçŽ°æ›´å‡†ç¡®çš„æ£€ç´¢ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šè®ºæ–‡æå‡ºçš„æ–¹æ³•ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ¨¡å—ï¼š1) ä¼ ç»Ÿçš„å›¾åƒå’Œæ–‡æœ¬è¡¨å¾å­¦ä¹ æ¨¡å—ï¼Œç”¨äºŽæå–å›¾åƒå’Œèœè°±çš„ç‰¹å¾ï¼›2) ä¸€ä¸ªå¤šæ ‡ç­¾é£Ÿæåˆ†ç±»å™¨ï¼Œç”¨äºŽé¢„æµ‹èœè°±ä¸­åŒ…å«çš„é£Ÿæï¼›3) ä¸€ä¸ªå› æžœå¹²é¢„æ¨¡å—ï¼Œåˆ©ç”¨é£Ÿæåˆ†ç±»å™¨çš„è¾“å‡ºï¼Œå¯¹å›¾åƒå’Œèœè°±çš„è¡¨å¾è¿›è¡Œè°ƒæ•´ï¼Œä»Žè€Œæ¶ˆé™¤é£Ÿæè¿™ä¸ªæ··æ·†å› ç´ çš„å½±å“ã€‚æ•´ä½“æµç¨‹æ˜¯å…ˆæå–å›¾åƒå’Œèœè°±çš„ç‰¹å¾ï¼Œç„¶åŽåˆ©ç”¨é£Ÿæåˆ†ç±»å™¨é¢„æµ‹é£Ÿæï¼Œæœ€åŽé€šè¿‡å› æžœå¹²é¢„è°ƒæ•´è¡¨å¾ï¼Œç”¨äºŽç›¸ä¼¼åº¦è®¡ç®—å’Œæ£€ç´¢ã€‚

**å…³é”®åˆ›æ–°**ï¼šè®ºæ–‡æœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°ç‚¹åœ¨äºŽå°†å› æžœæŽ¨æ–­å¼•å…¥åˆ°è·¨æ¨¡æ€æ£€ç´¢ä»»åŠ¡ä¸­ï¼Œå¹¶åˆ©ç”¨åŽé—¨è°ƒæ•´æ¥æ¶ˆé™¤åå·®ã€‚ä¸ŽçŽ°æœ‰æ–¹æ³•ç›¸æ¯”ï¼Œè¯¥æ–¹æ³•èƒ½å¤Ÿæ›´å‡†ç¡®åœ°å»ºæ¨¡èœè°±å’Œé£Ÿç‰©å›¾åƒä¹‹é—´çš„å…³ç³»ï¼Œå¹¶æœ‰æ•ˆåœ°æ¶ˆé™¤åå·®ï¼Œä»Žè€Œæé«˜æ£€ç´¢çš„å‡†ç¡®æ€§ã€‚æ­¤å¤–ï¼Œæå‡ºçš„å³æ’å³ç”¨ç¥žç»æ¨¡å—ä¹Ÿæ–¹ä¾¿é›†æˆåˆ°çŽ°æœ‰çš„æ¨¡åž‹ä¸­ã€‚

**å…³é”®è®¾è®¡**ï¼šè®ºæ–‡çš„å…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) ä½¿ç”¨å¤šæ ‡ç­¾åˆ†ç±»å™¨é¢„æµ‹é£Ÿæï¼Œå¹¶å°†å…¶ä½œä¸ºå› æžœå¹²é¢„çš„ä¾æ®ï¼›2) ä½¿ç”¨åŽé—¨è°ƒæ•´å…¬å¼ï¼Œå¯¹å›¾åƒå’Œèœè°±çš„è¡¨å¾è¿›è¡Œè°ƒæ•´ï¼Œå…·ä½“è°ƒæ•´æ–¹å¼æœªçŸ¥ï¼Œè®ºæ–‡ä¸­å¯èƒ½æ¶‰åŠç‰¹å®šçš„æŸå¤±å‡½æ•°æˆ–ç½‘ç»œç»“æž„è®¾è®¡æ¥å®žæ–½è¿™ç§è°ƒæ•´ï¼›3) å°†è¯¥æ¨¡å—è®¾è®¡ä¸ºå³æ’å³ç”¨ï¼Œæ–¹ä¾¿é›†æˆåˆ°çŽ°æœ‰çš„æ¨¡åž‹ä¸­ã€‚å…·ä½“å‚æ•°è®¾ç½®å’Œç½‘ç»œç»“æž„ç»†èŠ‚åœ¨è®ºæ–‡ä¸­å¯èƒ½æœ‰æ‰€æè¿°ï¼Œä½†æ‘˜è¦ä¸­æœªæåŠã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

å®žéªŒç»“æžœè¡¨æ˜Žï¼Œè¯¥æ–¹æ³•åœ¨Recipe1Mæ•°æ®é›†ä¸Šå–å¾—äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼Œåœ¨ä¸åŒæ•°æ®è§„æ¨¡ï¼ˆ1Kã€10Kã€50Kï¼‰çš„æµ‹è¯•é›†ä¸Šå‡è¾¾åˆ°äº†MedR=1çš„oracleæ€§èƒ½ã€‚æ­¤å¤–ï¼Œè®ºæ–‡æå‡ºçš„å³æ’å³ç”¨ç¥žç»æ¨¡å—ä¹Ÿè¿›ä¸€æ­¥æå‡äº†æ£€ç´¢æ€§èƒ½ï¼Œè¾¾åˆ°äº†æ–°çš„state-of-the-artæ°´å¹³ã€‚å…·ä½“çš„æ€§èƒ½æå‡å¹…åº¦éœ€è¦å‚è€ƒè®ºæ–‡ä¸­çš„è¯¦ç»†å®žéªŒæ•°æ®ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæžœå¯åº”ç”¨äºŽæ™ºèƒ½èœè°±æŽ¨èç³»ç»Ÿã€é£Ÿå“å›¾åƒè¯†åˆ«ä¸Žåˆ†æžã€ä»¥åŠè¥å…»å¥åº·ç®¡ç†ç­‰é¢†åŸŸã€‚é€šè¿‡æ›´å‡†ç¡®åœ°ç†è§£é£Ÿç‰©å›¾åƒå’Œèœè°±ä¹‹é—´çš„å…³ç³»ï¼Œå¯ä»¥ä¸ºç”¨æˆ·æä¾›æ›´ä¸ªæ€§åŒ–ã€æ›´ç²¾å‡†çš„èœè°±æŽ¨èï¼Œå¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°è¿›è¡Œè†³é£Ÿè§„åˆ’å’Œå¥åº·ç®¡ç†ã€‚æ­¤å¤–ï¼Œè¯¥æŠ€æœ¯è¿˜å¯ä»¥åº”ç”¨äºŽé£Ÿå“è¡Œä¸šçš„è‡ªåŠ¨åŒ–ç”Ÿäº§å’Œè´¨é‡æŽ§åˆ¶ï¼Œæé«˜ç”Ÿäº§æ•ˆçŽ‡å’Œäº§å“è´¨é‡ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> This paper addresses the challenges of learning representations for recipes and food images in the cross-modal retrieval problem. As the relationship between a recipe and its cooked dish is cause-and-effect, treating a recipe as a text source describing the visual appearance of a dish for learning representation, as the existing approaches, will create bias misleading image-and-recipe similarity judgment. Specifically, a food image may not equally capture every detail in a recipe, due to factors such as the cooking process, dish presentation, and image-capturing conditions. The current representation learning tends to capture dominant visual-text alignment while overlooking subtle variations that determine retrieval relevance. In this paper, we model such bias in cross-modal representation learning using causal theory. The causal view of this problem suggests ingredients as one of the confounder sources and a simple backdoor adjustment can alleviate the bias. By causal intervention, we reformulate the conventional model for food-to-recipe retrieval with an additional term to remove the potential bias in similarity judgment. Based on this theory-informed formulation, we empirically prove the oracle performance of retrieval on the Recipe1M dataset to be MedR=1 across the testing data sizes of 1K, 10K, and even 50K. We also propose a plug-and-play neural module, which is essentially a multi-label ingredient classifier for debiasing. New state-of-the-art search performances are reported on the Recipe1M dataset.

