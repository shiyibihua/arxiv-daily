---
layout: default
title: SMamDiff: Spatial Mamba for Stochastic Human Motion Prediction
---

# SMamDiff: Spatial Mamba for Stochastic Human Motion Prediction

**arXiv**: [2512.00355v1](https://arxiv.org/abs/2512.00355) | [PDF](https://arxiv.org/pdf/2512.00355.pdf)

**ä½œè€…**: Junqiao Fan, Pengfei Liu, Haocong Rao

**åˆ†ç±»**: cs.CV

**å‘å¸ƒæ—¥æœŸ**: 2025-11-29

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºSMamDiffï¼Œä¸€ç§åŸºäºŽç©ºé—´Mambaçš„å•é˜¶æ®µæ‰©æ•£æ¨¡åž‹ï¼Œç”¨äºŽéšæœºäººä½“è¿åŠ¨é¢„æµ‹ã€‚**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸Žæž¶æž„ (RL & Architecture)**

**å…³é”®è¯**: `äººä½“è¿åŠ¨é¢„æµ‹` `æ‰©æ•£æ¨¡åž‹` `ç©ºé—´Mamba` `æ—¶ç©ºè¿žè´¯æ€§` `æ®‹å·®DCT` `å•é˜¶æ®µæ¨¡åž‹` `è¾¹ç¼˜è®¡ç®—`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. çŽ°æœ‰HMPæ–¹æ³•éš¾ä»¥å…¼é¡¾é¢„æµ‹ç»“æžœçš„å‡†ç¡®æ€§ã€å¤šæ ·æ€§å’Œè¿åŠ¨å­¦åˆç†æ€§ï¼Œä¸”å¤šé˜¶æ®µæ‰©æ•£æ¨¡åž‹è®¡ç®—æˆæœ¬é«˜æ˜‚ï¼Œä¸åˆ©äºŽè¾¹ç¼˜éƒ¨ç½²ã€‚
2. SMamDiffé€šè¿‡æ®‹å·®DCTç¼–ç æå–é«˜é¢‘è¿åŠ¨ä¿¡æ¯ï¼Œå¹¶åˆ©ç”¨ç©ºé—´Mambaæ¨¡å—å»ºæ¨¡å…³èŠ‚é—´çš„é•¿ç¨‹ä¾èµ–å…³ç³»ï¼Œä»Žè€Œæå‡æ—¶ç©ºè¿žè´¯æ€§ã€‚
3. å®žéªŒè¡¨æ˜Žï¼ŒSMamDiffåœ¨å•é˜¶æ®µæ¦‚çŽ‡HMPæ–¹æ³•ä¸­å–å¾—äº†SOTAç»“æžœï¼Œå¹¶åœ¨å»¶è¿Ÿå’Œå†…å­˜å ç”¨æ–¹é¢ä¼˜äºŽå¤šé˜¶æ®µæ‰©æ•£æ¨¡åž‹ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

éšç€æ™ºèƒ½å®¤å†…ä¼ æ„Ÿå’ŒæœåŠ¡æœºå™¨äººçš„å¹¿æ³›éƒ¨ç½²ï¼Œäººä½“è¿åŠ¨é¢„æµ‹ï¼ˆHMPï¼‰å¯¹äºŽå®‰å…¨ã€ä¸»åŠ¨çš„è¾…åŠ©è‡³å…³é‡è¦ã€‚ç„¶è€Œï¼Œè®¸å¤šçŽ°æœ‰çš„HMPæ–¹æ³•è¦ä¹ˆäº§ç”Ÿå•ä¸€çš„ã€ç¡®å®šæ€§çš„é¢„æµ‹ï¼Œå¿½ç•¥äº†ä¸ç¡®å®šæ€§ï¼Œè¦ä¹ˆä¾èµ–äºŽç‰ºç‰²è¿åŠ¨å­¦åˆç†æ€§çš„æ¦‚çŽ‡æ¨¡åž‹ã€‚æ‰©æ•£æ¨¡åž‹æ”¹å–„äº†å‡†ç¡®æ€§-å¤šæ ·æ€§çš„æƒè¡¡ï¼Œä½†é€šå¸¸ä¾èµ–äºŽå¤šé˜¶æ®µæµç¨‹ï¼Œè¿™å¯¹äºŽè¾¹ç¼˜éƒ¨ç½²æ¥è¯´æˆæœ¬é«˜æ˜‚ã€‚è¿™é¡¹å·¥ä½œä¾§é‡äºŽå¦‚ä½•åœ¨ç”¨äºŽHMPçš„å•é˜¶æ®µæ‰©æ•£æ¨¡åž‹ä¸­ç¡®ä¿æ—¶ç©ºè¿žè´¯æ€§ã€‚æˆ‘ä»¬å¼•å…¥äº†SMamDiffï¼Œä¸€ç§åŸºäºŽç©ºé—´Mambaçš„æ‰©æ•£æ¨¡åž‹ï¼Œå…·æœ‰ä¸¤ä¸ªæ–°é¢–çš„è®¾è®¡ï¼šï¼ˆiï¼‰ä¸€ç§æ®‹å·®-DCTè¿åŠ¨ç¼–ç ï¼Œåœ¨æ—¶é—´DCTä¹‹å‰å‡åŽ»æœ€åŽè§‚å¯Ÿåˆ°çš„å§¿åŠ¿ï¼Œå‡å°‘äº†ç¬¬ä¸€ä¸ªDCåˆ†é‡ï¼ˆf=0ï¼‰çš„ä¸»å¯¼åœ°ä½ï¼Œå¹¶çªå‡ºäº†ä¿¡æ¯é‡æ›´å¤§çš„é«˜é¢‘çº¿ç´¢ï¼Œå› æ­¤æ¨¡åž‹å­¦ä¹ å…³èŠ‚å¦‚ä½•ç§»åŠ¨è€Œä¸æ˜¯å®ƒä»¬åœ¨å“ªé‡Œï¼›ï¼ˆiiï¼‰ä¸€ä¸ªç«æŸ´äººç»˜åˆ¶ç©ºé—´Mambaæ¨¡å—ï¼Œä»¥æœ‰åºçš„ã€é€å…³èŠ‚çš„æ–¹å¼å¤„ç†å…³èŠ‚ï¼Œä½¿åŽé¢çš„å…³èŠ‚ä»¥å‰é¢çš„å…³èŠ‚ä¸ºæ¡ä»¶ï¼Œä»¥è¯±å¯¼é•¿ç¨‹ã€è·¨å…³èŠ‚çš„ä¾èµ–å…³ç³»ã€‚åœ¨Human3.6Må’ŒHumanEvaä¸Šï¼Œè¿™äº›è¿žè´¯æ€§æœºåˆ¶åœ¨å•é˜¶æ®µæ¦‚çŽ‡HMPæ–¹æ³•ä¸­æä¾›äº†æœ€å…ˆè¿›çš„ç»“æžœï¼ŒåŒæ—¶æ¯”å¤šé˜¶æ®µæ‰©æ•£åŸºçº¿ä½¿ç”¨æ›´å°‘çš„å»¶è¿Ÿå’Œå†…å­˜ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šäººä½“è¿åŠ¨é¢„æµ‹ï¼ˆHMPï¼‰æ—¨åœ¨æ ¹æ®è¿‡åŽ»ä¸€æ®µæ—¶é—´çš„äººä½“è¿åŠ¨è½¨è¿¹ï¼Œé¢„æµ‹æœªæ¥ä¸€æ®µæ—¶é—´çš„è¿åŠ¨è½¨è¿¹ã€‚çŽ°æœ‰æ–¹æ³•çš„ç—›ç‚¹åœ¨äºŽï¼Œç¡®å®šæ€§æ¨¡åž‹å¿½ç•¥äº†è¿åŠ¨çš„ä¸ç¡®å®šæ€§ï¼Œæ¦‚çŽ‡æ¨¡åž‹åˆéš¾ä»¥ä¿è¯è¿åŠ¨çš„åˆç†æ€§ï¼Œè€Œå¤šé˜¶æ®µæ‰©æ•£æ¨¡åž‹è®¡ç®—å¼€é”€å¤§ï¼Œéš¾ä»¥éƒ¨ç½²åœ¨è¾¹ç¼˜è®¾å¤‡ä¸Šã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯åœ¨å•é˜¶æ®µæ‰©æ•£æ¨¡åž‹ä¸­ï¼Œé€šè¿‡ç²¾å·§çš„è®¾è®¡æ¥ä¿è¯æ—¶ç©ºè¿žè´¯æ€§ã€‚å…·ä½“æ¥è¯´ï¼Œé€šè¿‡æ®‹å·®DCTç¼–ç ï¼Œä½¿æ¨¡åž‹å…³æ³¨å…³èŠ‚çš„è¿åŠ¨æ¨¡å¼è€Œéžç»å¯¹ä½ç½®ï¼›é€šè¿‡ç©ºé—´Mambaæ¨¡å—ï¼Œå»ºæ¨¡å…³èŠ‚é—´çš„é•¿ç¨‹ä¾èµ–å…³ç³»ï¼Œä¿è¯è¿åŠ¨çš„åè°ƒæ€§ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šSMamDiffçš„æ•´ä½“æ¡†æž¶æ˜¯ä¸€ä¸ªå•é˜¶æ®µæ‰©æ•£æ¨¡åž‹ã€‚é¦–å…ˆï¼Œä½¿ç”¨æ®‹å·®DCTç¼–ç å¯¹è¾“å…¥çš„äººä½“è¿åŠ¨æ•°æ®è¿›è¡Œå¤„ç†ï¼Œæå–è¿åŠ¨ç‰¹å¾ã€‚ç„¶åŽï¼Œå°†è¿™äº›ç‰¹å¾è¾“å…¥åˆ°åŸºäºŽç©ºé—´Mambaçš„æ‰©æ•£æ¨¡åž‹ä¸­ï¼Œè¯¥æ¨¡åž‹é€æ­¥åŽ»å™ªï¼Œæœ€ç»ˆç”Ÿæˆé¢„æµ‹çš„è¿åŠ¨è½¨è¿¹ã€‚

**å…³é”®åˆ›æ–°**ï¼šè®ºæ–‡çš„å…³é”®åˆ›æ–°åœ¨äºŽä¸¤ä¸ªæ–¹é¢ï¼šä¸€æ˜¯æ®‹å·®DCTè¿åŠ¨ç¼–ç ï¼Œå®ƒèƒ½å¤Ÿæœ‰æ•ˆæå–é«˜é¢‘è¿åŠ¨ä¿¡æ¯ï¼Œå‡å°‘ä½Žé¢‘åˆ†é‡çš„å¹²æ‰°ï¼›äºŒæ˜¯ç©ºé—´Mambaæ¨¡å—ï¼Œå®ƒèƒ½å¤Ÿä»¥æœ‰åºçš„æ–¹å¼å¤„ç†å…³èŠ‚ï¼Œå¹¶å»ºæ¨¡å…³èŠ‚é—´çš„é•¿ç¨‹ä¾èµ–å…³ç³»ã€‚

**å…³é”®è®¾è®¡**ï¼šæ®‹å·®DCTç¼–ç çš„å…³é”®åœ¨äºŽå…ˆå‡åŽ»æœ€åŽä¸€ä¸ªè§‚æµ‹åˆ°çš„å§¿åŠ¿ï¼Œå†è¿›è¡ŒDCTå˜æ¢ï¼Œè¿™æ ·å¯ä»¥çªå‡ºè¿åŠ¨çš„å˜åŒ–ä¿¡æ¯ã€‚ç©ºé—´Mambaæ¨¡å—çš„å…³é”®åœ¨äºŽæŒ‰ç…§ç«æŸ´äººéª¨æž¶çš„é¡ºåºå¤„ç†å…³èŠ‚ï¼Œä½¿å¾—åŽé¢çš„å…³èŠ‚å¯ä»¥ä¾èµ–äºŽå‰é¢çš„å…³èŠ‚çš„ä¿¡æ¯ã€‚æŸå¤±å‡½æ•°é‡‡ç”¨æ ‡å‡†çš„æ‰©æ•£æ¨¡åž‹æŸå¤±å‡½æ•°ï¼Œä¾‹å¦‚L2æŸå¤±æˆ–HuberæŸå¤±ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

SMamDiffåœ¨Human3.6Må’ŒHumanEvaæ•°æ®é›†ä¸Šå–å¾—äº†SOTAç»“æžœï¼Œå°¤å…¶æ˜¯åœ¨å•é˜¶æ®µæ¦‚çŽ‡HMPæ–¹æ³•ä¸­ã€‚ä¸Žå¤šé˜¶æ®µæ‰©æ•£æ¨¡åž‹ç›¸æ¯”ï¼ŒSMamDiffåœ¨ä¿è¯æ€§èƒ½çš„åŒæ—¶ï¼Œæ˜¾è‘—é™ä½Žäº†å»¶è¿Ÿå’Œå†…å­˜å ç”¨ï¼Œæ›´é€‚åˆè¾¹ç¼˜éƒ¨ç½²ã€‚å…·ä½“æ€§èƒ½æ•°æ®ï¼ˆä¾‹å¦‚ï¼Œé¢„æµ‹è¯¯å·®çš„é™ä½Žç™¾åˆ†æ¯”ï¼‰åœ¨è®ºæ–‡ä¸­ç»™å‡ºã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæžœå¯åº”ç”¨äºŽæ™ºèƒ½å®¶å±…ã€æœåŠ¡æœºå™¨äººã€è‡ªåŠ¨é©¾é©¶ç­‰é¢†åŸŸã€‚ä¾‹å¦‚ï¼Œåœ¨æ™ºèƒ½å®¶å±…ä¸­ï¼Œæœºå™¨äººå¯ä»¥é¢„æµ‹ç”¨æˆ·çš„è¿åŠ¨è½¨è¿¹ï¼Œä»Žè€Œæå‰å‡†å¤‡å¥½æ‰€éœ€ç‰©å“æˆ–è°ƒæ•´çŽ¯å¢ƒè®¾ç½®ã€‚åœ¨è‡ªåŠ¨é©¾é©¶ä¸­ï¼Œç³»ç»Ÿå¯ä»¥é¢„æµ‹è¡Œäººçš„è¿åŠ¨è½¨è¿¹ï¼Œä»Žè€Œåšå‡ºæ›´å®‰å…¨çš„å†³ç­–ã€‚è¯¥ç ”ç©¶æœ‰åŠ©äºŽæå‡äººæœºäº¤äº’çš„å®‰å…¨æ€§ã€æ•ˆçŽ‡å’Œèˆ’é€‚æ€§ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> With intelligent room-side sensing and service robots widely deployed, human motion prediction (HMP) is essential for safe, proactive assistance. However, many existing HMP methods either produce a single, deterministic forecast that ignores uncertainty or rely on probabilistic models that sacrifice kinematic plausibility. Diffusion models improve the accuracy-diversity trade-off but often depend on multi-stage pipelines that are costly for edge deployment. This work focuses on how to ensure spatial-temporal coherence within a single-stage diffusion model for HMP. We introduce SMamDiff, a Spatial Mamba-based Diffusion model with two novel designs: (i) a residual-DCT motion encoding that subtracts the last observed pose before a temporal DCT, reducing the first DC component ($f=0$) dominance and highlighting informative higher-frequency cues so the model learns how joints move rather than where they are; and (ii) a stickman-drawing spatial-mamba module that processes joints in an ordered, joint-by-joint manner, making later joints condition on earlier ones to induce long-range, cross-joint dependencies. On Human3.6M and HumanEva, these coherence mechanisms deliver state-of-the-art results among single-stage probabilistic HMP methods while using less latency and memory than multi-stage diffusion baselines.

