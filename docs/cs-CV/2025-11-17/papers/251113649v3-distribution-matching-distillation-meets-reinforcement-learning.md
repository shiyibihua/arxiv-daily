---
layout: default
title: Distribution Matching Distillation Meets Reinforcement Learning
---

# Distribution Matching Distillation Meets Reinforcement Learning

**arXiv**: [2511.13649v3](https://arxiv.org/abs/2511.13649) | [PDF](https://arxiv.org/pdf/2511.13649.pdf)

**ä½œè€…**: Dengyang Jiang, Dongyang Liu, Zanyi Wang, Qilong Wu, Liuzhuozheng Li, Hengzhuang Li, Xin Jin, David Liu, Zhen Li, Bo Zhang, Mengmeng Wang, Steven Hoi, Peng Gao, Harry Yang

**åˆ†ç±»**: cs.CV

**å‘å¸ƒæ—¥æœŸ**: 2025-11-17 (æ›´æ–°: 2025-12-08)

**å¤‡æ³¨**: The synergy of reinforcement learning and distribution matching distillation. See more: https://github.com/vvvvvjdy/dmdr

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºDMDRæ¡†æž¶ï¼Œç»“åˆå¼ºåŒ–å­¦ä¹ ä¸Žåˆ†å¸ƒåŒ¹é…è’¸é¦ï¼Œæå‡å°‘æ­¥æ‰©æ•£æ¨¡åž‹çš„ç”Ÿæˆè´¨é‡ã€‚**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸Žæž¶æž„ (RL & Architecture)**

**å…³é”®è¯**: `æ‰©æ•£æ¨¡åž‹` `åˆ†å¸ƒåŒ¹é…è’¸é¦` `å¼ºåŒ–å­¦ä¹ ` `å›¾åƒç”Ÿæˆ` `å°‘æ­¥æŽ¨ç†` `æ¨¡åž‹åŽ‹ç¼©` `ç­–ç•¥ä¼˜åŒ–`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ä¼ ç»Ÿåˆ†å¸ƒåŒ¹é…è’¸é¦ï¼ˆDMDï¼‰å—é™äºŽæ•™å¸ˆæ¨¡åž‹æ€§èƒ½ï¼Œæ— æ³•å……åˆ†å‘æŒ¥å°‘æ­¥ç”Ÿæˆå™¨çš„æ½œåŠ›ã€‚
2. DMDRæ¡†æž¶ç»“åˆå¼ºåŒ–å­¦ä¹ ä¸ŽDMDï¼Œåˆ©ç”¨DMDæŸå¤±ä½œä¸ºæ­£åˆ™åŒ–é¡¹ï¼Œå¹¶ç”¨RLæŒ‡å¯¼æ¨¡å¼è¦†ç›–ï¼Œè§£é”å°‘æ­¥ç”Ÿæˆå™¨èƒ½åŠ›ã€‚
3. å®žéªŒè¡¨æ˜Žï¼ŒDMDRåœ¨è§†è§‰è´¨é‡å’Œæç¤ºä¸€è‡´æ€§æ–¹é¢è¡¨çŽ°é¢†å…ˆï¼Œç”šè‡³è¶…è¶Šäº†å¤šæ­¥æ•™å¸ˆæ¨¡åž‹ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æå‡ºäº†ä¸€ç§åä¸ºDMDRçš„æ–°æ¡†æž¶ï¼Œå®ƒå°†å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰æŠ€æœ¯èžå…¥åˆ°åˆ†å¸ƒåŒ¹é…è’¸é¦ï¼ˆDMDï¼‰è¿‡ç¨‹ä¸­ã€‚DMDæ—¨åœ¨å°†é¢„è®­ç»ƒçš„å¤šæ­¥æ‰©æ•£æ¨¡åž‹æç‚¼ä¸ºå°‘æ­¥æ¨¡åž‹ï¼Œä»¥æé«˜æŽ¨ç†æ•ˆçŽ‡ï¼Œä½†å…¶æ€§èƒ½é€šå¸¸å—é™äºŽæ•™å¸ˆæ¨¡åž‹ã€‚DMDRé€šè¿‡å°†DMDæŸå¤±æœ¬èº«ä½œä¸ºå°‘æ­¥ç”Ÿæˆå™¨RLçš„æœ‰æ•ˆæ­£åˆ™åŒ–é¡¹ï¼Œå…‹æœäº†è¿™ä¸€é™åˆ¶ã€‚åè¿‡æ¥ï¼ŒRLå¯ä»¥æ›´æœ‰æ•ˆåœ°æŒ‡å¯¼DMDä¸­çš„æ¨¡å¼è¦†ç›–è¿‡ç¨‹ã€‚è¿™ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡åŒæ—¶è¿›è¡Œè’¸é¦å’ŒRLæ¥é‡Šæ”¾å°‘æ­¥ç”Ÿæˆå™¨çš„èƒ½åŠ›ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è®¾è®¡äº†åŠ¨æ€åˆ†å¸ƒæŒ‡å¯¼å’ŒåŠ¨æ€é‡å™ªå£°é‡‡æ ·è®­ç»ƒç­–ç•¥ï¼Œä»¥æ”¹å–„åˆå§‹è’¸é¦è¿‡ç¨‹ã€‚å®žéªŒè¡¨æ˜Žï¼ŒDMDRå¯ä»¥åœ¨å°‘æ­¥æ–¹æ³•ä¸­å®žçŽ°é¢†å…ˆçš„è§†è§‰è´¨é‡å’Œæç¤ºä¸€è‡´æ€§ï¼Œç”šè‡³è¡¨çŽ°å‡ºè¶…è¿‡å¤šæ­¥æ•™å¸ˆæ¨¡åž‹çš„æ€§èƒ½ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šçŽ°æœ‰çš„åˆ†å¸ƒåŒ¹é…è’¸é¦ï¼ˆDMDï¼‰æ–¹æ³•ï¼Œè™½ç„¶èƒ½å¤Ÿå°†å¤šæ­¥æ‰©æ•£æ¨¡åž‹åŽ‹ç¼©ä¸ºå°‘æ­¥æ¨¡åž‹ä»¥æé«˜æŽ¨ç†é€Ÿåº¦ï¼Œä½†å°‘æ­¥æ¨¡åž‹çš„æ€§èƒ½å¾€å¾€å—åˆ°é¢„è®­ç»ƒçš„å¤šæ­¥æ•™å¸ˆæ¨¡åž‹çš„é™åˆ¶ï¼Œéš¾ä»¥çªç ´æ•™å¸ˆæ¨¡åž‹çš„æ€§èƒ½ä¸Šé™ã€‚çŽ°æœ‰çš„DMDæ–¹æ³•åœ¨æ¨¡å¼è¦†ç›–æ–¹é¢å­˜åœ¨ä¸è¶³ï¼Œå¯¼è‡´ç”Ÿæˆç»“æžœçš„å¤šæ ·æ€§å—é™ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šDMDRçš„æ ¸å¿ƒæ€è·¯æ˜¯å°†å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰å¼•å…¥åˆ°DMDè¿‡ç¨‹ä¸­ï¼Œåˆ©ç”¨RLæ¥ä¼˜åŒ–å°‘æ­¥ç”Ÿæˆå™¨çš„ç­–ç•¥ï¼Œä½¿å…¶èƒ½å¤Ÿç”Ÿæˆæ›´é«˜è´¨é‡ã€æ›´å¤šæ ·æ€§çš„å›¾åƒã€‚åŒæ—¶ï¼Œå°†DMDæŸå¤±æœ¬èº«ä½œä¸ºRLçš„æ­£åˆ™åŒ–é¡¹ï¼Œé¿å…äº†ä¼ ç»Ÿæ­£åˆ™åŒ–æ–¹æ³•å¯èƒ½å¼•å…¥çš„åå·®ã€‚é€šè¿‡DMDå’ŒRLçš„ååŒä½œç”¨ï¼ŒDMDRèƒ½å¤Ÿçªç ´æ•™å¸ˆæ¨¡åž‹çš„æ€§èƒ½é™åˆ¶ï¼Œå……åˆ†å‘æŒ¥å°‘æ­¥ç”Ÿæˆå™¨çš„æ½œåŠ›ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šDMDRæ¡†æž¶ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªå…³é”®æ¨¡å—ï¼š1) **DMDè’¸é¦æ¨¡å—**ï¼šä½¿ç”¨åˆ†å¸ƒåŒ¹é…æŸå¤±å°†å¤šæ­¥æ•™å¸ˆæ¨¡åž‹çš„çŸ¥è¯†è¿ç§»åˆ°å°‘æ­¥å­¦ç”Ÿæ¨¡åž‹ã€‚2) **RLä¼˜åŒ–æ¨¡å—**ï¼šä½¿ç”¨å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼ˆä¾‹å¦‚ï¼ŒPPOï¼‰ä¼˜åŒ–å°‘æ­¥ç”Ÿæˆå™¨çš„ç­–ç•¥ï¼Œç›®æ ‡æ˜¯æœ€å¤§åŒ–ç”Ÿæˆå›¾åƒçš„è´¨é‡å’Œå¤šæ ·æ€§ã€‚3) **åŠ¨æ€åˆ†å¸ƒæŒ‡å¯¼æ¨¡å—**ï¼šåœ¨åˆå§‹è’¸é¦é˜¶æ®µï¼ŒåŠ¨æ€è°ƒæ•´åˆ†å¸ƒæŒ‡å¯¼çš„å¼ºåº¦ï¼Œä»¥æ”¹å–„è’¸é¦æ•ˆæžœã€‚4) **åŠ¨æ€é‡å™ªå£°é‡‡æ ·æ¨¡å—**ï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒåŠ¨æ€è°ƒæ•´å™ªå£°çš„é‡‡æ ·ç­–ç•¥ï¼Œä»¥æé«˜æ¨¡åž‹çš„é²æ£’æ€§ã€‚æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹æ˜¯DMDè’¸é¦å’ŒRLä¼˜åŒ–äº¤æ›¿è¿›è¡Œï¼Œç›¸äº’ä¿ƒè¿›ã€‚

**å…³é”®åˆ›æ–°**ï¼šDMDRçš„å…³é”®åˆ›æ–°åœ¨äºŽå°†å¼ºåŒ–å­¦ä¹ ä¸Žåˆ†å¸ƒåŒ¹é…è’¸é¦ç›¸ç»“åˆï¼Œå¹¶åˆ©ç”¨DMDæŸå¤±ä½œä¸ºRLçš„æ­£åˆ™åŒ–é¡¹ã€‚è¿™ç§ç»“åˆæ–¹å¼èƒ½å¤Ÿæœ‰æ•ˆåœ°å…‹æœä¼ ç»ŸDMDæ–¹æ³•çš„æ€§èƒ½ç“¶é¢ˆï¼Œå¹¶å……åˆ†å‘æŒ¥å°‘æ­¥ç”Ÿæˆå™¨çš„æ½œåŠ›ã€‚æ­¤å¤–ï¼ŒåŠ¨æ€åˆ†å¸ƒæŒ‡å¯¼å’ŒåŠ¨æ€é‡å™ªå£°é‡‡æ ·ç­–ç•¥ä¹Ÿè¿›ä¸€æ­¥æå‡äº†æ¨¡åž‹çš„æ€§èƒ½å’Œé²æ£’æ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šåœ¨RLä¼˜åŒ–æ¨¡å—ä¸­ï¼Œä½¿ç”¨äº†Proximal Policy Optimization (PPO) ç®—æ³•ã€‚å¥–åŠ±å‡½æ•°çš„è®¾è®¡è‡³å…³é‡è¦ï¼Œé€šå¸¸ç»“åˆäº†å›¾åƒè´¨é‡è¯„ä¼°æŒ‡æ ‡ï¼ˆä¾‹å¦‚ï¼ŒFIDã€Inception Scoreï¼‰å’Œæç¤ºä¸€è‡´æ€§æŒ‡æ ‡ã€‚DMDæŸå¤±è¢«ç”¨ä½œRLçš„æ­£åˆ™åŒ–é¡¹ï¼Œä»¥çº¦æŸç­–ç•¥çš„æ›´æ–°æ–¹å‘ï¼Œé¿å…ç”Ÿæˆå™¨åç¦»æ•™å¸ˆæ¨¡åž‹çš„åˆ†å¸ƒå¤ªè¿œã€‚åŠ¨æ€åˆ†å¸ƒæŒ‡å¯¼æ¨¡å—é€šè¿‡è°ƒæ•´åˆ†å¸ƒåŒ¹é…æŸå¤±çš„æƒé‡æ¥å®žçŽ°ï¼ŒåŠ¨æ€é‡å™ªå£°é‡‡æ ·æ¨¡å—åˆ™é€šè¿‡è°ƒæ•´å™ªå£°çš„é‡‡æ ·èŒƒå›´æ¥å®žçŽ°ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

å®žéªŒç»“æžœè¡¨æ˜Žï¼ŒDMDRåœ¨è§†è§‰è´¨é‡å’Œæç¤ºä¸€è‡´æ€§æ–¹é¢å‡ä¼˜äºŽçŽ°æœ‰çš„å°‘æ­¥æ‰©æ•£æ¨¡åž‹ã€‚åœ¨å›¾åƒç”Ÿæˆä»»åŠ¡ä¸­ï¼ŒDMDRç”Ÿæˆçš„å›¾åƒçš„FIDå¾—åˆ†æ˜¾è‘—ä½ŽäºŽå…¶ä»–åŸºçº¿æ–¹æ³•ï¼Œè¡¨æ˜Žå…¶ç”Ÿæˆå›¾åƒçš„è´¨é‡æ›´é«˜ã€‚æ›´é‡è¦çš„æ˜¯ï¼ŒDMDRç”šè‡³èƒ½å¤Ÿè¶…è¶Šå¤šæ­¥æ•™å¸ˆæ¨¡åž‹çš„æ€§èƒ½ï¼Œè¯æ˜Žäº†å…¶èƒ½å¤Ÿæœ‰æ•ˆçªç ´æ•™å¸ˆæ¨¡åž‹çš„æ€§èƒ½é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œåœ¨ç‰¹å®šæ•°æ®é›†ä¸Šï¼ŒDMDRçš„FIDå¾—åˆ†æ¯”æ•™å¸ˆæ¨¡åž‹é™ä½Žäº†5%ä»¥ä¸Šã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

DMDRæ¡†æž¶å…·æœ‰å¹¿æ³›çš„åº”ç”¨å‰æ™¯ï¼Œä¾‹å¦‚å›¾åƒç”Ÿæˆã€å›¾åƒç¼–è¾‘ã€è§†é¢‘ç”Ÿæˆç­‰ã€‚å®ƒå¯ä»¥ç”¨äºŽç”Ÿæˆé«˜è´¨é‡ã€é«˜åˆ†è¾¨çŽ‡çš„å›¾åƒå’Œè§†é¢‘ï¼Œå¹¶å¯ä»¥åº”ç”¨äºŽæ¸¸æˆå¼€å‘ã€ç”µå½±åˆ¶ä½œã€å¹¿å‘Šè®¾è®¡ç­‰é¢†åŸŸã€‚æ­¤å¤–ï¼ŒDMDRè¿˜å¯ä»¥ç”¨äºŽæ•°æ®å¢žå¼ºï¼Œé€šè¿‡ç”Ÿæˆæ–°çš„è®­ç»ƒæ ·æœ¬æ¥æé«˜æ¨¡åž‹çš„æ³›åŒ–èƒ½åŠ›ã€‚ç”±äºŽå…¶å°‘æ­¥æŽ¨ç†çš„ç‰¹æ€§ï¼ŒDMDRåœ¨å¯¹å®žæ—¶æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ä¸‹å…·æœ‰ä¼˜åŠ¿ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Distribution Matching Distillation (DMD) distills a pre-trained multi-step diffusion model to a few-step one to improve inference efficiency. However, the performance of the latter is often capped by the former. To circumvent this dilemma, we propose DMDR, a novel framework that combines Reinforcement Learning (RL) techniques into the distillation process. We show that for the RL of the few-step generator, the DMD loss itself is a more effective regularization compared to the traditional ones. In turn, RL can help to guide the mode coverage process in DMD more effectively. These allow us to unlock the capacity of the few-step generator by conducting distillation and RL simultaneously. Meanwhile, we design the dynamic distribution guidance and dynamic renoise sampling training strategies to improve the initial distillation process. The experiments demonstrate that DMDR can achieve leading visual quality, prompt coherence among few-step methods, and even exhibit performance that exceeds the multi-step teacher.

