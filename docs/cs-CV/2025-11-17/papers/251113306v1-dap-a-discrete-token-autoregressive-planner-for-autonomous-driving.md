---
layout: default
title: DAP: A Discrete-token Autoregressive Planner for Autonomous Driving
---

# DAP: A Discrete-token Autoregressive Planner for Autonomous Driving

**arXiv**: [2511.13306v1](https://arxiv.org/abs/2511.13306) | [PDF](https://arxiv.org/pdf/2511.13306.pdf)

**ä½œè€…**: Bowen Ye, Bin Zhang, Hang Zhao

**åˆ†ç±»**: cs.AI, cs.CV

**å‘å¸ƒæ—¥æœŸ**: 2025-11-17

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**DAPï¼šä¸€ç§ç”¨äºŽè‡ªåŠ¨é©¾é©¶çš„ç¦»æ•£tokenè‡ªå›žå½’è§„åˆ’å™¨ï¼Œå®žçŽ°BEVè¯­ä¹‰å’Œè½¨è¿¹è”åˆé¢„æµ‹ã€‚**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸Žæž¶æž„ (RL & Architecture)** **æ”¯æŸ±ä¸‰ï¼šç©ºé—´æ„ŸçŸ¥ (Perception & SLAM)**

**å…³é”®è¯**: `è‡ªåŠ¨é©¾é©¶` `è¿åŠ¨è§„åˆ’` `è‡ªå›žå½’æ¨¡åž‹` `BEVè¯­ä¹‰` `å¼ºåŒ–å­¦ä¹ `

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. çŽ°æœ‰è‡ªå›žå½’æ¨¡åž‹åœ¨è‡ªåŠ¨é©¾é©¶è§„åˆ’ä¸­ä»…é¢„æµ‹è‡ªè½¦è½¨è¿¹ï¼Œå­˜åœ¨ç›‘ç£ä¿¡å·ç¨€ç–ï¼Œåœºæ™¯ç†è§£ä¸è¶³çš„é—®é¢˜ã€‚
2. DAPé€šè¿‡è”åˆé¢„æµ‹BEVè¯­ä¹‰å’Œè‡ªè½¦è½¨è¿¹ï¼Œåˆ©ç”¨åœºæ™¯åŠ¨æ€ä¿¡æ¯æ›´æœ‰æ•ˆåœ°æŒ‡å¯¼è‡ªè½¦è¿åŠ¨è§„åˆ’ã€‚
3. DAPé‡‡ç”¨ç¦»æ•£tokenè‡ªå›žå½’æ¡†æž¶ï¼Œå¹¶ç»“åˆå¼ºåŒ–å­¦ä¹ å¾®è°ƒï¼Œåœ¨ä¿è¯æ€§èƒ½çš„åŒæ—¶ï¼Œæ¨¡åž‹å‚æ•°é‡è¾ƒå°ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

åœ¨è‡ªåŠ¨é©¾é©¶é¢†åŸŸï¼Œå¦‚ä½•é€šè¿‡æ‰©å±•æ•°æ®å’Œæ¨¡åž‹è§„æ¨¡æ¥èŽ·å¾—å¯æŒç»­çš„æ€§èƒ½æå‡ä»ç„¶æ˜¯ä¸€ä¸ªå…³é”®ä½†å°šæœªè§£å†³çš„æŒ‘æˆ˜ã€‚è™½ç„¶è‡ªå›žå½’æ¨¡åž‹åœ¨è§„åˆ’ä»»åŠ¡ä¸­è¡¨çŽ°å‡ºä»¤äººé¼“èˆžçš„æ•°æ®æ‰©å±•æ•ˆçŽ‡ï¼Œä½†ä»…é¢„æµ‹è‡ªè½¦è½¨è¿¹å­˜åœ¨ç›‘ç£ç¨€ç–çš„é—®é¢˜ï¼Œå¹¶ä¸”å¯¹åœºæ™¯æ¼”å˜å¦‚ä½•å½±å“è‡ªè½¦è¿åŠ¨çš„çº¦æŸè¾ƒå¼±ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æå‡ºäº†DAPï¼Œä¸€ç§ç¦»æ•£tokenè‡ªå›žå½’è§„åˆ’å™¨ï¼Œå®ƒè”åˆé¢„æµ‹BEVè¯­ä¹‰å’Œè‡ªè½¦è½¨è¿¹ï¼Œä»Žè€ŒåŠ å¼ºäº†å…¨é¢çš„è¡¨å¾å­¦ä¹ ï¼Œå¹¶å…è®¸é¢„æµ‹çš„åŠ¨æ€ç›´æŽ¥å½±å“è‡ªè½¦è¿åŠ¨ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ç»“åˆäº†åŸºäºŽå¼ºåŒ–å­¦ä¹ çš„å¾®è°ƒï¼Œä¿ç•™äº†ç›‘ç£è¡Œä¸ºå…‹éš†çš„å…ˆéªŒçŸ¥è¯†ï¼ŒåŒæ—¶æ³¨å…¥äº†å¥–åŠ±å¼•å¯¼çš„æ”¹è¿›ã€‚å°½ç®¡å‚æ•°é‡ä»…ä¸º1.6äº¿ï¼ŒDAPåœ¨open-loopæŒ‡æ ‡ä¸Šå®žçŽ°äº†æœ€å…ˆè¿›çš„æ€§èƒ½ï¼Œå¹¶åœ¨NAVSIMåŸºå‡†æµ‹è¯•ä¸­æä¾›äº†å…·æœ‰ç«žäº‰åŠ›çš„closed-loopç»“æžœã€‚æ€»è€Œè¨€ä¹‹ï¼Œå®Œå…¨ç¦»æ•£tokençš„è‡ªå›žå½’å…¬å¼åœ¨æ …æ ¼åŒ–çš„BEVå’Œè‡ªè½¦åŠ¨ä½œä¸Šè¿è¡Œï¼Œä¸ºè‡ªåŠ¨é©¾é©¶æä¾›äº†ä¸€ç§ç´§å‡‘ä½†å¯æ‰©å±•çš„è§„åˆ’èŒƒä¾‹ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè‡ªåŠ¨é©¾é©¶è§„åˆ’éœ€è¦æ ¹æ®å‘¨å›´çŽ¯å¢ƒé¢„æµ‹è½¦è¾†çš„æœªæ¥è½¨è¿¹ã€‚çŽ°æœ‰æ–¹æ³•ï¼Œç‰¹åˆ«æ˜¯ä»…é¢„æµ‹è‡ªè½¦è½¨è¿¹çš„è‡ªå›žå½’æ¨¡åž‹ï¼Œé¢ä¸´ç›‘ç£ä¿¡å·ç¨€ç–çš„é—®é¢˜ï¼Œéš¾ä»¥å……åˆ†åˆ©ç”¨åœºæ™¯ä¿¡æ¯æ¥æŒ‡å¯¼è§„åˆ’ã€‚æ­¤å¤–ï¼Œå¦‚ä½•æœ‰æ•ˆåœ°åˆ©ç”¨å¤§è§„æ¨¡æ•°æ®å’Œæ¨¡åž‹æ¥æå‡è§„åˆ’æ€§èƒ½ä»ç„¶æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šDAPçš„æ ¸å¿ƒæ€è·¯æ˜¯è”åˆé¢„æµ‹BEVè¯­ä¹‰å’Œè‡ªè½¦è½¨è¿¹ï¼Œä»Žè€Œå°†åœºæ™¯ç†è§£å’Œè¿åŠ¨è§„åˆ’ç´§å¯†ç»“åˆã€‚é€šè¿‡é¢„æµ‹BEVè¯­ä¹‰ï¼Œæ¨¡åž‹å¯ä»¥å­¦ä¹ åˆ°æ›´ä¸°å¯Œçš„åœºæ™¯è¡¨å¾ï¼Œå¹¶åˆ©ç”¨è¿™äº›è¡¨å¾æ¥æ›´å¥½åœ°é¢„æµ‹è‡ªè½¦è½¨è¿¹ã€‚æ­¤å¤–ï¼ŒDAPé‡‡ç”¨ç¦»æ•£tokenè‡ªå›žå½’æ¡†æž¶ï¼Œå¯ä»¥æ›´æœ‰æ•ˆåœ°åˆ©ç”¨å¤§è§„æ¨¡æ•°æ®è¿›è¡Œè®­ç»ƒã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šDAPçš„æ•´ä½“æ¡†æž¶æ˜¯ä¸€ä¸ªç¦»æ•£tokenè‡ªå›žå½’æ¨¡åž‹ã€‚è¯¥æ¨¡åž‹æŽ¥æ”¶BEVå›¾åƒä½œä¸ºè¾“å…¥ï¼Œå¹¶é¢„æµ‹ç¦»æ•£çš„BEVè¯­ä¹‰tokenå’Œè‡ªè½¦åŠ¨ä½œtokenã€‚æ¨¡åž‹åŒ…æ‹¬ä¸€ä¸ªç¼–ç å™¨ï¼Œç”¨äºŽæå–BEVå›¾åƒçš„ç‰¹å¾ï¼›ä¸€ä¸ªè‡ªå›žå½’è§£ç å™¨ï¼Œç”¨äºŽé¢„æµ‹tokenåºåˆ—ï¼›ä»¥åŠä¸€ä¸ªå¼ºåŒ–å­¦ä¹ å¾®è°ƒæ¨¡å—ï¼Œç”¨äºŽè¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚

**å…³é”®åˆ›æ–°**ï¼šDAPçš„å…³é”®åˆ›æ–°åœ¨äºŽè”åˆé¢„æµ‹BEVè¯­ä¹‰å’Œè‡ªè½¦è½¨è¿¹ï¼Œä»¥åŠé‡‡ç”¨ç¦»æ•£tokenè‡ªå›žå½’æ¡†æž¶ã€‚è”åˆé¢„æµ‹å¯ä»¥å¢žå¼ºåœºæ™¯ç†è§£å’Œè¿åŠ¨è§„åˆ’ä¹‹é—´çš„è”ç³»ï¼Œè€Œç¦»æ•£tokenè‡ªå›žå½’æ¡†æž¶å¯ä»¥æ›´æœ‰æ•ˆåœ°åˆ©ç”¨å¤§è§„æ¨¡æ•°æ®ã€‚æ­¤å¤–ï¼ŒDAPè¿˜ç»“åˆäº†å¼ºåŒ–å­¦ä¹ å¾®è°ƒï¼Œè¿›ä¸€æ­¥æå‡äº†æ€§èƒ½ã€‚

**å…³é”®è®¾è®¡**ï¼šDAPä½¿ç”¨Transformerä½œä¸ºè‡ªå›žå½’è§£ç å™¨çš„åŸºæœ¬æ¨¡å—ã€‚BEVå›¾åƒè¢«ç¼–ç æˆä¸€ç³»åˆ—tokenï¼Œç„¶åŽè¾“å…¥åˆ°Transformerè§£ç å™¨ä¸­ã€‚è§£ç å™¨é¢„æµ‹ç¦»æ•£çš„BEVè¯­ä¹‰tokenå’Œè‡ªè½¦åŠ¨ä½œtokenã€‚æŸå¤±å‡½æ•°åŒ…æ‹¬äº¤å‰ç†µæŸå¤±ï¼Œç”¨äºŽè®­ç»ƒBEVè¯­ä¹‰é¢„æµ‹å’Œè‡ªè½¦åŠ¨ä½œé¢„æµ‹ï¼Œä»¥åŠå¼ºåŒ–å­¦ä¹ å¥–åŠ±ï¼Œç”¨äºŽå¾®è°ƒæ¨¡åž‹ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

DAPåœ¨NAVSIMåŸºå‡†æµ‹è¯•ä¸­å–å¾—äº†å…·æœ‰ç«žäº‰åŠ›çš„closed-loopç»“æžœï¼Œå¹¶åœ¨open-loopæŒ‡æ ‡ä¸Šå®žçŽ°äº†æœ€å…ˆè¿›çš„æ€§èƒ½ï¼Œè¶…è¿‡äº†çŽ°æœ‰æ–¹æ³•ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒDAPä»…ä½¿ç”¨äº†1.6äº¿å‚æ•°ï¼Œè¡¨æ˜Žå…¶å…·æœ‰è¾ƒé«˜çš„å‚æ•°æ•ˆçŽ‡ã€‚å®žéªŒç»“æžœè¡¨æ˜Žï¼Œè”åˆé¢„æµ‹BEVè¯­ä¹‰å’Œè‡ªè½¦è½¨è¿¹å¯ä»¥æœ‰æ•ˆåœ°æå‡è‡ªåŠ¨é©¾é©¶è§„åˆ’æ€§èƒ½ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

DAPå¯åº”ç”¨äºŽå„ç§è‡ªåŠ¨é©¾é©¶åœºæ™¯ï¼Œä¾‹å¦‚åŸŽå¸‚é“è·¯ã€é«˜é€Ÿå…¬è·¯å’Œåœè½¦åœºã€‚å®ƒå¯ä»¥ç”¨äºŽè½¦è¾†çš„è·¯å¾„è§„åˆ’ã€è¡Œä¸ºå†³ç­–å’Œè¿åŠ¨æŽ§åˆ¶ã€‚è¯¥ç ”ç©¶çš„æˆæžœæœ‰åŠ©äºŽæé«˜è‡ªåŠ¨é©¾é©¶ç³»ç»Ÿçš„å®‰å…¨æ€§ã€å¯é æ€§å’Œæ•ˆçŽ‡ï¼Œå¹¶ä¸ºæœªæ¥çš„è‡ªåŠ¨é©¾é©¶æŠ€æœ¯å‘å±•å¥ å®šåŸºç¡€ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Gaining sustainable performance improvement with scaling data and model budget remains a pivotal yet unresolved challenge in autonomous driving. While autoregressive models exhibited promising data-scaling efficiency in planning tasks, predicting ego trajectories alone suffers sparse supervision and weakly constrains how scene evolution should shape ego motion. Therefore, we introduce DAP, a discrete-token autoregressive planner that jointly forecasts BEV semantics and ego trajectories, thereby enforcing comprehensive representation learning and allowing predicted dynamics to directly condition ego motion. In addition, we incorporate a reinforcement-learning-based fine-tuning, which preserves supervised behavior cloning priors while injecting reward-guided improvements. Despite a compact 160M parameter budget, DAP achieves state-of-the-art performance on open-loop metrics and delivers competitive closed-loop results on the NAVSIM benchmark. Overall, the fully discrete-token autoregressive formulation operating on both rasterized BEV and ego actions provides a compact yet scalable planning paradigm for autonomous driving.

