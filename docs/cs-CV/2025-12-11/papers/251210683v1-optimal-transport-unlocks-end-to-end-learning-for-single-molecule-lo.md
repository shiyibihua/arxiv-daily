---
layout: default
title: Optimal transport unlocks end-to-end learning for single-molecule localization
---

# Optimal transport unlocks end-to-end learning for single-molecule localization

<div class="paper-toolbar">
  <div class="toolbar-left">
    <a href="https://arxiv.org/abs/2512.10683" target="_blank" class="toolbar-btn">arXiv: 2512.10683v1</a>
    <a href="https://arxiv.org/pdf/2512.10683.pdf" target="_blank" class="toolbar-btn">PDF</a>
  </div>
  <div class="toolbar-right">
    <button class="toolbar-btn favorite-btn" data-arxiv-id="2512.10683v1" 
            onclick="toggleFavorite(this, '2512.10683v1', 'Optimal transport unlocks end-to-end learning for single-molecule localization')" title="Êî∂Ëóè">
      ‚òÜ Êî∂Ëóè
    </button>
    <button class="toolbar-btn share-btn" onclick="copyLink()" title="Â§çÂà∂ÈìæÊé•">
      üîó ÂàÜ‰∫´
    </button>
  </div>
</div>


**‰ΩúËÄÖ**: Romain Seailles, Jean-Baptiste Masson, Jean Ponce, Julien Mairal

**ÂàÜÁ±ª**: cs.CV, cs.LG

**ÂèëÂ∏ÉÊó•Êúü**: 2025-12-11

**üîó ‰ª£Á†Å/È°πÁõÆ**: [GITHUB](https://github.com/RSLLES/SHOT)

---

## üí° ‰∏ÄÂè•ËØùË¶ÅÁÇπ

**Âà©Áî®ÊúÄ‰ºò‰º†ËæìÂÆûÁé∞ÂçïÂàÜÂ≠êÂÆö‰ΩçÊòæÂæÆÈïúÁöÑÁ´ØÂà∞Á´ØÂ≠¶‰π†**

üéØ **ÂåπÈÖçÈ¢ÜÂüü**: **ÊîØÊü±‰∏âÔºöÁ©∫Èó¥ÊÑüÁü• (Perception & SLAM)**

**ÂÖ≥ÈîÆËØç**: `ÂçïÂàÜÂ≠êÂÆö‰ΩçÊòæÂæÆÈïú` `ÊúÄ‰ºò‰º†Ëæì` `Á´ØÂà∞Á´ØÂ≠¶‰π†` `Ê∑±Â∫¶Â≠¶‰π†` `Ë∂ÖÂàÜËæ®ÁéáÊàêÂÉè`

## üìã Ê†∏ÂøÉË¶ÅÁÇπ

1. ‰º†ÁªüSMLMÊñπÊ≥ï‰æùËµñÈùûÊûÅÂ§ßÂÄºÊäëÂà∂ÔºåÂØºËá¥‰∏çÂèØÂæÆÂíåÂèØËÉΩ‰∏¢ÂºÉÁúüÈò≥ÊÄßÊ†∑Êú¨ÁöÑÈóÆÈ¢ò„ÄÇ
2. ËÆ∫ÊñáÊèêÂá∫Âü∫‰∫éÊúÄ‰ºò‰º†ËæìÁöÑÊçüÂ§±ÂáΩÊï∞ÔºåÂ∞ÜSMLMËÆ≠ÁªÉËΩ¨Âåñ‰∏∫ÈõÜÂêàÂåπÈÖçÈóÆÈ¢òÔºåÂÆûÁé∞Á´ØÂà∞Á´ØËÆ≠ÁªÉ„ÄÇ
3. ÊèêÂá∫ÁöÑËø≠‰ª£Á•ûÁªèÁΩëÁªúÈõÜÊàê‰∫ÜÊòæÂæÆÈïúÂÖâÂ≠¶Á≥ªÁªüÁü•ËØÜÔºåÂú®ÂØÜÈõÜÂèëÂ∞ÑÊÉÖÂÜµ‰∏ãÊÄßËÉΩ‰ºò‰∫éÁé∞ÊúâÊäÄÊúØ„ÄÇ

## üìù ÊëòË¶ÅÔºà‰∏≠ÊñáÔºâ

ÂçïÂàÜÂ≠êÂÆö‰ΩçÊòæÂæÆÈïú(SMLM)ÈÄöËøáÊ£ÄÊµãÂíåÂÆö‰ΩçÂçï‰∏™ËçßÂÖâÂõ¢ÔºåËÉΩÂ§üÈáçÂª∫Ë∂ÖË∂äË°çÂ∞ÑÊûÅÈôêÁöÑÁîüÁâ©Áõ∏ÂÖ≥ÁªìÊûÑÔºå‰ªéËÄåÈáçÂª∫Ë∂ÖÂàÜËæ®ÁéáÂõæÂÉè„ÄÇÁõÆÂâçÔºåÈ´òÊïàÁöÑSMLMÈúÄË¶Å‰∏çÈáçÂè†ÁöÑÂèëÂ∞ÑËçßÂÖâÂõ¢ÔºåÂØºËá¥ÈááÈõÜÊó∂Èó¥ËøáÈïøÔºåÈòªÁ¢ç‰∫ÜÊ¥ªÁªÜËÉûÊàêÂÉè„ÄÇÊúÄËøëÁöÑÊ∑±Â∫¶Â≠¶‰π†ÊñπÊ≥ïÂèØ‰ª•Â§ÑÁêÜÊõ¥ÂØÜÈõÜÁöÑÂèëÂ∞ÑÔºå‰ΩÜÂÆÉ‰ª¨‰æùËµñ‰∫éÈùûÊûÅÂ§ßÂÄºÊäëÂà∂(NMS)Â±ÇÁöÑÂèò‰ΩìÔºåËøô‰∫õÂ±Ç‰∏çÂèØÂæÆÔºåÂπ∂‰∏îÂèØËÉΩÂõ†ÂÖ∂Â±ÄÈÉ®ËûçÂêàÁ≠ñÁï•ËÄå‰∏¢ÂºÉÁúüÊ≠£ÁöÑÈò≥ÊÄßÊ†∑Êú¨„ÄÇÊú¨ÊñáÂ∞ÜSMLMËÆ≠ÁªÉÁõÆÊ†áÈáçÊñ∞ÂÆö‰πâ‰∏∫‰∏Ä‰∏™ÈõÜÂêàÂåπÈÖçÈóÆÈ¢òÔºåÊé®ÂØºÂá∫‰∏Ä‰∏™ÊúÄ‰ºò‰º†ËæìÊçüÂ§±Ôºå‰ªéËÄåÊ∂àÈô§‰∫ÜÊé®ÁêÜËøáÁ®ã‰∏≠ÂØπNMSÁöÑÈúÄÊ±ÇÔºåÂπ∂ÂÆûÁé∞‰∫ÜÁ´ØÂà∞Á´ØËÆ≠ÁªÉ„ÄÇÊ≠§Â§ñÔºåÊàë‰ª¨ÊèêÂá∫‰∫Ü‰∏Ä‰∏™Ëø≠‰ª£Á•ûÁªèÁΩëÁªúÔºåÂ∞ÜÊòæÂæÆÈïúÂÖâÂ≠¶Á≥ªÁªüÁöÑÁü•ËØÜÊï¥ÂêàÂà∞Êàë‰ª¨ÁöÑÊ®°Âûã‰∏≠„ÄÇÂú®ÂêàÊàêÂü∫ÂáÜÂíåÁúüÂÆûÁîüÁâ©Êï∞ÊçÆ‰∏äÁöÑÂÆûÈ™åË°®ÊòéÔºåÊàë‰ª¨ÁöÑÊñ∞ÊçüÂ§±ÂáΩÊï∞ÂíåÊû∂ÊûÑÂú®ÈÄÇÂ∫¶ÂíåÈ´òÂèëÂ∞ÑÂô®ÂØÜÂ∫¶‰∏ãÈÉΩË∂ÖËøá‰∫ÜÁé∞ÊúâÊäÄÊúØÊ∞¥Âπ≥„ÄÇ‰ª£Á†ÅÂèØÂú®https://github.com/RSLLES/SHOT Ëé∑Âèñ„ÄÇ

## üî¨ ÊñπÊ≥ïËØ¶Ëß£

**ÈóÆÈ¢òÂÆö‰πâ**ÔºöÂçïÂàÜÂ≠êÂÆö‰ΩçÊòæÂæÆÈïúÔºàSMLMÔºâÊó®Âú®Á°ÆÂÆöÂçï‰∏™ËçßÂÖâÂàÜÂ≠êÂú®ÂõæÂÉè‰∏≠ÁöÑÁ≤æÁ°Æ‰ΩçÁΩÆ„ÄÇ‰º†ÁªüÊñπÊ≥ï‰æùËµñ‰∫éÁ®ÄÁñèÊøÄÊ¥ªÔºåÂç≥Âêå‰∏ÄÊó∂Èó¥Âè™ÊúâÂ∞ëÈáèÂàÜÂ≠êÂèëÂÖâÔºåÂπ∂ÈÄöËøáÈùûÊûÅÂ§ßÂÄºÊäëÂà∂ÔºàNMSÔºâÁ≠âÂêéÂ§ÑÁêÜÊ≠•È™§Êù•ÂàÜÁ¶ªÂíåÂÆö‰ΩçËøô‰∫õÂàÜÂ≠ê„ÄÇÁÑ∂ËÄåÔºåÈ´òÂØÜÂ∫¶ÊàêÂÉèÊó∂ÔºåÂàÜÂ≠êÈáçÂè†‰∏•ÈáçÔºåNMSÂÆπÊòìÈîôËØØÂú∞ÊäëÂà∂ÁúüÂÆûÂàÜÂ≠êÔºåÂπ∂‰∏îNMSÁöÑ‰∏çÂèØÂæÆÊÄßÈòªÁ¢ç‰∫ÜÁ´ØÂà∞Á´ØËÆ≠ÁªÉ„ÄÇ

**Ê†∏ÂøÉÊÄùË∑Ø**ÔºöËÆ∫ÊñáÁöÑÊ†∏ÂøÉÊÄùÊÉ≥ÊòØÂ∞ÜSMLMÈóÆÈ¢òËΩ¨Âåñ‰∏∫‰∏Ä‰∏™ÈõÜÂêàÂåπÈÖçÈóÆÈ¢òÔºåÂç≥È¢ÑÊµãÁöÑÂàÜÂ≠ê‰ΩçÁΩÆÈõÜÂêà‰∏éÁúüÂÆûÁöÑÂàÜÂ≠ê‰ΩçÁΩÆÈõÜÂêà‰πãÈó¥ÁöÑÂåπÈÖç„ÄÇÈÄöËøá‰ΩøÁî®ÊúÄ‰ºò‰º†ËæìÁêÜËÆ∫ÔºåÂèØ‰ª•ÂÆö‰πâ‰∏Ä‰∏™ÂèØÂæÆÁöÑÊçüÂ§±ÂáΩÊï∞ÔºåËØ•ÂáΩÊï∞ËÉΩÂ§üË°°Èáè‰∏§‰∏™ÈõÜÂêà‰πãÈó¥ÁöÑÂ∑ÆÂºÇÔºå‰ªéËÄåÈÅøÂÖç‰∫ÜNMSÁöÑ‰ΩøÁî®ÔºåÂπ∂ÂÖÅËÆ∏Á´ØÂà∞Á´ØËÆ≠ÁªÉ„ÄÇ

**ÊäÄÊúØÊ°ÜÊû∂**ÔºöËØ•ÊñπÊ≥ïÂåÖÂê´‰∏§‰∏™‰∏ªË¶ÅÈÉ®ÂàÜÔºö‰∏Ä‰∏™Ëø≠‰ª£Á•ûÁªèÁΩëÁªúÂíå‰∏Ä‰∏™Âü∫‰∫éÊúÄ‰ºò‰º†ËæìÁöÑÊçüÂ§±ÂáΩÊï∞„ÄÇËø≠‰ª£Á•ûÁªèÁΩëÁªúË¥üË¥£È¢ÑÊµãÂõæÂÉè‰∏≠ÂàÜÂ≠êÁöÑ‰ΩçÁΩÆÂíåÂº∫Â∫¶„ÄÇËØ•ÁΩëÁªúÁöÑËÆæËÆ°ËÄÉËôë‰∫ÜÊòæÂæÆÈïúÁöÑÂÖâÂ≠¶Á≥ªÁªüÔºå‰æãÂ¶ÇÁÇπÊâ©Êï£ÂáΩÊï∞ÔºàPSFÔºâ„ÄÇÊúÄ‰ºò‰º†ËæìÊçüÂ§±ÂáΩÊï∞ÂàôÁî®‰∫éË°°ÈáèÈ¢ÑÊµã‰ΩçÁΩÆ‰∏éÁúüÂÆû‰ΩçÁΩÆ‰πãÈó¥ÁöÑÂ∑ÆÂºÇÔºåÂπ∂ÊåáÂØºÁΩëÁªúÁöÑËÆ≠ÁªÉ„ÄÇÊï¥‰∏™Ê°ÜÊû∂ÈÄöËøáÁ´ØÂà∞Á´ØÁöÑÊñπÂºèËøõË°åËÆ≠ÁªÉÔºå‰ªéËÄå‰ºòÂåñÁΩëÁªúÁöÑÊÄßËÉΩ„ÄÇ

**ÂÖ≥ÈîÆÂàõÊñ∞**ÔºöËØ•ËÆ∫ÊñáÁöÑÂÖ≥ÈîÆÂàõÊñ∞Âú®‰∫é‰ΩøÁî®ÊúÄ‰ºò‰º†ËæìÁêÜËÆ∫Êù•Ëß£ÂÜ≥SMLMÈóÆÈ¢òÔºå‰ªéËÄåÈÅøÂÖç‰∫ÜNMSÁöÑ‰ΩøÁî®ÔºåÂπ∂ÂÆûÁé∞‰∫ÜÁ´ØÂà∞Á´ØËÆ≠ÁªÉ„ÄÇÊ≠§Â§ñÔºåËø≠‰ª£Á•ûÁªèÁΩëÁªúÁöÑËÆæËÆ°‰πüËÄÉËôë‰∫ÜÊòæÂæÆÈïúÁöÑÂÖâÂ≠¶Á≥ªÁªüÔºå‰ªéËÄåÊèêÈ´ò‰∫ÜÂÆö‰ΩçÁ≤æÂ∫¶„ÄÇËøôÁßçÊñπÊ≥ïÂú®È´òÂØÜÂ∫¶ÊàêÂÉèÊù°‰ª∂‰∏ãÂ∞§ÂÖ∂ÊúâÊïàÔºåÂõ†‰∏∫ÂÆÉËÉΩÂ§üÊõ¥Â•ΩÂú∞ÂàÜÁ¶ªÂíåÂÆö‰ΩçÈáçÂè†ÁöÑÂàÜÂ≠ê„ÄÇ

**ÂÖ≥ÈîÆËÆæËÆ°**ÔºöËø≠‰ª£Á•ûÁªèÁΩëÁªúÈááÁî®U-NetÁªìÊûÑÔºåÂπ∂ÈõÜÊàê‰∫ÜÊòæÂæÆÈïúÁöÑÁÇπÊâ©Êï£ÂáΩÊï∞ÔºàPSFÔºâ‰ø°ÊÅØ„ÄÇÊçüÂ§±ÂáΩÊï∞ÈááÁî®SinkhornË∑ùÁ¶ªÔºåËøôÊòØ‰∏ÄÁßçÂü∫‰∫éÊúÄ‰ºò‰º†ËæìÁöÑË∑ùÁ¶ªÂ∫¶ÈáèÔºåÁî®‰∫éË°°ÈáèÈ¢ÑÊµã‰ΩçÁΩÆÈõÜÂêà‰∏éÁúüÂÆû‰ΩçÁΩÆÈõÜÂêà‰πãÈó¥ÁöÑÂ∑ÆÂºÇ„ÄÇSinkhornË∑ùÁ¶ªÁöÑËÆ°ÁÆóÂèØ‰ª•ÈÄöËøáSinkhornÁÆóÊ≥ïËøõË°åËøë‰ººÔºå‰ªéËÄåÂÆûÁé∞È´òÊïàÁöÑËÆ°ÁÆó„ÄÇÊ≠§Â§ñÔºåËÆ∫ÊñáËøò‰ΩøÁî®‰∫ÜAdam‰ºòÂåñÂô®ËøõË°åËÆ≠ÁªÉÔºåÂπ∂ËÆæÁΩÆ‰∫ÜÂêàÈÄÇÁöÑÂ≠¶‰π†ÁéáÂíåbatch size„ÄÇ

## üìä ÂÆûÈ™å‰∫ÆÁÇπ

ÂÆûÈ™åÁªìÊûúË°®ÊòéÔºåËØ•ÊñπÊ≥ïÂú®ÂêàÊàêÊï∞ÊçÆÈõÜÂíåÁúüÂÆûÁîüÁâ©Êï∞ÊçÆÈõÜ‰∏äÂùá‰ºò‰∫éÁé∞ÊúâÊäÄÊúØ„ÄÇÂú®È´òÂØÜÂ∫¶ÂèëÂ∞ÑÊù°‰ª∂‰∏ãÔºåËØ•ÊñπÊ≥ïËÉΩÂ§üÊòæËëóÊèêÈ´òÂÆö‰ΩçÁ≤æÂ∫¶ÂíåÂàÜËæ®ÁéáÔºåÂπ∂ÂáèÂ∞ëÂÅáÈò≥ÊÄßÁéá„ÄÇ‰æãÂ¶ÇÔºåÂú®Êüê‰∫õÊï∞ÊçÆÈõÜ‰∏äÔºåËØ•ÊñπÊ≥ïÁöÑÂÆö‰ΩçÁ≤æÂ∫¶ÊèêÈ´ò‰∫Ü20%‰ª•‰∏äÔºåÂπ∂‰∏îËÉΩÂ§üÊàêÂäüÂú∞ÂàÜÁ¶ªÂíåÂÆö‰ΩçÈáçÂè†ÁöÑÂàÜÂ≠ê„ÄÇ

## üéØ Â∫îÁî®Âú∫ÊôØ

ËØ•Á†îÁ©∂ÊàêÊûúÂèØÂ∫îÁî®‰∫éÈ´òÂØÜÂ∫¶ÂçïÂàÜÂ≠êÂÆö‰ΩçÊòæÂæÆÊàêÂÉèÔºå‰æãÂ¶ÇÊ¥ªÁªÜËÉûË∂ÖÂàÜËæ®ÁéáÊàêÂÉè„ÄÅËõãÁôΩË¥®Áõ∏‰∫í‰ΩúÁî®Á†îÁ©∂„ÄÅÁ∫≥Á±≥ÊùêÊñôË°®ÂæÅÁ≠âÈ¢ÜÂüü„ÄÇÈÄöËøáÊèêÈ´òÊàêÂÉèÈÄüÂ∫¶ÂíåÂàÜËæ®ÁéáÔºåËØ•ÊñπÊ≥ïÊúâÊúõÊé®Âä®ÁîüÁâ©ÂåªÂ≠¶Á†îÁ©∂ÁöÑËøõÂ±ïÔºå‰æãÂ¶ÇËçØÁâ©Á≠õÈÄâ„ÄÅÁñæÁóÖËØäÊñ≠ÂíåÊ≤ªÁñóÁ≠â„ÄÇ

## üìÑ ÊëòË¶ÅÔºàÂéüÊñáÔºâ

> Single-molecule localization microscopy (SMLM) allows reconstructing biology-relevant structures beyond the diffraction limit by detecting and localizing individual fluorophores -- fluorescent molecules stained onto the observed specimen -- over time to reconstruct super-resolved images. Currently, efficient SMLM requires non-overlapping emitting fluorophores, leading to long acquisition times that hinders live-cell imaging. Recent deep-learning approaches can handle denser emissions, but they rely on variants of non-maximum suppression (NMS) layers, which are unfortunately non-differentiable and may discard true positives with their local fusion strategy. In this presentation, we reformulate the SMLM training objective as a set-matching problem, deriving an optimal-transport loss that eliminates the need for NMS during inference and enables end-to-end training. Additionally, we propose an iterative neural network that integrates knowledge of the microscope's optical system inside our model. Experiments on synthetic benchmarks and real biological data show that both our new loss function and architecture surpass the state of the art at moderate and high emitter densities. Code is available at https://github.com/RSLLES/SHOT.

