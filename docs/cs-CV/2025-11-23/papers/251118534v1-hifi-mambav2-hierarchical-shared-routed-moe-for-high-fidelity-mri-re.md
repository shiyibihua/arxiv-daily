---
layout: default
title: HiFi-MambaV2: Hierarchical Shared-Routed MoE for High-Fidelity MRI Reconstruction
---

# HiFi-MambaV2: Hierarchical Shared-Routed MoE for High-Fidelity MRI Reconstruction

**arXiv**: [2511.18534v1](https://arxiv.org/abs/2511.18534) | [PDF](https://arxiv.org/pdf/2511.18534.pdf)

**ä½œè€…**: Pengcheng Fang, Hongli Chen, Guangzhen Yao, Jian Shi, Fangfang Tang, Xiaohao Cai, Shanshan Shan, Feng Liu

**åˆ†ç±»**: cs.CV

**å‘å¸ƒæ—¥æœŸ**: 2025-11-23

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**HiFi-MambaV2ï¼šç”¨äºŽé«˜ä¿çœŸMRIé‡å»ºçš„åˆ†å±‚å…±äº«è·¯ç”±MoE Mambaæž¶æž„**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸Žæž¶æž„ (RL & Architecture)**

**å…³é”®è¯**: `MRIé‡å»º` `æ··åˆä¸“å®¶æ¨¡åž‹` `Mambaæž¶æž„` `é¢‘çŽ‡åˆ†è§£` `åŒ»å­¦å½±åƒ` `æ·±åº¦å­¦ä¹ ` `æ•°æ®ä¸€è‡´æ€§`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. çŽ°æœ‰MRIé‡å»ºæ–¹æ³•éš¾ä»¥åœ¨æ¢å¤é«˜é¢‘ç»†èŠ‚çš„åŒæ—¶ä¿æŒè§£å‰–ç»“æž„çš„è¿žè´¯æ€§ï¼Œå¯¼è‡´å›¾åƒè´¨é‡å—é™ã€‚
2. HiFi-MambaV2é€šè¿‡ç»“åˆé¢‘çŽ‡åˆ†è§£å’Œå†…å®¹è‡ªé€‚åº”è®¡ç®—ï¼Œåˆ©ç”¨åˆ†å±‚å…±äº«è·¯ç”±MoE Mambaæž¶æž„å®žçŽ°é«˜ä¿çœŸé‡å»ºã€‚
3. å®žéªŒç»“æžœè¡¨æ˜Žï¼ŒHiFi-MambaV2åœ¨å¤šä¸ªæ•°æ®é›†ä¸Šæ˜¾è‘—ä¼˜äºŽCNNã€Transformerå’ŒçŽ°æœ‰Mambaæ–¹æ³•ï¼Œæå‡äº†å›¾åƒè´¨é‡ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æå‡ºHiFi-MambaV2ï¼Œä¸€ç§åˆ†å±‚å…±äº«è·¯ç”±çš„æ··åˆä¸“å®¶(MoE) Mambaæž¶æž„ï¼Œç”¨äºŽä»Žæ¬ é‡‡æ ·çš„kç©ºé—´æ•°æ®ä¸­é‡å»ºé«˜ä¿çœŸMRå›¾åƒã€‚è¯¥æ¨¡åž‹å°†é¢‘çŽ‡åˆ†è§£ä¸Žå†…å®¹è‡ªé€‚åº”è®¡ç®—ç›¸ç»“åˆã€‚å®ƒåŒ…å«ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š(i) å¯åˆ†ç¦»çš„é¢‘çŽ‡ä¸€è‡´æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”(SF-Lap)ï¼Œæä¾›æŠ—æ··å ã€ç¨³å®šçš„ä½Žé¢‘å’Œé«˜é¢‘æµï¼›(ii) åˆ†å±‚å…±äº«è·¯ç”±MoEï¼Œæ‰§è¡Œé€åƒç´ çš„top-1ç¨€ç–è°ƒåº¦åˆ°å…±äº«ä¸“å®¶å’Œæœ¬åœ°è·¯ç”±å™¨ï¼Œå®žçŽ°æœ‰æ•ˆçš„ä¸“ä¸šåŒ–å’Œç¨³å®šçš„è·¨æ·±åº¦è¡Œä¸ºã€‚ä¸€ä¸ªè½»é‡çº§çš„å…¨å±€ä¸Šä¸‹æ–‡è·¯å¾„è¢«èžåˆåˆ°ä¸€ä¸ªå±•å¼€çš„ã€æ•°æ®ä¸€è‡´æ€§æ­£åˆ™åŒ–çš„éª¨å¹²ç½‘ç»œä¸­ï¼Œä»¥åŠ å¼ºé•¿ç¨‹æŽ¨ç†å¹¶ä¿æŒè§£å‰–å­¦è¿žè´¯æ€§ã€‚åœ¨fastMRIã€CC359ã€ACDCã€M4Rawå’ŒProstate158ä¸Šçš„è¯„ä¼°è¡¨æ˜Žï¼ŒHiFi-MambaV2åœ¨å•çº¿åœˆå’Œå¤šçº¿åœˆè®¾ç½®ä»¥åŠå¤šä¸ªåŠ é€Ÿå› å­ä¸‹ï¼Œåœ¨PSNRã€SSIMå’ŒNMSEæ–¹é¢å§‹ç»ˆä¼˜äºŽåŸºäºŽCNNã€Transformerå’Œå…ˆå‰çš„åŸºäºŽMambaçš„åŸºçº¿ï¼Œå¹¶åœ¨é«˜é¢‘ç»†èŠ‚å’Œæ•´ä½“ç»“æž„ä¿çœŸåº¦æ–¹é¢æŒç»­æ”¹è¿›ã€‚è¿™äº›ç»“æžœè¡¨æ˜ŽHiFi-MambaV2èƒ½å¤Ÿå®žçŽ°å¯é ä¸”é²æ£’çš„MRIé‡å»ºã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³ä»Žæ¬ é‡‡æ ·kç©ºé—´æ•°æ®é‡å»ºé«˜ä¿çœŸMRIå›¾åƒçš„é—®é¢˜ã€‚çŽ°æœ‰æ–¹æ³•ï¼ŒåŒ…æ‹¬åŸºäºŽCNNå’ŒTransformerçš„æ–¹æ³•ï¼Œéš¾ä»¥åŒæ—¶æ¢å¤é«˜é¢‘ç»†èŠ‚å¹¶ä¿æŒè§£å‰–ç»“æž„çš„è¿žè´¯æ€§ï¼Œå¯¼è‡´é‡å»ºå›¾åƒæ¨¡ç³Šæˆ–å¤±çœŸã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯å°†é¢‘çŽ‡åˆ†è§£ä¸Žå†…å®¹è‡ªé€‚åº”è®¡ç®—ç›¸ç»“åˆã€‚é€šè¿‡å°†å›¾åƒåˆ†è§£ä¸ºä½Žé¢‘å’Œé«˜é¢‘åˆ†é‡ï¼Œå¹¶ä½¿ç”¨MoEç»“æž„è¿›è¡Œå†…å®¹è‡ªé€‚åº”å¤„ç†ï¼Œæ¨¡åž‹èƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰å›¾åƒçš„ç»†èŠ‚å’Œç»“æž„ä¿¡æ¯ã€‚Mambaæž¶æž„çš„ä½¿ç”¨åˆ™æœ‰åŠ©äºŽæ•æ‰åºåˆ—ä¾èµ–å…³ç³»ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šHiFi-MambaV2çš„æ•´ä½“æž¶æž„åŒ…å«ä»¥ä¸‹å‡ ä¸ªä¸»è¦æ¨¡å—ï¼š(1) å¯åˆ†ç¦»çš„é¢‘çŽ‡ä¸€è‡´æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”(SF-Lap)ï¼šç”¨äºŽå°†è¾“å…¥å›¾åƒåˆ†è§£ä¸ºä½Žé¢‘å’Œé«˜é¢‘åˆ†é‡ã€‚(2) åˆ†å±‚å…±äº«è·¯ç”±MoEï¼šç”¨äºŽå¯¹ä¸åŒé¢‘çŽ‡åˆ†é‡è¿›è¡Œå†…å®¹è‡ªé€‚åº”å¤„ç†ï¼Œå…¶ä¸­åŒ…å«å…±äº«ä¸“å®¶å’Œæœ¬åœ°è·¯ç”±å™¨ã€‚(3) è½»é‡çº§å…¨å±€ä¸Šä¸‹æ–‡è·¯å¾„ï¼šç”¨äºŽæ•æ‰å›¾åƒçš„å…¨å±€ä¿¡æ¯ï¼Œå¹¶ä¿æŒè§£å‰–ç»“æž„çš„è¿žè´¯æ€§ã€‚(4) æ•°æ®ä¸€è‡´æ€§æ­£åˆ™åŒ–çš„éª¨å¹²ç½‘ç»œï¼šç”¨äºŽä¿è¯é‡å»ºå›¾åƒä¸ŽåŽŸå§‹kç©ºé—´æ•°æ®çš„ä¸€è‡´æ€§ã€‚

**å…³é”®åˆ›æ–°**ï¼šè¯¥è®ºæ–‡çš„å…³é”®åˆ›æ–°åœ¨äºŽï¼š(1) æå‡ºäº†å¯åˆ†ç¦»çš„é¢‘çŽ‡ä¸€è‡´æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”(SF-Lap)ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°åˆ†ç¦»ä½Žé¢‘å’Œé«˜é¢‘åˆ†é‡ï¼Œå¹¶å‡å°‘æ··å ä¼ªå½±ã€‚(2) æå‡ºäº†åˆ†å±‚å…±äº«è·¯ç”±MoEï¼Œèƒ½å¤Ÿæ ¹æ®è¾“å…¥å†…å®¹è‡ªé€‚åº”åœ°é€‰æ‹©ä¸åŒçš„ä¸“å®¶è¿›è¡Œå¤„ç†ï¼Œæé«˜æ¨¡åž‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚(3) å°†å…¨å±€ä¸Šä¸‹æ–‡è·¯å¾„èžå…¥åˆ°éª¨å¹²ç½‘ç»œä¸­ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰å›¾åƒçš„å…¨å±€ä¿¡æ¯ï¼Œå¹¶ä¿æŒè§£å‰–ç»“æž„çš„è¿žè´¯æ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šSF-Lapé‡‡ç”¨å¯åˆ†ç¦»çš„å·ç§¯æ“ä½œï¼Œé™ä½Žäº†è®¡ç®—å¤æ‚åº¦ã€‚MoEç»“æž„é‡‡ç”¨top-1ç¨€ç–è°ƒåº¦ï¼Œä¿è¯äº†è®¡ç®—æ•ˆçŽ‡ã€‚å…¨å±€ä¸Šä¸‹æ–‡è·¯å¾„é‡‡ç”¨è½»é‡çº§çš„è®¾è®¡ï¼Œé¿å…äº†å¼•å…¥è¿‡å¤šçš„è®¡ç®—å¼€é”€ã€‚æ•°æ®ä¸€è‡´æ€§æ­£åˆ™åŒ–é‡‡ç”¨æ ‡å‡†çš„kç©ºé—´ä¸€è‡´æ€§æŸå¤±å‡½æ•°ã€‚å…·ä½“çš„ç½‘ç»œç»“æž„å‚æ•°ï¼ˆå¦‚å·ç§¯æ ¸å¤§å°ã€é€šé“æ•°ç­‰ï¼‰å’ŒæŸå¤±å‡½æ•°æƒé‡ç­‰ç»†èŠ‚åœ¨è®ºæ–‡ä¸­æœ‰è¯¦ç»†æè¿°ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

HiFi-MambaV2åœ¨fastMRIã€CC359ã€ACDCã€M4Rawå’ŒProstate158ç­‰å¤šä¸ªæ•°æ®é›†ä¸Šè¿›è¡Œäº†è¯„ä¼°ï¼Œç»“æžœè¡¨æ˜Žå…¶åœ¨PSNRã€SSIMå’ŒNMSEç­‰æŒ‡æ ‡ä¸Šå‡ä¼˜äºŽçŽ°æœ‰çš„CNNã€Transformerå’ŒMambaæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œåœ¨fastMRIæ•°æ®é›†ä¸Šï¼ŒHiFi-MambaV2åœ¨åŠ é€Ÿå› å­ä¸º4çš„æƒ…å†µä¸‹ï¼ŒPSNRæå‡äº†è¶…è¿‡1dBï¼ŒSSIMæå‡äº†0.01ï¼Œè¡¨æ˜Žå…¶åœ¨é«˜é¢‘ç»†èŠ‚å’Œæ•´ä½“ç»“æž„ä¿çœŸåº¦æ–¹é¢å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

HiFi-MambaV2åœ¨åŒ»å­¦å½±åƒé¢†åŸŸå…·æœ‰å¹¿æ³›çš„åº”ç”¨å‰æ™¯ï¼Œå¯ä»¥ç”¨äºŽæé«˜MRIå›¾åƒçš„é‡å»ºè´¨é‡ï¼Œä»Žè€Œè¾…åŠ©åŒ»ç”Ÿè¿›è¡Œæ›´å‡†ç¡®çš„è¯Šæ–­ã€‚è¯¥æŠ€æœ¯å¯ä»¥åº”ç”¨äºŽå„ç§MRIæ‰«æï¼ŒåŒ…æ‹¬è„‘éƒ¨ã€å¿ƒè„ã€è…¹éƒ¨ç­‰ï¼Œå¹¶å¯ä»¥ä¸Žå…¶ä»–åŒ»å­¦å½±åƒæŠ€æœ¯ç›¸ç»“åˆï¼Œä¾‹å¦‚CTå’ŒPETï¼Œä»¥æä¾›æ›´å…¨é¢çš„è¯Šæ–­ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œè¯¥æŠ€æœ¯è¿˜å¯ä»¥åº”ç”¨äºŽä½Žå‰‚é‡MRIæ‰«æï¼Œä»¥å‡å°‘æ‚£è€…çš„è¾å°„æš´éœ²ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Reconstructing high-fidelity MR images from undersampled k-space data requires recovering high-frequency details while maintaining anatomical coherence. We present HiFi-MambaV2, a hierarchical shared-routed Mixture-of-Experts (MoE) Mamba architecture that couples frequency decomposition with content-adaptive computation. The model comprises two core components: (i) a separable frequency-consistent Laplacian pyramid (SF-Lap) that delivers alias-resistant, stable low- and high-frequency streams; and (ii) a hierarchical shared-routed MoE that performs per-pixel top-1 sparse dispatch to shared experts and local routers, enabling effective specialization with stable cross-depth behavior. A lightweight global context path is fused into an unrolled, data-consistency-regularized backbone to reinforce long-range reasoning and preserve anatomical coherence. Evaluated on fastMRI, CC359, ACDC, M4Raw, and Prostate158, HiFi-MambaV2 consistently outperforms CNN-, Transformer-, and prior Mamba-based baselines in PSNR, SSIM, and NMSE across single- and multi-coil settings and multiple acceleration factors, consistently surpassing consistent improvements in high-frequency detail and overall structural fidelity. These results demonstrate that HiFi-MambaV2 enables reliable and robust MRI reconstruction.

