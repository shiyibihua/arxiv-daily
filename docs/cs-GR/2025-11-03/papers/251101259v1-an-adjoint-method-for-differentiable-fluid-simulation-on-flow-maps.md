---
layout: default
title: An Adjoint Method for Differentiable Fluid Simulation on Flow Maps
---

# An Adjoint Method for Differentiable Fluid Simulation on Flow Maps

<div class="paper-toolbar">
  <div class="toolbar-left">
    <a href="https://arxiv.org/abs/2511.01259" target="_blank" class="toolbar-btn">arXiv: 2511.01259v1</a>
    <a href="https://arxiv.org/pdf/2511.01259.pdf" target="_blank" class="toolbar-btn">PDF</a>
  </div>
  <div class="toolbar-right">
    <button class="toolbar-btn favorite-btn" data-arxiv-id="2511.01259v1" 
            onclick="toggleFavorite(this, '2511.01259v1', 'An Adjoint Method for Differentiable Fluid Simulation on Flow Maps')" title="Êî∂Ëóè">
      ‚òÜ Êî∂Ëóè
    </button>
    <button class="toolbar-btn share-btn" onclick="copyLink()" title="Â§çÂà∂ÈìæÊé•">
      üîó ÂàÜ‰∫´
    </button>
  </div>
</div>


**‰ΩúËÄÖ**: Zhiqi Li, Jinjin He, Barnab√°s B√∂rcs√∂k, Taiyuan Zhang, Duowen Chen, Tao Du, Ming C. Lin, Greg Turk, Bo Zhu

**ÂàÜÁ±ª**: cs.GR, physics.flu-dyn

**ÂèëÂ∏ÉÊó•Êúü**: 2025-11-03

**Â§áÊ≥®**: 15 pages, 16 figures

**ÊúüÂàä**: ACM SIGGRAPH Asia Conference Proceedings (2025)

**DOI**: [10.1145/3757377.3763903](https://doi.org/10.1145/3757377.3763903)

---

## üí° ‰∏ÄÂè•ËØùË¶ÅÁÇπ

**ÊèêÂá∫Âü∫‰∫éÊµÅÊò†Â∞ÑÁöÑÂèØÂæÆÊµÅ‰ΩìÊ®°Êãü‰º¥ÈöèÊñπÊ≥ïÔºåÂÆûÁé∞Á≤æÁ°ÆÊ∂°ÊóãÂä®ÂäõÂ≠¶ÊéßÂà∂**

üéØ **ÂåπÈÖçÈ¢ÜÂüü**: **ÊîØÊü±ÂÖ´ÔºöÁâ©ÁêÜÂä®Áîª (Physics-based Animation)**

**ÂÖ≥ÈîÆËØç**: `ÂèØÂæÆÊµÅ‰ΩìÊ®°Êãü` `‰º¥ÈöèÊñπÊ≥ï` `ÊµÅÊò†Â∞Ñ` `Ê∂°ÊóãÂä®ÂäõÂ≠¶` `Ê¢ØÂ∫¶ËÆ°ÁÆó`

## üìã Ê†∏ÂøÉË¶ÅÁÇπ

1. ‰º†Áªü‰º¥ÈöèÊñπÊ≥ïÂú®ÂèØÂæÆÊµÅ‰ΩìÊ®°Êãü‰∏≠ÈúÄË¶ÅÂ≠òÂÇ®Â§ßÈáè‰∏≠Èó¥ÂèòÈáèÊàñÂæÆÂàÜÊï∞ÂÄºÊ≠•È™§ÔºåÂØºËá¥ËÆ°ÁÆóÊàêÊú¨È´òÊòÇ„ÄÇ
2. ËÆ∫ÊñáÊèêÂá∫Âà©Áî®Ê≠£ÂêëÊ®°Êãü‰∏≠ÁöÑÊµÅÊò†Â∞ÑÔºåÂú®ÂèçÂêë‰º†Êí≠‰∏≠Áõ¥Êé•Ê±ÇËß£‰º¥ÈöèÊñπÁ®ãÔºåÈÅøÂÖç‰∫ÜÂØπ‰∏≠Èó¥Ê≠•È™§ÁöÑÂæÆÂàÜÂíåÂ≠òÂÇ®„ÄÇ
3. ÂÆûÈ™åË°®ÊòéÔºåËØ•ÊñπÊ≥ïÂú®‰ΩéÂÜÖÂ≠òÂç†Áî®‰∏ãÔºåËÉΩÂ§üÁ≤æÁ°ÆË∑üË∏™Ê∂°ÈáèÔºåÂπ∂ÊîØÊåÅÈúÄË¶ÅÁ≤æÁ°ÆÊéßÂà∂Ê∂°ÊóãÂä®ÂäõÂ≠¶ÁöÑÂèØÂæÆÊ®°Êãü‰ªªÂä°„ÄÇ

## üìù ÊëòË¶ÅÔºà‰∏≠ÊñáÔºâ

Êú¨ÊñáÊèêÂá∫‰∫Ü‰∏ÄÁßçÊñ∞È¢ñÁöÑ‰º¥ÈöèÊ±ÇËß£Âô®ÔºåÁî®‰∫éÂü∫‰∫éÂèåÂêëÊµÅÊò†Â∞ÑÁöÑÂèØÂæÆÊµÅ‰ΩìÊ®°Êãü„ÄÇÊ†∏ÂøÉÊÄùÊÉ≥ÊòØÊ≠£ÂêëÊµÅ‰ΩìÊ±ÇËß£Âô®ÂèäÂÖ∂ÂØπÂ∫îÁöÑÂèçÂêë‰º¥ÈöèÊ±ÇËß£Âô®ÂÖ±‰∫´Áõ∏ÂêåÁöÑÊµÅÊò†Â∞ÑÔºåÊ≠£ÂêëËøáÁ®ãÂà©Áî®ËØ•Êò†Â∞ÑÂ∞ÜÊµÅ‰ΩìËÑâÂÜ≤ÂèòÈáè‰ªéÂàùÂßãÂ∏ß‰º†ËæìÂà∞ÂΩìÂâçÂ∏ßÔºå‰ª•Ê®°ÊãüÊ∂°ÊóãÂä®ÂäõÂ≠¶„ÄÇÂèçÂêëËøáÁ®ãÂàôÂà©Áî®Áõ∏ÂêåÁöÑÊò†Â∞ÑÂ∞Ü‰º¥ÈöèÂèòÈáè‰ªéÂΩìÂâçÂ∏ß‰º†Êí≠ÂõûÂàùÂßãÂ∏ßÔºå‰ª•ËÆ°ÁÆóÊ¢ØÂ∫¶„ÄÇËøôÁßçÂÖ±‰∫´ÁöÑÈïøÁ®ãÊò†Â∞Ñ‰ΩøÂæóÊ¢ØÂ∫¶ËÆ°ÁÆóÁöÑÁ≤æÂ∫¶ËÉΩÂ§üÁõ¥Êé•ÂèóÁõä‰∫éÊµÅÊò†Â∞ÑÊûÑÂª∫ÁöÑÊîπËøõ„ÄÇÂü∫‰∫éÊ≠§ÔºåÊàë‰ª¨ÂºïÂÖ•‰∫Ü‰∏ÄÁßçÊñ∞ÁöÑ‰º¥ÈöèÊ±ÇËß£Âô®ÔºåÂÆÉÁõ¥Êé•Âú®ÊµÅÊò†Â∞Ñ‰∏äÊ±ÇËß£‰º¥ÈöèÊñπÁ®ãÔºå‰ªéËÄåÂÆûÁé∞ÂØπ‰∏çÂèØÂéãÁº©ÊµÅÁöÑÈïøÁ®ãÂíåÁ≤æÁ°ÆÂæÆÂàÜÔºåËÄåÊó†ÈúÄÂÉè‰º†Áªü‰º¥ÈöèÊñπÊ≥ïÈÇ£Ê†∑ÂæÆÂàÜ‰∏≠Èó¥Êï∞ÂÄºÊ≠•È™§ÊàñÂ≠òÂÇ®‰∏≠Èó¥ÂèòÈáè„ÄÇ‰∏∫‰∫ÜËøõ‰∏ÄÊ≠•ÊèêÈ´òÊïàÁéáÔºåÊàë‰ª¨ÊèêÂá∫‰∫Ü‰∏ÄÁßçÈïøÁü≠Êó∂Á®ÄÁñèÊµÅÊò†Â∞ÑË°®Á§∫ÔºåÁî®‰∫éÊºîÂåñ‰º¥ÈöèÂèòÈáè„ÄÇÊàë‰ª¨ÁöÑÊñπÊ≥ïÂÖ∑Êúâ‰ΩéÂÜÖÂ≠òÂç†Áî®ÔºåÂú®$192^3$ÂàÜËæ®Áéá‰∏ã‰ªÖÈúÄ6.53GBÊï∞ÊçÆÔºåÂêåÊó∂‰øùÊåÅ‰∫ÜË∑üË∏™Ê∂°ÈáèÁöÑÁ≤æÂ∫¶Ôºå‰ªéËÄåÂÆûÁé∞‰∫ÜÈúÄË¶ÅÁ≤æÁ°ÆËØÜÂà´„ÄÅÈ¢ÑÊµãÂíåÊéßÂà∂Ê∂°ÊóãÂä®ÂäõÂ≠¶ÁöÑÊñ∞ÂûãÂèØÂæÆÊ®°Êãü‰ªªÂä°„ÄÇ

## üî¨ ÊñπÊ≥ïËØ¶Ëß£

**ÈóÆÈ¢òÂÆö‰πâ**ÔºöÂèØÂæÆÊµÅ‰ΩìÊ®°ÊãüÊó®Âú®ËÆ°ÁÆóÊµÅ‰ΩìÊ®°ÊãüËøáÁ®ãÂØπÂèÇÊï∞ÁöÑÊ¢ØÂ∫¶Ôºå‰ª•‰æøËøõË°å‰ºòÂåñÂíåÊéßÂà∂„ÄÇ‰º†ÁªüÁöÑ‰º¥ÈöèÊñπÊ≥ïÈúÄË¶ÅÂ≠òÂÇ®Â§ßÈáèÁöÑ‰∏≠Èó¥ÂèòÈáèÊàñËÄÖÂØπÊï∞ÂÄºÊ±ÇËß£Âô®ËøõË°åÂæÆÂàÜÔºåËøôÂØºËá¥‰∫ÜÂ∑®Â§ßÁöÑÂÜÖÂ≠òÂºÄÈîÄÂíåËÆ°ÁÆóÂ§çÊùÇÂ∫¶ÔºåÂ∞§ÂÖ∂ÊòØÂú®È´òÂàÜËæ®ÁéáÁöÑÊ®°Êãü‰∏≠„ÄÇÁé∞ÊúâÁöÑÊñπÊ≥ïÈöæ‰ª•Âú®‰øùËØÅÁ≤æÂ∫¶ÁöÑÂâçÊèê‰∏ãÔºåÊúâÊïàÂú∞Â§ÑÁêÜÂ§ßËßÑÊ®°ÁöÑÊµÅ‰ΩìÊ®°Êãü„ÄÇ

**Ê†∏ÂøÉÊÄùË∑Ø**ÔºöËÆ∫ÊñáÁöÑÊ†∏ÂøÉÊÄùË∑ØÊòØÂà©Áî®ÊµÅÊò†Â∞ÑÔºàFlow MapÔºâÂ∞ÜÊµÅ‰ΩìÊ®°Êãü‰∏≠ÁöÑÊ≠£ÂêëËøáÁ®ãÂíåÂèçÂêë‰º¥ÈöèËøáÁ®ãËÅîÁ≥ªËµ∑Êù•„ÄÇÊ≠£ÂêëÊ®°Êãü‰ΩøÁî®ÊµÅÊò†Â∞ÑÊù•ËøΩË∏™ÊµÅ‰ΩìÁ≤íÂ≠êÁöÑËøêÂä®ÔºåËÄåÂèçÂêë‰º†Êí≠ÂàôÂà©Áî®Áõ∏ÂêåÁöÑÊµÅÊò†Â∞ÑÊù•‰º†Êí≠‰º¥ÈöèÂèòÈáè„ÄÇÈÄöËøáÂú®ÊµÅÊò†Â∞Ñ‰∏äÁõ¥Êé•Ê±ÇËß£‰º¥ÈöèÊñπÁ®ãÔºåÈÅøÂÖç‰∫ÜÂØπ‰∏≠Èó¥Êï∞ÂÄºÊ≠•È™§ÁöÑÂæÆÂàÜÂíåÂ≠òÂÇ®Ôºå‰ªéËÄåÊòæËëóÈôç‰Ωé‰∫ÜÂÜÖÂ≠òÂç†Áî®ÂíåËÆ°ÁÆóÂ§çÊùÇÂ∫¶„ÄÇ

**ÊäÄÊúØÊ°ÜÊû∂**ÔºöËØ•ÊñπÊ≥ï‰∏ªË¶ÅÂåÖÂê´‰ª•‰∏ãÂá†‰∏™Èò∂ÊÆµÔºö1) Ê≠£ÂêëÊµÅ‰ΩìÊ®°ÊãüÔºö‰ΩøÁî®ÊµÅÊò†Â∞ÑÊù•Ê®°ÊãüÊµÅ‰ΩìÁöÑËøêÂä®ÔºåÂπ∂ËÆ∞ÂΩïÊµÅÊò†Â∞ÑÁöÑ‰ø°ÊÅØ„ÄÇ2) ‰º¥ÈöèÊñπÁ®ãÊ±ÇËß£ÔºöÂú®ÊµÅÊò†Â∞Ñ‰∏äÁõ¥Êé•Ê±ÇËß£‰º¥ÈöèÊñπÁ®ãÔºåËÆ°ÁÆóÊ¢ØÂ∫¶„ÄÇ3) Ê¢ØÂ∫¶Â∫îÁî®ÔºöÂ∞ÜËÆ°ÁÆóÂæóÂà∞ÁöÑÊ¢ØÂ∫¶Áî®‰∫é‰ºòÂåñÂíåÊéßÂà∂ÊµÅ‰ΩìÊ®°ÊãüËøáÁ®ã„ÄÇ‰∏∫‰∫ÜÊèêÈ´òÊïàÁéáÔºåËÆ∫ÊñáËøòÊèêÂá∫‰∫ÜÈïøÁü≠Êó∂Á®ÄÁñèÊµÅÊò†Â∞ÑË°®Á§∫„ÄÇ

**ÂÖ≥ÈîÆÂàõÊñ∞**ÔºöËØ•ÊñπÊ≥ïÊúÄÈáçË¶ÅÁöÑÊäÄÊúØÂàõÊñ∞ÁÇπÂú®‰∫éÂà©Áî®ÊµÅÊò†Â∞ÑÂ∞ÜÊ≠£ÂêëÊ®°ÊãüÂíåÂèçÂêë‰º¥ÈöèËøáÁ®ãËÅîÁ≥ªËµ∑Êù•ÔºåÂπ∂Âú®ÊµÅÊò†Â∞Ñ‰∏äÁõ¥Êé•Ê±ÇËß£‰º¥ÈöèÊñπÁ®ã„ÄÇ‰∏é‰º†ÁªüÁöÑ‰º¥ÈöèÊñπÊ≥ïÁõ∏ÊØîÔºåËØ•ÊñπÊ≥ï‰∏çÈúÄË¶ÅÂ≠òÂÇ®‰∏≠Èó¥ÂèòÈáèÊàñÂæÆÂàÜÊï∞ÂÄºÊ≠•È™§Ôºå‰ªéËÄåÊòæËëóÈôç‰Ωé‰∫ÜÂÜÖÂ≠òÂç†Áî®ÂíåËÆ°ÁÆóÂ§çÊùÇÂ∫¶„ÄÇÊ≠§Â§ñÔºåÈïøÁü≠Êó∂Á®ÄÁñèÊµÅÊò†Â∞ÑË°®Á§∫Ëøõ‰∏ÄÊ≠•ÊèêÈ´ò‰∫ÜËÆ°ÁÆóÊïàÁéá„ÄÇ

**ÂÖ≥ÈîÆËÆæËÆ°**ÔºöËÆ∫ÊñáÊèêÂá∫‰∫ÜÈïøÁü≠Êó∂Á®ÄÁñèÊµÅÊò†Â∞ÑË°®Á§∫ÔºåÁî®‰∫éÈ´òÊïàÂú∞Â≠òÂÇ®ÂíåËÆøÈóÆÊµÅÊò†Â∞Ñ‰ø°ÊÅØ„ÄÇÂÖ∑‰ΩìÊù•ËØ¥ÔºåÂ∞ÜÊµÅÊò†Â∞ÑÂàÜËß£‰∏∫ÈïøÊó∂ÂíåÁü≠Êó∂‰∏§ÈÉ®ÂàÜÔºåÈïøÊó∂ÈÉ®ÂàÜÁî®‰∫éËøΩË∏™ÊµÅ‰ΩìÁöÑÊï¥‰ΩìËøêÂä®Ë∂ãÂäøÔºåÁü≠Êó∂ÈÉ®ÂàÜÁî®‰∫éÊçïÊçâÊµÅ‰ΩìÁöÑÂ±ÄÈÉ®ÁªÜËäÇ„ÄÇÊ≠§Â§ñÔºåËÆ∫ÊñáËøòËÆæËÆ°‰∫ÜÁõ∏Â∫îÁöÑÊçüÂ§±ÂáΩÊï∞ÔºåÁî®‰∫é‰ºòÂåñÊµÅ‰ΩìÊ®°ÊãüËøáÁ®ã‰∏≠ÁöÑÂèÇÊï∞„ÄÇ

## üìä ÂÆûÈ™å‰∫ÆÁÇπ

ËØ•ÊñπÊ≥ïÂú®$192^3$ÂàÜËæ®Áéá‰∏ã‰ªÖÈúÄ6.53GBÂÜÖÂ≠òÔºåÊòæËëó‰Ωé‰∫é‰º†Áªü‰º¥ÈöèÊñπÊ≥ï„ÄÇÂÆûÈ™åÁªìÊûúË°®ÊòéÔºåËØ•ÊñπÊ≥ïËÉΩÂ§üÁ≤æÁ°ÆË∑üË∏™Ê∂°ÈáèÔºåÂπ∂ÊîØÊåÅÈúÄË¶ÅÁ≤æÁ°ÆËØÜÂà´„ÄÅÈ¢ÑÊµãÂíåÊéßÂà∂Ê∂°ÊóãÂä®ÂäõÂ≠¶ÁöÑÂèØÂæÆÊ®°Êãü‰ªªÂä°„ÄÇ‰∏éÁé∞ÊúâÊñπÊ≥ïÁõ∏ÊØîÔºåËØ•ÊñπÊ≥ïÂú®ÂÜÖÂ≠òÂç†Áî®ÂíåËÆ°ÁÆóÊïàÁéáÊñπÈù¢ÂÖ∑ÊúâÊòæËëó‰ºòÂäøÔºåÂêåÊó∂‰øùÊåÅ‰∫ÜËæÉÈ´òÁöÑÁ≤æÂ∫¶„ÄÇ

## üéØ Â∫îÁî®Âú∫ÊôØ

ËØ•Á†îÁ©∂ÊàêÊûúÂèØÂ∫îÁî®‰∫éÂêÑÁßçÈúÄË¶ÅÁ≤æÁ°ÆÊéßÂà∂ÊµÅ‰ΩìËøêÂä®ÁöÑÈ¢ÜÂüüÔºå‰æãÂ¶ÇÔºöÊµÅ‰ΩìÊéßÂà∂„ÄÅÊú∫Âô®‰∫∫Êìç‰Ωú„ÄÅËÆ°ÁÆóÊú∫Âä®Áîª„ÄÅ‰ª•ÂèäÊùêÊñôËÆæËÆ°Á≠â„ÄÇÈÄöËøáÂèØÂæÆÊµÅ‰ΩìÊ®°ÊãüÔºåÂèØ‰ª•‰ºòÂåñÊéßÂà∂Á≠ñÁï•ÔºåÁîüÊàêÊõ¥ÈÄºÁúüÁöÑÂä®ÁîªÊïàÊûúÔºåÂπ∂ËÆæËÆ°ÂÖ∑ÊúâÁâπÂÆöÊµÅ‰ΩìÂä®ÂäõÂ≠¶ÁâπÊÄßÁöÑÊùêÊñô„ÄÇËØ•ÊñπÊ≥ï‰∏∫ÊµÅ‰ΩìÊ®°Êãü‰∏éÊú∫Âô®Â≠¶‰π†ÁöÑÁªìÂêàÊèê‰æõ‰∫ÜÊñ∞ÁöÑÊÄùË∑Ø„ÄÇ

## üìÑ ÊëòË¶ÅÔºàÂéüÊñáÔºâ

> This paper presents a novel adjoint solver for differentiable fluid simulation based on bidirectional flow maps. Our key observation is that the forward fluid solver and its corresponding backward, adjoint solver share the same flow map as the forward simulation. In the forward pass, this map transports fluid impulse variables from the initial frame to the current frame to simulate vortical dynamics. In the backward pass, the same map propagates adjoint variables from the current frame back to the initial frame to compute gradients. This shared long-range map allows the accuracy of gradient computation to benefit directly from improvements in flow map construction. Building on this insight, we introduce a novel adjoint solver that solves the adjoint equations directly on the flow map, enabling long-range and accurate differentiation of incompressible flows without differentiating intermediate numerical steps or storing intermediate variables, as required in conventional adjoint methods. To further improve efficiency, we propose a long-short time-sparse flow map representation for evolving adjoint variables. Our approach has low memory usage, requiring only 6.53GB of data at a resolution of $192^3$ while preserving high accuracy in tracking vorticity, enabling new differentiable simulation tasks that require precise identification, prediction, and control of vortex dynamics.

