---
layout: default
title: Securing LLM-Generated Embedded Firmware through AI Agent-Driven Validation and Patching
---

# Securing LLM-Generated Embedded Firmware through AI Agent-Driven Validation and Patching

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.09970" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.09970v1</a>
  <a href="https://arxiv.org/pdf/2509.09970.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.09970v1" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.09970v1', 'Securing LLM-Generated Embedded Firmware through AI Agent-Driven Validation and Patching')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Seyed Moein Abtahi, Akramul Azim

**åˆ†ç±»**: cs.CR, cs.AI

**å‘å¸ƒæ—¥æœŸ**: 2025-09-12

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºAI Agenté©±åŠ¨çš„éªŒè¯ä¸ä¿®è¡¥æ–¹æ³•ï¼Œä¿éšœLLMç”ŸæˆåµŒå…¥å¼å›ºä»¶å®‰å…¨**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¹ï¼šå…·èº«å¤§æ¨¡å‹ (Embodied Foundation Models)**

**å…³é”®è¯**: `åµŒå…¥å¼å›ºä»¶å®‰å…¨` `å¤§è¯­è¨€æ¨¡å‹` `AI Agent` `è‡ªåŠ¨åŒ–éªŒè¯` `è¿­ä»£ä¿®å¤`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. LLMåœ¨ç”ŸæˆåµŒå…¥å¼ç³»ç»Ÿå›ºä»¶æ–¹é¢æœ‰æ½œåŠ›ï¼Œä½†å¸¸å¼•å…¥å®‰å…¨æ¼æ´å’Œä¸æ»¡è¶³å®æ—¶æ€§èƒ½çº¦æŸã€‚
2. æå‡ºä¸€ç§AI Agenté©±åŠ¨çš„éªŒè¯ä¸ä¿®è¡¥æ–¹æ³•ï¼Œåœ¨è™šæ‹Ÿç¯å¢ƒä¸­è¿­ä»£æ”¹è¿›LLMç”Ÿæˆçš„å›ºä»¶ã€‚
3. å®éªŒè¡¨æ˜ï¼Œè¯¥æ–¹æ³•æ˜¾è‘—æå‡äº†å›ºä»¶çš„å®‰å…¨æ€§å’Œæ€§èƒ½ï¼Œå¹¶æ„å»ºäº†å¼€æºæ•°æ®é›†ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æå‡ºäº†ä¸€ç§ä¸‰é˜¶æ®µæ–¹æ³•ï¼Œç»“åˆäº†åŸºäºLLMçš„å›ºä»¶ç”Ÿæˆä¸è™šæ‹ŸåŒ–ç¯å¢ƒä¸­çš„è‡ªåŠ¨å®‰å…¨éªŒè¯å’Œè¿­ä»£æ”¹è¿›ã€‚åˆ©ç”¨ç»“æ„åŒ–æç¤ºï¼ŒGPT-4ç­‰æ¨¡å‹ç”Ÿæˆç”¨äºç½‘ç»œå’Œæ§åˆ¶ä»»åŠ¡çš„å›ºä»¶ï¼Œå¹¶åœ¨FreeRTOSä¸Šé€šè¿‡QEMUéƒ¨ç½²ã€‚ä½¿ç”¨æ¨¡ç³Šæµ‹è¯•ã€é™æ€åˆ†æå’Œè¿è¡Œæ—¶ç›‘æ§æ¥æµ‹è¯•è¿™äº›å®ç°ï¼Œä»¥æ£€æµ‹ç¼“å†²åŒºæº¢å‡ºï¼ˆCWE-120ï¼‰ã€ç«äº‰æ¡ä»¶ï¼ˆCWE-362ï¼‰å’Œæ‹’ç»æœåŠ¡å¨èƒï¼ˆCWE-400ï¼‰ç­‰æ¼æ´ã€‚ç”¨äºå¨èƒæ£€æµ‹ã€æ€§èƒ½ä¼˜åŒ–å’Œåˆè§„æ€§éªŒè¯çš„ä¸“ç”¨AI AgentååŒå·¥ä½œï¼Œä»¥æé«˜æ£€æµ‹å’Œä¿®å¤èƒ½åŠ›ã€‚ä½¿ç”¨CWEå¯¹è¯†åˆ«å‡ºçš„é—®é¢˜è¿›è¡Œåˆ†ç±»ï¼Œç„¶åç”¨äºæç¤ºLLMç”Ÿæˆæœ‰é’ˆå¯¹æ€§çš„è¡¥ä¸ï¼Œå½¢æˆè¿­ä»£å¾ªç¯ã€‚å®éªŒè¡¨æ˜ï¼Œæ¼æ´ä¿®å¤ç‡è¾¾åˆ°92.4%ï¼ˆæé«˜37.3%ï¼‰ï¼Œå¨èƒæ¨¡å‹åˆè§„æ€§è¾¾åˆ°95.8%ï¼Œå®‰å…¨è¦†ç›–æŒ‡æ•°è¾¾åˆ°0.87ã€‚å®æ—¶æŒ‡æ ‡åŒ…æ‹¬8.6msçš„æœ€åæƒ…å†µæ‰§è¡Œæ—¶é—´å’Œ195Î¼sçš„æŠ–åŠ¨ã€‚æ­¤è¿‡ç¨‹å¢å¼ºäº†å›ºä»¶çš„å®‰å…¨æ€§å’Œæ€§èƒ½ï¼ŒåŒæ—¶è´¡çŒ®äº†ä¸€ä¸ªå¼€æºæ•°æ®é›†ï¼Œä¾›æœªæ¥ç ”ç©¶ä½¿ç”¨ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³LLMç”Ÿæˆçš„åµŒå…¥å¼å›ºä»¶ä¸­å­˜åœ¨çš„å®‰å…¨æ¼æ´å’Œæ€§èƒ½é—®é¢˜ã€‚ç°æœ‰æ–¹æ³•ä¾èµ–äººå·¥å®¡è®¡å’Œæµ‹è¯•ï¼Œæ•ˆç‡ä½ä¸”éš¾ä»¥è¦†ç›–æ‰€æœ‰æ½œåœ¨é£é™©ã€‚LLMè™½ç„¶èƒ½å¿«é€Ÿç”Ÿæˆä»£ç ï¼Œä½†ç¼ºä¹å¯¹åµŒå…¥å¼ç³»ç»Ÿå®‰å…¨å’Œå®æ—¶æ€§çš„å†…åœ¨ç†è§£ï¼Œå¯¼è‡´ç”Ÿæˆçš„å›ºä»¶å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºã€ç«äº‰æ¡ä»¶ç­‰å®‰å…¨éšæ‚£ï¼Œä»¥åŠä¸æ»¡è¶³å®æ—¶æ€§çº¦æŸçš„é—®é¢˜ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯åˆ©ç”¨AI Agentè‡ªåŠ¨åŒ–å›ºä»¶çš„å®‰å…¨éªŒè¯å’Œè¿­ä»£ä¿®å¤è¿‡ç¨‹ã€‚é€šè¿‡æ„å»ºä¸€ä¸ªè™šæ‹ŸåŒ–ç¯å¢ƒï¼Œå¯¹LLMç”Ÿæˆçš„å›ºä»¶è¿›è¡Œå…¨é¢çš„å®‰å…¨æµ‹è¯•å’Œæ€§èƒ½è¯„ä¼°ã€‚åˆ©ç”¨ä¸“é—¨çš„AI Agentè¯†åˆ«æ¼æ´ã€ä¼˜åŒ–æ€§èƒ½å’ŒéªŒè¯åˆè§„æ€§ï¼Œå¹¶å°†å‘ç°çš„é—®é¢˜åé¦ˆç»™LLMï¼Œç”Ÿæˆé’ˆå¯¹æ€§çš„è¡¥ä¸ï¼Œå½¢æˆä¸€ä¸ªé—­ç¯çš„è¿­ä»£æ”¹è¿›è¿‡ç¨‹ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šè¯¥æ–¹æ³•åŒ…å«ä¸‰ä¸ªä¸»è¦é˜¶æ®µï¼š1) LLMå›ºä»¶ç”Ÿæˆï¼šä½¿ç”¨ç»“æ„åŒ–æç¤ºï¼Œå¼•å¯¼LLMï¼ˆå¦‚GPT-4ï¼‰ç”Ÿæˆç”¨äºç‰¹å®šåµŒå…¥å¼ä»»åŠ¡çš„å›ºä»¶ä»£ç ã€‚2) è‡ªåŠ¨åŒ–éªŒè¯ï¼šåœ¨QEMUè™šæ‹ŸåŒ–ç¯å¢ƒä¸­ï¼Œåˆ©ç”¨æ¨¡ç³Šæµ‹è¯•ã€é™æ€åˆ†æå’Œè¿è¡Œæ—¶ç›‘æ§ç­‰æŠ€æœ¯ï¼Œæ£€æµ‹å›ºä»¶ä¸­çš„å®‰å…¨æ¼æ´å’Œæ€§èƒ½ç“¶é¢ˆã€‚3) è¿­ä»£ä¿®å¤ï¼šåˆ©ç”¨AI Agentå¯¹æ£€æµ‹åˆ°çš„é—®é¢˜è¿›è¡Œåˆ†ç±»å’Œåˆ†æï¼Œç”Ÿæˆé’ˆå¯¹æ€§çš„ä¿®å¤å»ºè®®ï¼Œå¹¶æç¤ºLLMç”Ÿæˆç›¸åº”çš„è¡¥ä¸ã€‚å°†è¡¥ä¸åº”ç”¨åˆ°å›ºä»¶åï¼Œå†æ¬¡è¿›è¡ŒéªŒè¯ï¼Œå½¢æˆè¿­ä»£å¾ªç¯ï¼Œç›´åˆ°æ»¡è¶³å®‰å…¨å’Œæ€§èƒ½è¦æ±‚ã€‚

**å…³é”®åˆ›æ–°**ï¼šè¯¥æ–¹æ³•æœ€é‡è¦çš„åˆ›æ–°ç‚¹åœ¨äºåˆ©ç”¨AI Agentè‡ªåŠ¨åŒ–å›ºä»¶çš„å®‰å…¨éªŒè¯å’Œè¿­ä»£ä¿®å¤è¿‡ç¨‹ã€‚ä¸ä¼ ç»Ÿçš„æ‰‹å·¥æ–¹æ³•ç›¸æ¯”ï¼Œè¯¥æ–¹æ³•èƒ½å¤Ÿæ›´å¿«é€Ÿã€æ›´å…¨é¢åœ°æ£€æµ‹å’Œä¿®å¤å›ºä»¶ä¸­çš„å®‰å…¨æ¼æ´å’Œæ€§èƒ½é—®é¢˜ã€‚æ­¤å¤–ï¼Œè¯¥æ–¹æ³•è¿˜åˆ©ç”¨LLMç”Ÿæˆè¡¥ä¸ï¼Œè¿›ä¸€æ­¥æé«˜äº†ä¿®å¤æ•ˆç‡ã€‚

**å…³é”®è®¾è®¡**ï¼šè®ºæ–‡ä¸­å…³é”®çš„è®¾è®¡åŒ…æ‹¬ï¼š1) ç»“æ„åŒ–æç¤ºï¼šè®¾è®¡æ¸…æ™°ã€æ˜ç¡®çš„æç¤ºï¼Œå¼•å¯¼LLMç”Ÿæˆé«˜è´¨é‡çš„å›ºä»¶ä»£ç ã€‚2) AI Agentï¼šæ„å»ºä¸“é—¨çš„AI Agentï¼Œè´Ÿè´£å¨èƒæ£€æµ‹ã€æ€§èƒ½ä¼˜åŒ–å’Œåˆè§„æ€§éªŒè¯ã€‚è¿™äº›Agentä½¿ç”¨ä¸åŒçš„æŠ€æœ¯ï¼Œå¦‚æ¨¡ç³Šæµ‹è¯•ã€é™æ€åˆ†æå’Œè¿è¡Œæ—¶ç›‘æ§ï¼Œæ¥æ£€æµ‹å›ºä»¶ä¸­çš„é—®é¢˜ã€‚3) è¿­ä»£å¾ªç¯ï¼šè®¾è®¡ä¸€ä¸ªé—­ç¯çš„è¿­ä»£ä¿®å¤è¿‡ç¨‹ï¼Œå°†éªŒè¯ç»“æœåé¦ˆç»™LLMï¼Œç”Ÿæˆé’ˆå¯¹æ€§çš„è¡¥ä¸ï¼Œå¹¶å†æ¬¡è¿›è¡ŒéªŒè¯ï¼Œç›´åˆ°æ»¡è¶³å®‰å…¨å’Œæ€§èƒ½è¦æ±‚ã€‚è®ºæ–‡æœªæ˜ç¡®ç»™å‡ºæŸå¤±å‡½æ•°å’Œç½‘ç»œç»“æ„çš„å…·ä½“ç»†èŠ‚ï¼Œå¯èƒ½ä½¿ç”¨äº†ç°æœ‰çš„æˆç†ŸæŠ€æœ¯ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼Œè¯¥æ–¹æ³•èƒ½å¤Ÿæ˜¾è‘—æé«˜LLMç”Ÿæˆå›ºä»¶çš„å®‰å…¨æ€§ã€‚æ¼æ´ä¿®å¤ç‡è¾¾åˆ°92.4%ï¼Œç›¸æ¯”åŸºçº¿æ–¹æ³•æé«˜äº†37.3%ã€‚å¨èƒæ¨¡å‹åˆè§„æ€§è¾¾åˆ°95.8%ï¼Œå®‰å…¨è¦†ç›–æŒ‡æ•°è¾¾åˆ°0.87ã€‚æ­¤å¤–ï¼Œè¯¥æ–¹æ³•è¿˜èƒ½å¤Ÿä¼˜åŒ–å›ºä»¶çš„å®æ—¶æ€§èƒ½ï¼Œæœ€åæƒ…å†µæ‰§è¡Œæ—¶é—´ä¸º8.6msï¼ŒæŠ–åŠ¨ä¸º195Î¼sã€‚è¿™äº›ç»“æœè¡¨æ˜ï¼Œè¯¥æ–¹æ³•åœ¨æé«˜å›ºä»¶å®‰å…¨æ€§å’Œæ€§èƒ½æ–¹é¢å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæœå¯åº”ç”¨äºå„ç§åµŒå…¥å¼ç³»ç»Ÿçš„å›ºä»¶å¼€å‘ï¼Œä¾‹å¦‚ç‰©è”ç½‘è®¾å¤‡ã€å·¥ä¸šæ§åˆ¶ç³»ç»Ÿå’Œæ±½è½¦ç”µå­ç­‰ã€‚é€šè¿‡è‡ªåŠ¨åŒ–å®‰å…¨éªŒè¯å’Œè¿­ä»£ä¿®å¤ï¼Œå¯ä»¥æ˜¾è‘—æé«˜åµŒå…¥å¼å›ºä»¶çš„å®‰å…¨æ€§ï¼Œé™ä½å®‰å…¨é£é™©ï¼Œå¹¶ç¼©çŸ­å¼€å‘å‘¨æœŸã€‚è¯¥æ–¹æ³•è¿˜æœ‰åŠ©äºæé«˜åµŒå…¥å¼ç³»ç»Ÿçš„å®æ—¶æ€§èƒ½ï¼Œæ»¡è¶³å¯¹å®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„åº”ç”¨åœºæ™¯çš„éœ€æ±‚ã€‚æœªæ¥ï¼Œè¯¥ç ”ç©¶å¯ä»¥æ‰©å±•åˆ°æ›´å¤æ‚çš„åµŒå…¥å¼ç³»ç»Ÿå’Œæ›´é«˜çº§çš„å®‰å…¨å¨èƒã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Large Language Models (LLMs) show promise in generating firmware for embedded systems, but often introduce security flaws and fail to meet real-time performance constraints. This paper proposes a three-phase methodology that combines LLM-based firmware generation with automated security validation and iterative refinement in a virtualized environment. Using structured prompts, models like GPT-4 generate firmware for networking and control tasks, deployed on FreeRTOS via QEMU. These implementations are tested using fuzzing, static analysis, and runtime monitoring to detect vulnerabilities such as buffer overflows (CWE-120), race conditions (CWE-362), and denial-of-service threats (CWE-400). Specialized AI agents for Threat Detection, Performance Optimization, and Compliance Verification collaborate to improve detection and remediation. Identified issues are categorized using CWE, then used to prompt targeted LLM-generated patches in an iterative loop. Experiments show a 92.4\% Vulnerability Remediation Rate (37.3\% improvement), 95.8\% Threat Model Compliance, and 0.87 Security Coverage Index. Real-time metrics include 8.6ms worst-case execution time and 195Î¼s jitter. This process enhances firmware security and performance while contributing an open-source dataset for future research.

