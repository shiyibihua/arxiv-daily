---
layout: default
title: Semantic Preprocessing for LLM-based Malware Analysis
---

# Semantic Preprocessing for LLM-based Malware Analysis

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2506.12113" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2506.12113v4</a>
  <a href="https://arxiv.org/pdf/2506.12113.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2506.12113v4" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2506.12113v4', 'Semantic Preprocessing for LLM-based Malware Analysis')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Benjamin Marais, Tony Quertier, GrÃ©goire Barrue

**åˆ†ç±»**: cs.CR, cs.AI

**å‘å¸ƒæ—¥æœŸ**: 2025-06-13 (æ›´æ–°: 2025-10-03)

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºåŸºäºä¸“å®¶çŸ¥è¯†çš„é¢„å¤„ç†æ–¹æ³•ä»¥æå‡æ¶æ„è½¯ä»¶åˆ†æ**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¹ï¼šå…·èº«å¤§æ¨¡å‹ (Embodied Foundation Models)**

**å…³é”®è¯**: `æ¶æ„è½¯ä»¶åˆ†æ` `ä¸“å®¶çŸ¥è¯†` `è¯­ä¹‰é¢„å¤„ç†` `å¤§å‹è¯­è¨€æ¨¡å‹` `å¯è§£é‡Šæ€§` `é™æ€åˆ†æ` `è¡Œä¸ºåˆ†æ` `JSONæŠ¥å‘Š`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰æ¶æ„è½¯ä»¶åˆ†ææ–¹æ³•å¤šä¾èµ–äºæ•°æ®è§†è§’ï¼Œç¼ºä¹ä¸“å®¶çŸ¥è¯†çš„æœ‰æ•ˆåˆ©ç”¨ï¼Œå¯¼è‡´åˆ†æç»“æœçš„å¯è§£é‡Šæ€§ä¸è¶³ã€‚
2. æœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°çš„é¢„å¤„ç†æ–¹æ³•ï¼Œé€šè¿‡ç”ŸæˆJSONæŠ¥å‘Šï¼Œæ•´åˆé™æ€å’Œè¡Œä¸ºåˆ†æç‰¹å¾ï¼Œå¢å¼ºæ¶æ„è½¯ä»¶çš„è¯­ä¹‰è¡¨ç¤ºã€‚
3. é€šè¿‡ä½¿ç”¨è¯¥é¢„å¤„ç†æ–¹æ³•è®­ç»ƒå¤§å‹è¯­è¨€æ¨¡å‹ï¼Œå®éªŒç»“æœæ˜¾ç¤ºåœ¨å¤æ‚æ•°æ®é›†ä¸Šè·å¾—äº†0.94çš„åŠ æƒå¹³å‡F1åˆ†æ•°ï¼Œæ˜¾è‘—æå‡äº†åˆ†ç±»æ€§èƒ½ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

åœ¨æ¶æ„è½¯ä»¶åˆ†æçš„èƒŒæ™¯ä¸‹ï¼Œè®¸å¤šæ–¹æ³•ä¾èµ–äººå·¥æ™ºèƒ½å¤„ç†å¤§é‡æ•°æ®ã€‚ç„¶è€Œï¼Œè¿™äº›æŠ€æœ¯ä¸»è¦å…³æ³¨æ•°æ®è§†è§’ï¼ˆå¦‚å›¾åƒã€åºåˆ—ï¼‰ï¼Œè€Œå¿½è§†äº†ä¸“å®¶è§†è§’ã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€ç§åŸºäºä¸“å®¶çŸ¥è¯†çš„é¢„å¤„ç†æ–¹æ³•ï¼Œä»¥æ”¹å–„æ¶æ„è½¯ä»¶çš„è¯­ä¹‰åˆ†æå’Œç»“æœå¯è§£é‡Šæ€§ã€‚è¯¥æ–¹æ³•ç”Ÿæˆé’ˆå¯¹å¯æ‰§è¡Œæ–‡ä»¶çš„JSONæŠ¥å‘Šï¼Œæ±‡é›†é™æ€å’Œè¡Œä¸ºåˆ†æçš„ç‰¹å¾ï¼Œå¹¶ç»“åˆæ‰“åŒ…å™¨ç­¾åæ£€æµ‹ã€MITRE ATT&CKå’Œæ¶æ„è½¯ä»¶è¡Œä¸ºç›®å½•ï¼ˆMBCï¼‰çŸ¥è¯†ã€‚é€šè¿‡è¿™ç§é¢„å¤„ç†æ–¹æ³•è®­ç»ƒå¤§å‹è¯­è¨€æ¨¡å‹è¿›è¡Œæ¶æ„è½¯ä»¶åˆ†ç±»ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªå¤æ‚çš„æ•°æ®é›†ä¸Šå®ç°äº†0.94çš„åŠ æƒå¹³å‡F1åˆ†æ•°ï¼Œä»£è¡¨äº†å¸‚åœºç°å®ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šæœ¬æ–‡æ—¨åœ¨è§£å†³ç°æœ‰æ¶æ„è½¯ä»¶åˆ†ææ–¹æ³•ä¸­å¯¹ä¸“å®¶çŸ¥è¯†çš„å¿½è§†ï¼Œå¯¼è‡´åˆ†æç»“æœç¼ºä¹å¯è§£é‡Šæ€§å’Œå‡†ç¡®æ€§çš„é—®é¢˜ã€‚ç°æœ‰æ–¹æ³•ä¸»è¦é›†ä¸­åœ¨æ•°æ®è§†è§’ï¼Œæœªèƒ½æœ‰æ•ˆåˆ©ç”¨ä¸“å®¶çš„ç»éªŒå’ŒçŸ¥è¯†ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡æå‡ºäº†ä¸€ç§åŸºäºä¸“å®¶çŸ¥è¯†çš„é¢„å¤„ç†æ–¹æ³•ï¼Œæ—¨åœ¨é€šè¿‡ç”ŸæˆåŒ…å«é™æ€å’Œè¡Œä¸ºåˆ†æç‰¹å¾çš„JSONæŠ¥å‘Šï¼Œæå‡æ¶æ„è½¯ä»¶çš„è¯­ä¹‰åˆ†æèƒ½åŠ›ï¼Œä½¿å…¶æ›´æ˜“äºè¢«åˆ†æäººå‘˜ç†è§£ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šè¯¥æ–¹æ³•çš„æ•´ä½“æ¶æ„åŒ…æ‹¬æ•°æ®æ”¶é›†ã€ç‰¹å¾æå–ã€JSONæŠ¥å‘Šç”Ÿæˆå’Œæ¨¡å‹è®­ç»ƒå››ä¸ªä¸»è¦æ¨¡å—ã€‚é¦–å…ˆï¼Œæ”¶é›†å¯æ‰§è¡Œæ–‡ä»¶æ•°æ®ï¼Œç„¶åè¿›è¡Œé™æ€å’Œè¡Œä¸ºåˆ†æï¼Œæå–ç›¸å…³ç‰¹å¾ï¼Œæœ€åç”ŸæˆJSONæ ¼å¼çš„æŠ¥å‘Šï¼Œä¾›åç»­æ¨¡å‹è®­ç»ƒä½¿ç”¨ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°åœ¨äºå°†ä¸“å®¶çŸ¥è¯†ç³»ç»ŸåŒ–ï¼Œé€šè¿‡JSONæŠ¥å‘Šçš„å½¢å¼å°†å¤æ‚çš„åˆ†æç»“æœä»¥è¯­ä¹‰åŒ–çš„æ–¹å¼å‘ˆç°ï¼Œæ˜¾è‘—æå‡äº†æ¶æ„è½¯ä»¶åˆ†æçš„å¯è§£é‡Šæ€§å’Œå‡†ç¡®æ€§ã€‚è¿™ä¸ç°æœ‰æ–¹æ³•çš„ä¸»è¦åŒºåˆ«åœ¨äºå¼ºè°ƒäº†ä¸“å®¶è§†è§’çš„æ•´åˆã€‚

**å…³é”®è®¾è®¡**ï¼šåœ¨æŠ€æœ¯ç»†èŠ‚ä¸Šï¼ŒæŠ¥å‘Šä¸­åŒ…å«äº†æ‰“åŒ…å™¨ç­¾åæ£€æµ‹ã€MITRE ATT&CKæ¡†æ¶å’Œæ¶æ„è½¯ä»¶è¡Œä¸ºç›®å½•ï¼ˆMBCï¼‰çŸ¥è¯†ï¼Œç¡®ä¿äº†ç‰¹å¾çš„å…¨é¢æ€§å’Œå‡†ç¡®æ€§ã€‚æ­¤å¤–ï¼Œæ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­é‡‡ç”¨äº†åŠ æƒå¹³å‡F1åˆ†æ•°ä½œä¸ºè¯„ä¼°æŒ‡æ ‡ï¼Œä»¥ä¼˜åŒ–æ¨¡å‹æ€§èƒ½ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœæ˜¾ç¤ºï¼Œä½¿ç”¨è¯¥é¢„å¤„ç†æ–¹æ³•è®­ç»ƒçš„å¤§å‹è¯­è¨€æ¨¡å‹åœ¨å¤æ‚æ•°æ®é›†ä¸Šå®ç°äº†0.94çš„åŠ æƒå¹³å‡F1åˆ†æ•°ï¼Œæ˜¾è‘—é«˜äºä¼ ç»Ÿæ–¹æ³•çš„æ€§èƒ½ã€‚è¿™ä¸€ç»“æœè¡¨æ˜ï¼Œç»“åˆä¸“å®¶çŸ¥è¯†çš„é¢„å¤„ç†æ–¹æ³•åœ¨æ¶æ„è½¯ä»¶åˆ†ç±»ä¸­å…·æœ‰æ˜¾è‘—çš„ä¼˜åŠ¿ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶çš„æ½œåœ¨åº”ç”¨é¢†åŸŸåŒ…æ‹¬ç½‘ç»œå®‰å…¨ã€æ¶æ„è½¯ä»¶æ£€æµ‹å’Œä¿¡æ¯å®‰å…¨ç­‰ã€‚é€šè¿‡æä¾›æ›´å…·å¯è§£é‡Šæ€§çš„åˆ†æç»“æœï¼Œèƒ½å¤Ÿå¸®åŠ©å®‰å…¨ä¸“å®¶æ›´æœ‰æ•ˆåœ°è¯†åˆ«å’Œåº”å¯¹æ¶æ„è½¯ä»¶å¨èƒï¼Œæå‡æ•´ä½“å®‰å…¨é˜²æŠ¤èƒ½åŠ›ã€‚æœªæ¥ï¼Œè¯¥æ–¹æ³•è¿˜å¯æ‰©å±•è‡³å…¶ä»–ç±»å‹çš„æ¶æ„è½¯ä»¶åˆ†æå’Œå®‰å…¨é¢†åŸŸçš„åº”ç”¨ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> In a context of malware analysis, numerous approaches rely on Artificial Intelligence to handle a large volume of data. However, these techniques focus on data view (images, sequences) and not on an expert's view. Noticing this issue, we propose a preprocessing that focuses on expert knowledge to improve malware semantic analysis and result interpretability. We propose a new preprocessing method which creates JSON reports for Portable Executable files. These reports gather features from both static and behavioral analysis, and incorporate packer signature detection, MITRE ATT\&CK and Malware Behavior Catalog (MBC) knowledge. The purpose of this preprocessing is to gather a semantic representation of binary files, understandable by malware analysts, and that can enhance AI models' explainability for malicious files analysis. Using this preprocessing to train a Large Language Model for Malware classification, we achieve a weighted-average F1-score of 0.94 on a complex dataset, representative of market reality.

