---
layout: default
title: LightCode: Compiling LLM Inference for Photonic-Electronic Systems
---

# LightCode: Compiling LLM Inference for Photonic-Electronic Systems

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.16443" class="toolbar-btn" target="_blank">üìÑ arXiv: 2509.16443v1</a>
  <a href="https://arxiv.org/pdf/2509.16443.pdf" class="toolbar-btn" target="_blank">üì• PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.16443v1" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.16443v1', 'LightCode: Compiling LLM Inference for Photonic-Electronic Systems')" title="Ê∑ªÂä†Âà∞Êî∂ËóèÂ§π">‚òÜ Êî∂Ëóè</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">üîó ÂàÜ‰∫´</button>
</div>


**‰ΩúËÄÖ**: Ryan Tomich, Zhizhen Zhong, Dirk Englund

**ÂàÜÁ±ª**: physics.app-ph, cs.AI, cs.PL

**ÂèëÂ∏ÉÊó•Êúü**: 2025-09-19

**Â§áÊ≥®**: 9 pages, 8 figures

---

## üí° ‰∏ÄÂè•ËØùË¶ÅÁÇπ

**LightCodeÔºöÁî®‰∫éÂÖâÂ≠ê-ÁîµÂ≠êÁ≥ªÁªüÁöÑLLMÊé®ÁêÜÁºñËØëÊ°ÜÊû∂**

üéØ **ÂåπÈÖçÈ¢ÜÂüü**: **ÊîØÊü±‰πùÔºöÂÖ∑Ë∫´Â§ßÊ®°Âûã (Embodied Foundation Models)**

**ÂÖ≥ÈîÆËØç**: `ÂÖâÂ≠êËÆ°ÁÆó` `Â§ßÂûãËØ≠Ë®ÄÊ®°Âûã` `ÂºÇÊûÑËÆ°ÁÆó` `ÁºñËØë‰ºòÂåñ` `ËÉΩÊïà‰ºòÂåñ`

## üìã Ê†∏ÂøÉË¶ÅÁÇπ

1. Áé∞ÊúâGPUÂú®‰∏éÂÖâÂ≠êÂº†ÈáèÂçïÂÖÉÁ≠âÊñ∞ÂÖ¥Âä†ÈÄüÂô®ÈõÜÊàêÊñπÈù¢Â≠òÂú®‰∏çË∂≥ÔºåÊó†Ê≥ïÊª°Ë∂≥LLMÂØπ‰ΩéÂª∂Ëøü„ÄÅÈ´òËÉΩÊïàÊé®ÁêÜÁöÑÈúÄÊ±Ç„ÄÇ
2. LightCodeÊèêÂá∫‰∫Ü‰∏ÄÁßçÊ∑∑ÂêàÁºñËØëÁ≠ñÁï•ÔºåÈÄöËøáÂ†ÜÂè†ÂõæË°®Á§∫Âº†ÈáèÊìç‰ΩúÁöÑÂ§öÁßçÁ°¨‰ª∂ÂÆûÁé∞ÔºåÂπ∂‰ºòÂåñÁ°¨‰ª∂ÂàÜÈÖç„ÄÇ
3. ÂÆûÈ™åË°®ÊòéÔºåLightCodeÂú®GPT-2ÂíåLlama-7B‰∏äÔºåËÉΩÊòæËëóÈôç‰ΩéËÉΩËÄóÂπ∂ÊèêÂçáÊé®ÁêÜÈÄüÂ∫¶ÔºåÈ™åËØÅ‰∫ÜÂÖ∂ÊúâÊïàÊÄß„ÄÇ

## üìù ÊëòË¶ÅÔºà‰∏≠ÊñáÔºâ

ÈíàÂØπÂ§ßÂûãËØ≠Ë®ÄÊ®°ÂûãÔºàLLMÔºâÂØπ‰ΩéÂª∂Ëøü„ÄÅÈ´òËÉΩÊïàÊé®ÁêÜÊó•ÁõäÂ¢ûÈïøÁöÑÈúÄÊ±ÇÔºåÂºÇÊûÑÊû∂ÊûÑÁöÑÁ†îÁ©∂Â§áÂèóÂÖ≥Ê≥®„ÄÇËôΩÁÑ∂GPU‰ªçÁÑ∂Âç†ÊçÆ‰∏ªÂØºÂú∞‰ΩçÔºå‰ΩÜÂÆÉ‰ª¨‰∏çÈÄÇÂêà‰∏éÊñ∞ÂÖ¥ÁöÑÁâπÂÆöÈ¢ÜÂüüÂä†ÈÄüÂô®ÔºàÂ¶ÇÂÖâÂ≠êÂº†ÈáèÂçïÂÖÉÔºàPTUÔºâÔºâÈõÜÊàêÔºåÂêéËÄÖÊèê‰æõ‰ΩéÂäüËÄó„ÄÅÈ´òÂêûÂêêÈáèÁöÑÁ∫øÊÄßËÆ°ÁÆó„ÄÇËøô‰øÉ‰Ωø‰∫∫‰ª¨Á†îÁ©∂ÁªìÂêàÂÖâÂ≠êÂíåÁîµÂ≠êËµÑÊ∫êÁöÑÊ∑∑ÂêàÁºñËØëÁ≠ñÁï•„ÄÇÊàë‰ª¨ÊèêÂá∫‰∫ÜLightCodeÔºå‰∏Ä‰∏™Áî®‰∫éÂú®Ê∑∑ÂêàÂÖâÂ≠ê-ÁîµÂ≠êÁ≥ªÁªü‰∏äÊò†Â∞ÑLLMÊé®ÁêÜÂ∑•‰ΩúË¥üËΩΩÁöÑÁºñËØëÂô®Ê°ÜÊû∂ÂíåÊ®°ÊãüÂô®„ÄÇLightCodeÂºïÂÖ•‰∫ÜÂ†ÜÂè†ÂõæÔºå‰∏ÄÁßç‰∏≠Èó¥Ë°®Á§∫ÔºåÂÆÉÁºñÁ†Å‰∫ÜÊØè‰∏™Âº†ÈáèÊìç‰ΩúÁöÑÂ§ö‰∏™Á°¨‰ª∂ÁâπÂÆöÂÆûÁé∞„ÄÇÁ°¨‰ª∂ÂàÜÈÖçË¢´Ë°®Ëø∞‰∏∫‰∏Ä‰∏™Á∫¶ÊùüÂ≠êÂõæÈÄâÊã©ÈóÆÈ¢òÔºåËØ•ÈóÆÈ¢òÂú®ÂèÇÊï∞ÂåñÊàêÊú¨Ê®°Âûã‰∏ãÈíàÂØπÂª∂ËøüÊàñËÉΩÈáèËøõË°å‰ºòÂåñ„ÄÇÊàë‰ª¨ËØÑ‰º∞‰∫ÜLightCodeÂú®GPT-2ÂíåLlama-7BÁöÑÈ¢ÑÂ°´ÂÖÖÈò∂ÊÆµÁöÑË°®Áé∞ÔºåÁªìÊûúË°®ÊòéÔºåÂú®Êàë‰ª¨ÁöÑÂ∑•‰ΩúË¥üËΩΩÂíåÁ°¨‰ª∂ÂÅáËÆæ‰∏ãÔºå(i) Âú®Ê®°ÊãüÂ∑•‰ΩúË¥üËΩΩ‰∏≠ÔºåÂÖâÂ≠êÁ°¨‰ª∂Âú®ÊúÄÂ§ßÂ∫èÂàóÈïøÂ∫¶‰∏ãÈôç‰Ωé‰∫ÜÈ´òËææ50%ÁöÑËÉΩÈáèÔºõ(ii) Â§öË∑ØÂ§çÁî®ÂíåÂàÜÈÖçÁ≠ñÁï•‰∫ßÁîü‰∫ÜË∂ÖËøá10ÂÄçÁöÑÂª∂ËøüÊîπËøõÔºõ(iii) Âú®Êàë‰ª¨ÁöÑÊ®°Êãü‰∏≠ÔºåÈíàÂØπÂª∂ËøüÊàñËÉΩÈáèËøõË°å‰ºòÂåñÂØºËá¥‰∫Ü‰∏çÂêåÁöÑÁ°¨‰ª∂Êò†Â∞Ñ„ÄÇLightCode‰∏∫Â∞ÜLLMÁºñËØëÂà∞Êñ∞ÂÖ¥ÁöÑÂÖâÂ≠êÂä†ÈÄüÂô®Êèê‰æõ‰∫Ü‰∏Ä‰∏™Ê®°ÂùóÂåñ„ÄÅÂü∫Á°ÄÊÄßÁöÑÊ°ÜÊû∂ÂíåÊ®°ÊãüÂô®„ÄÇ

## üî¨ ÊñπÊ≥ïËØ¶Ëß£

**ÈóÆÈ¢òÂÆö‰πâ**ÔºöËÆ∫ÊñáÊó®Âú®Ëß£ÂÜ≥Â§ßÂûãËØ≠Ë®ÄÊ®°ÂûãÔºàLLMÔºâÂú®ÂºÇÊûÑÂÖâÂ≠ê-ÁîµÂ≠êÁ≥ªÁªü‰∏äÁöÑÈ´òÊïàÊé®ÁêÜÈóÆÈ¢ò„ÄÇÁé∞ÊúâÊñπÊ≥ïÔºåÁâπÂà´ÊòØ‰æùËµñGPUÁöÑÊñπÊ°àÔºåÂú®ËÉΩÊïàÂíåÂª∂ËøüÊñπÈù¢Â≠òÂú®Áì∂È¢àÔºåÊó†Ê≥ïÂÖÖÂàÜÂà©Áî®Êñ∞ÂÖ¥ÁöÑÂÖâÂ≠êËÆ°ÁÆóÂä†ÈÄüÂô®ÁöÑ‰ºòÂäø„ÄÇÂõ†Ê≠§ÔºåÂ¶Ç‰ΩïÊúâÊïàÂú∞Â∞ÜLLMËÆ°ÁÆó‰ªªÂä°Êò†Â∞ÑÂà∞Ê∑∑ÂêàÁöÑÂÖâÂ≠ê-ÁîµÂ≠êÁ°¨‰ª∂ËµÑÊ∫ê‰∏äÔºå‰ª•ÂÆûÁé∞Êõ¥‰ΩéÁöÑÂäüËÄóÂíåÊõ¥È´òÁöÑÂêûÂêêÈáèÔºåÊòØÊú¨Á†îÁ©∂Ë¶ÅËß£ÂÜ≥ÁöÑÊ†∏ÂøÉÈóÆÈ¢ò„ÄÇ

**Ê†∏ÂøÉÊÄùË∑Ø**ÔºöLightCodeÁöÑÊ†∏ÂøÉÊÄùË∑ØÊòØÊûÑÂª∫‰∏Ä‰∏™ÁºñËØëÂô®Ê°ÜÊû∂ÔºåËÉΩÂ§üÊÑüÁü•‰∏çÂêåÁ°¨‰ª∂ÔºàÂåÖÊã¨ÂÖâÂ≠êÂíåÁîµÂ≠êËÆæÂ§áÔºâÁöÑÁâπÊÄßÔºåÂπ∂Ê†πÊçÆÁªôÂÆöÁöÑ‰ºòÂåñÁõÆÊ†áÔºà‰æãÂ¶ÇÔºåÊúÄÂ∞èÂåñÂª∂ËøüÊàñËÉΩÈáèÊ∂àËÄóÔºâËá™Âä®Âú∞Â∞ÜLLMÁöÑËÆ°ÁÆóÂõæÊò†Â∞ÑÂà∞ÊúÄÂêàÈÄÇÁöÑÁ°¨‰ª∂ËµÑÊ∫ê‰∏ä„ÄÇËøôÁßçÊ∑∑ÂêàÁºñËØëÁ≠ñÁï•Êó®Âú®ÂÖÖÂàÜÂà©Áî®ÂÖâÂ≠êËÆ°ÁÆóÂú®ÁâπÂÆöÁ∫øÊÄß‰ª£Êï∞ËøêÁÆó‰∏äÁöÑ‰ºòÂäøÔºåÂêåÊó∂Âà©Áî®ÁîµÂ≠êËÆ°ÁÆóÂú®ÂÖ∂‰ªñÊìç‰Ωú‰∏äÁöÑÁÅµÊ¥ªÊÄß„ÄÇ

**ÊäÄÊúØÊ°ÜÊû∂**ÔºöLightCodeÁöÑÊäÄÊúØÊ°ÜÊû∂‰∏ªË¶ÅÂåÖÂê´‰ª•‰∏ãÂá†‰∏™ÂÖ≥ÈîÆÊ®°ÂùóÔºö1) **Â†ÜÂè†ÂõæÔºàStacked GraphÔºâ**Ôºö‰Ωú‰∏∫‰∏≠Èó¥Ë°®Á§∫ÔºåÂÆÉÂ∞ÜÊØè‰∏™Âº†ÈáèÊìç‰ΩúË°®Á§∫‰∏∫Â§ö‰∏™Á°¨‰ª∂ÁâπÂÆöÁöÑÂÆûÁé∞Ôºå‰ªéËÄåÂÖÅËÆ∏ÁºñËØëÂô®Âú®‰∏çÂêåÁöÑÁ°¨‰ª∂ÈÄâÈ°π‰πãÈó¥ËøõË°åÈÄâÊã©„ÄÇ2) **Á°¨‰ª∂ÂàÜÈÖçÂô®**ÔºöÂ∞ÜÁ°¨‰ª∂ÂàÜÈÖçÈóÆÈ¢òÂª∫Ê®°‰∏∫‰∏Ä‰∏™Á∫¶ÊùüÂ≠êÂõæÈÄâÊã©ÈóÆÈ¢òÔºåÂπ∂‰ΩøÁî®‰ºòÂåñÁÆóÊ≥ïÔºà‰æãÂ¶ÇÔºåÊï¥Êï∞Á∫øÊÄßËßÑÂàíÔºâÊù•ÊâæÂà∞Êª°Ë∂≥Á∫¶ÊùüÊù°‰ª∂Âπ∂ÊúÄÂ§ßÂåñÊÄßËÉΩÁöÑÁ°¨‰ª∂Êò†Â∞ÑÊñπÊ°à„ÄÇ3) **ÂèÇÊï∞ÂåñÊàêÊú¨Ê®°Âûã**ÔºöÁî®‰∫é‰º∞ËÆ°‰∏çÂêåÁ°¨‰ª∂ÈÖçÁΩÆ‰∏ãÁöÑÂª∂ËøüÂíåËÉΩÈáèÊ∂àËÄóÔºå‰∏∫Á°¨‰ª∂ÂàÜÈÖçÊèê‰æõ‰æùÊçÆ„ÄÇ4) **Ê®°ÊãüÂô®**ÔºöÁî®‰∫éÈ™åËØÅÁºñËØëÂêéÁöÑ‰ª£Á†ÅÂú®ÁõÆÊ†áÁ°¨‰ª∂‰∏äÁöÑÊÄßËÉΩ„ÄÇ

**ÂÖ≥ÈîÆÂàõÊñ∞**ÔºöLightCodeÁöÑÂÖ≥ÈîÆÂàõÊñ∞Âú®‰∫éÂÖ∂Ê∑∑ÂêàÁºñËØëÁ≠ñÁï•ÂíåÂ†ÜÂè†ÂõæÁöÑË°®Á§∫ÊñπÊ≥ï„ÄÇ‰º†ÁªüÁöÑÁºñËØëÂô®ÈÄöÂ∏∏ÈíàÂØπÂçï‰∏ÄÁ±ªÂûãÁöÑÁ°¨‰ª∂ËøõË°å‰ºòÂåñÔºåËÄåLightCodeËÉΩÂ§üÂêåÊó∂ËÄÉËôëÂÖâÂ≠êÂíåÁîµÂ≠êÁ°¨‰ª∂ÁöÑÁâπÊÄßÔºåÂπ∂Ê†πÊçÆ‰ºòÂåñÁõÆÊ†áÂä®ÊÄÅÂú∞ÈÄâÊã©ÊúÄÂêàÈÄÇÁöÑÁ°¨‰ª∂ËµÑÊ∫ê„ÄÇÂ†ÜÂè†ÂõæÂÖÅËÆ∏ÁºñËØëÂô®Êé¢Á¥¢‰∏çÂêåÁöÑÁ°¨‰ª∂Êò†Â∞ÑÊñπÊ°àÔºå‰ªéËÄåÂÆûÁé∞Êõ¥Â•ΩÁöÑÊÄßËÉΩ„ÄÇ

**ÂÖ≥ÈîÆËÆæËÆ°**ÔºöLightCodeÁöÑÂÖ≥ÈîÆËÆæËÆ°ÂåÖÊã¨Ôºö1) **Á°¨‰ª∂ÊàêÊú¨Ê®°ÂûãÁöÑÂèÇÊï∞Âåñ**ÔºöÊàêÊú¨Ê®°ÂûãÈúÄË¶ÅÂáÜÁ°ÆÂú∞ÂèçÊò†‰∏çÂêåÁ°¨‰ª∂ÁöÑÊÄßËÉΩÁâπÂæÅÔºå‰æãÂ¶ÇÔºåÂÖâÂ≠êËÆ°ÁÆóÁöÑÂª∂ËøüÂíåÂäüËÄó‰∏éÁü©ÈòµÂ§ßÂ∞èÁöÑÂÖ≥Á≥ª„ÄÇ2) **Á∫¶ÊùüÂ≠êÂõæÈÄâÊã©ÈóÆÈ¢òÁöÑÂª∫Ê®°**ÔºöÈúÄË¶ÅÂÆö‰πâÂêàÈÄÇÁöÑÁ∫¶ÊùüÊù°‰ª∂Ôºå‰ª•Á°Æ‰øùÁ°¨‰ª∂Êò†Â∞ÑÊñπÊ°àÁöÑÂèØË°åÊÄßÔºå‰æãÂ¶ÇÔºåÁ°¨‰ª∂ËµÑÊ∫êÁöÑÂÆπÈáèÈôêÂà∂ÂíåÊï∞ÊçÆ‰º†ËæìÁöÑÂ∏¶ÂÆΩÈôêÂà∂„ÄÇ3) **‰ºòÂåñÁÆóÊ≥ïÁöÑÈÄâÊã©**ÔºöÈúÄË¶ÅÈÄâÊã©È´òÊïàÁöÑ‰ºòÂåñÁÆóÊ≥ïÔºå‰ª•‰æøÂú®ÂêàÁêÜÁöÑÊó∂Èó¥ÂÜÖÊâæÂà∞ÊúÄ‰ºòÊàñËøë‰ººÊúÄ‰ºòÁöÑÁ°¨‰ª∂Êò†Â∞ÑÊñπÊ°à„ÄÇ

## üìä ÂÆûÈ™å‰∫ÆÁÇπ

ÂÆûÈ™åÁªìÊûúË°®ÊòéÔºåÂú®GPT-2ÂíåLlama-7BÁöÑÈ¢ÑÂ°´ÂÖÖÈò∂ÊÆµÔºåLightCodeÂú®Ê®°ÊãüÂ∑•‰ΩúË¥üËΩΩ‰∏≠ÔºåÂÖâÂ≠êÁ°¨‰ª∂Âú®ÊúÄÂ§ßÂ∫èÂàóÈïøÂ∫¶‰∏ãÈôç‰Ωé‰∫ÜÈ´òËææ50%ÁöÑËÉΩÈáèÊ∂àËÄó„ÄÇÊ≠§Â§ñÔºåÈÄöËøáÂ§öË∑ØÂ§çÁî®ÂíåÁ°¨‰ª∂ÂàÜÈÖçÁ≠ñÁï•ÔºåÂª∂ËøüÊîπËøõË∂ÖËøá10ÂÄç„ÄÇÈíàÂØπÂª∂ËøüÊàñËÉΩÈáèËøõË°å‰ºòÂåñ‰ºöÂØºËá¥‰∏çÂêåÁöÑÁ°¨‰ª∂Êò†Â∞ÑÊñπÊ°àÔºåË°®ÊòéLightCodeËÉΩÂ§üÊ†πÊçÆ‰∏çÂêåÁöÑ‰ºòÂåñÁõÆÊ†áËøõË°åÁÅµÊ¥ªÁöÑÁ°¨‰ª∂ËµÑÊ∫êÂàÜÈÖç„ÄÇ

## üéØ Â∫îÁî®Âú∫ÊôØ

LightCodeÁöÑÁ†îÁ©∂ÊàêÊûúÂèØÂ∫îÁî®‰∫éÂêÑÁßçÈúÄË¶Å‰ΩéÂª∂Ëøü„ÄÅÈ´òËÉΩÊïàLLMÊé®ÁêÜÁöÑÂú∫ÊôØÔºå‰æãÂ¶ÇËæπÁºòËÆ°ÁÆóËÆæÂ§á„ÄÅÁßªÂä®ËÆæÂ§áÂíåÊï∞ÊçÆ‰∏≠ÂøÉ„ÄÇÈÄöËøáÂ∞ÜLLMËÆ°ÁÆó‰ªªÂä°Âç∏ËΩΩÂà∞ÂÖâÂ≠êÂä†ÈÄüÂô®‰∏äÔºåÂèØ‰ª•ÊòæËëóÈôç‰ΩéÂäüËÄóÂπ∂ÊèêÈ´òÊé®ÁêÜÈÄüÂ∫¶Ôºå‰ªéËÄåÂÆûÁé∞Êõ¥È´òÊïàÁöÑAIÂ∫îÁî®„ÄÇËØ•Á†îÁ©∂‰πü‰∏∫Êú™Êù•ÂÖâÂ≠êËÆ°ÁÆóÂú®‰∫∫Â∑•Êô∫ËÉΩÈ¢ÜÂüüÁöÑÂ∫îÁî®Â•†ÂÆö‰∫ÜÂü∫Á°Ä„ÄÇ

## üìÑ ÊëòË¶ÅÔºàÂéüÊñáÔºâ

> The growing demand for low-latency, energy-efficient inference in large language models (LLMs) has catalyzed interest in heterogeneous architectures. While GPUs remain dominant, they are poorly suited for integration with emerging domain-specific accelerators like the Photonic Tensor Units (PTUs), which offer low-power, high-throughput linear computation. This motivates hybrid compilation strategies that combine photonic and electronic resources. We present LightCode, a compiler framework and simulator for mapping LLM inference workloads across hybrid photonic-electronic systems. LightCode introduces the Stacked Graph, an intermediate representation that encodes multiple hardware-specific realizations of each tensor operation. Hardware assignment is formulated as a constrained subgraph selection problem optimized for latency or energy under parametric cost models. We evaluate LightCode on the prefill stage of GPT-2 and Llama-7B showing that under our workload and hardware assumptions, (i) Photonic hardware reduced energy by up to 50% in our simulated workloads at maximum sequence length; (ii) multiplexing and assignment strategy yielded latency improvements exceeding 10x; and (iii) Optimizing for latency or energy resulted in distinct hardware mappings in our simulations. LightCode offers a module, foundational framework and simulator for compiling LLMs to emerging photonic accelerators.

