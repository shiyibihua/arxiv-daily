---
layout: default
title: VISION: Robust and Interpretable Code Vulnerability Detection Leveraging Counterfactual Augmentation
---

# VISION: Robust and Interpretable Code Vulnerability Detection Leveraging Counterfactual Augmentation

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2508.18933" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2508.18933v1</a>
  <a href="https://arxiv.org/pdf/2508.18933.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2508.18933v1" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2508.18933v1', 'VISION: Robust and Interpretable Code Vulnerability Detection Leveraging Counterfactual Augmentation')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: David Egea, Barproda Halder, Sanghamitra Dutta

**åˆ†ç±»**: cs.AI, cs.CR, cs.CY, cs.LG

**å‘å¸ƒæ—¥æœŸ**: 2025-08-26

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºVISIONæ¡†æ¶ä»¥è§£å†³ä»£ç æ¼æ´æ£€æµ‹ä¸­çš„è™šå‡ç›¸å…³æ€§é—®é¢˜**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¹ï¼šå…·èº«å¤§æ¨¡å‹ (Embodied Foundation Models)**

**å…³é”®è¯**: `ä»£ç æ¼æ´æ£€æµ‹` `å›¾ç¥ç»ç½‘ç»œ` `åäº‹å®å¢å¼º` `ç½‘ç»œå®‰å…¨` `å¯è§£é‡Šæ€§AI` `æœºå™¨å­¦ä¹ ` `è‡ªåŠ¨åŒ–å®¡æŸ¥`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰çš„å›¾ç¥ç»ç½‘ç»œåœ¨ä»£ç æ¼æ´æ£€æµ‹ä¸­å—åˆ°è®­ç»ƒæ•°æ®ä¸å¹³è¡¡å’Œæ ‡ç­¾å™ªå£°çš„å½±å“ï¼Œå¯¼è‡´æ¨¡å‹å­¦ä¹ åˆ°è™šå‡ç›¸å…³æ€§ï¼Œæ— æ³•æœ‰æ•ˆæ³›åŒ–åˆ°çœŸå®åœºæ™¯ã€‚
2. æœ¬æ–‡æå‡ºçš„VISIONæ¡†æ¶é€šè¿‡ç”Ÿæˆåäº‹å®æ ·æœ¬æ¥å¢å¼ºè®­ç»ƒæ•°æ®ï¼Œç»“åˆå›¾ç¥ç»ç½‘ç»œè¿›è¡Œé’ˆå¯¹æ€§è®­ç»ƒï¼Œä»è€Œæé«˜æ¼æ´æ£€æµ‹çš„é²æ£’æ€§å’Œå¯è§£é‡Šæ€§ã€‚
3. å®éªŒç»“æœæ˜¾ç¤ºï¼ŒVISIONåœ¨CWE-20æ¼æ´æ£€æµ‹ä»»åŠ¡ä¸­ï¼Œæ•´ä½“å‡†ç¡®ç‡ä»51.8%æå‡è‡³97.8%ï¼Œå¯¹æ¯”å‡†ç¡®ç‡ä»4.5%æå‡è‡³95.8%ï¼Œè¡¨ç°å‡ºæ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

è‡ªåŠ¨æ£€æµ‹æºä»£ç ä¸­çš„æ¼æ´æ˜¯ç½‘ç»œå®‰å…¨é¢†åŸŸçš„é‡è¦æŒ‘æˆ˜ï¼Œç›´æ¥å½±å“æ•°å­—ç³»ç»Ÿå’ŒæœåŠ¡çš„ä¿¡ä»»åº¦ã€‚å›¾ç¥ç»ç½‘ç»œï¼ˆGNNï¼‰å› å…¶èƒ½å¤Ÿå­¦ä¹ ä»£ç çš„ç»“æ„å’Œé€»è¾‘å…³ç³»è€Œå—åˆ°å…³æ³¨ï¼Œä½†å…¶æ€§èƒ½å—åˆ°è®­ç»ƒæ•°æ®ä¸å¹³è¡¡å’Œæ ‡ç­¾å™ªå£°çš„ä¸¥é‡åˆ¶çº¦ã€‚æœ¬æ–‡æå‡ºäº†ä¸€ç§åä¸ºVISIONçš„ç»Ÿä¸€æ¡†æ¶ï¼Œé€šè¿‡ç³»ç»Ÿæ€§å¢å¼ºåäº‹å®è®­ç»ƒæ•°æ®é›†æ¥å‡è½»è™šå‡ç›¸å…³æ€§ã€‚è¯¥æ¡†æ¶åŒ…æ‹¬ç”Ÿæˆåäº‹å®æ ·æœ¬ã€é’ˆå¯¹æˆå¯¹ä»£ç ç¤ºä¾‹çš„GNNè®­ç»ƒä»¥åŠåŸºäºå›¾çš„å¯è§£é‡Šæ€§åˆ†æã€‚å®éªŒç»“æœè¡¨æ˜ï¼ŒVISIONæ˜¾è‘—æé«˜äº†æ¼æ´æ£€æµ‹çš„å‡†ç¡®æ€§å’Œå¯è§£é‡Šæ€§ï¼Œæ¨åŠ¨äº†åŸºäºAIçš„ç½‘ç»œå®‰å…¨ç³»ç»Ÿçš„é€æ˜æ€§å’Œå¯ä¿¡åº¦ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šæœ¬æ–‡æ—¨åœ¨è§£å†³ç°æœ‰ä»£ç æ¼æ´æ£€æµ‹æ–¹æ³•ä¸­ç”±äºè®­ç»ƒæ•°æ®ä¸å¹³è¡¡å’Œæ ‡ç­¾å™ªå£°å¯¼è‡´çš„è™šå‡ç›¸å…³æ€§é—®é¢˜ã€‚è¿™äº›é—®é¢˜ä½¿å¾—æ¨¡å‹åœ¨é¢å¯¹æœªè§è¿‡çš„çœŸå®æ•°æ®æ—¶ï¼Œæ³›åŒ–èƒ½åŠ›ä¸è¶³ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šVISIONæ¡†æ¶çš„æ ¸å¿ƒæ€è·¯æ˜¯é€šè¿‡ç”Ÿæˆåäº‹å®æ ·æœ¬æ¥å¢å¼ºè®­ç»ƒæ•°æ®ï¼Œåäº‹å®æ ·æœ¬æ˜¯å¯¹åŸå§‹æ ·æœ¬è¿›è¡Œæœ€å°è¯­ä¹‰ä¿®æ”¹ä½†æ ‡ç­¾ç›¸åçš„æ ·æœ¬ï¼Œä»è€Œå¸®åŠ©æ¨¡å‹å­¦ä¹ æ›´ä¸ºç¨³å¥çš„ç‰¹å¾ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šè¯¥æ¡†æ¶åŒ…æ‹¬ä¸‰ä¸ªä¸»è¦æ¨¡å—ï¼šé¦–å…ˆï¼Œåˆ©ç”¨å¤§å‹è¯­è¨€æ¨¡å‹ç”Ÿæˆåäº‹å®æ ·æœ¬ï¼›å…¶æ¬¡ï¼Œé’ˆå¯¹æˆå¯¹çš„ä»£ç ç¤ºä¾‹è¿›è¡Œå›¾ç¥ç»ç½‘ç»œçš„è®­ç»ƒï¼›æœ€åï¼Œé€šè¿‡å›¾ç»“æ„çš„å¯è§£é‡Šæ€§åˆ†æï¼Œè¯†åˆ«ä¸æ¼æ´é¢„æµ‹ç›¸å…³çš„é‡è¦ä»£ç è¯­å¥ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°åœ¨äºå¼•å…¥åäº‹å®æ ·æœ¬ç”Ÿæˆæœºåˆ¶ï¼Œç³»ç»Ÿæ€§åœ°å‡å°‘äº†æ¨¡å‹å­¦ä¹ åˆ°çš„è™šå‡ç›¸å…³æ€§ã€‚è¿™ä¸€æ–¹æ³•ä¸ä¼ ç»Ÿçš„è®­ç»ƒæ–¹å¼æœ‰æœ¬è´¨åŒºåˆ«ï¼Œåè€…å¾€å¾€ä¾èµ–äºåŸå§‹æ•°æ®çš„ç›´æ¥ç‰¹å¾ã€‚

**å…³é”®è®¾è®¡**ï¼šåœ¨æ¨¡å‹è®¾è®¡ä¸­ï¼Œé‡‡ç”¨äº†ç‰¹å®šçš„æŸå¤±å‡½æ•°æ¥å¹³è¡¡æ­£è´Ÿæ ·æœ¬çš„å½±å“ï¼Œå¹¶é€šè¿‡å›¾ç¥ç»ç½‘ç»œçš„ç»“æ„è®¾è®¡æ¥å¢å¼ºæ¨¡å‹å¯¹é‡è¦ç‰¹å¾çš„å…³æ³¨ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼ŒVISIONåœ¨CWE-20æ¼æ´æ£€æµ‹ä»»åŠ¡ä¸­çš„æ•´ä½“å‡†ç¡®ç‡ä»51.8%æå‡è‡³97.8%ï¼Œå¯¹æ¯”å‡†ç¡®ç‡ä»4.5%æå‡è‡³95.8%ï¼Œæœ€å·®ç»„å‡†ç¡®ç‡ä»0.7%æå‡è‡³85.5%ã€‚è¿™äº›æ˜¾è‘—çš„æå‡å±•ç¤ºäº†è¯¥æ¡†æ¶åœ¨å‡å°‘è™šå‡å­¦ä¹ å’Œå¢å¼ºæ£€æµ‹é²æ£’æ€§æ–¹é¢çš„æœ‰æ•ˆæ€§ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶çš„æ½œåœ¨åº”ç”¨é¢†åŸŸåŒ…æ‹¬è½¯ä»¶å®‰å…¨æ€§åˆ†æã€è‡ªåŠ¨åŒ–ä»£ç å®¡æŸ¥å’Œæ¼æ´æ£€æµ‹å·¥å…·çš„å¼€å‘ã€‚é€šè¿‡æé«˜æ¼æ´æ£€æµ‹çš„å‡†ç¡®æ€§å’Œå¯è§£é‡Šæ€§ï¼ŒVISIONèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…æ›´æœ‰æ•ˆåœ°è¯†åˆ«å’Œä¿®å¤ä»£ç ä¸­çš„å®‰å…¨æ¼æ´ï¼Œè¿›è€Œæå‡è½¯ä»¶ç³»ç»Ÿçš„æ•´ä½“å®‰å…¨æ€§ã€‚æœªæ¥ï¼Œéšç€AIæŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œè¯¥æ¡†æ¶æœ‰æœ›åœ¨æ›´å¹¿æ³›çš„ç½‘ç»œå®‰å…¨é¢†åŸŸä¸­å‘æŒ¥é‡è¦ä½œç”¨ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Automated detection of vulnerabilities in source code is an essential cybersecurity challenge, underpinning trust in digital systems and services. Graph Neural Networks (GNNs) have emerged as a promising approach as they can learn structural and logical code relationships in a data-driven manner. However, their performance is severely constrained by training data imbalances and label noise. GNNs often learn 'spurious' correlations from superficial code similarities, producing detectors that fail to generalize well to unseen real-world data. In this work, we propose a unified framework for robust and interpretable vulnerability detection, called VISION, to mitigate spurious correlations by systematically augmenting a counterfactual training dataset. Counterfactuals are samples with minimal semantic modifications but opposite labels. Our framework includes: (i) generating counterfactuals by prompting a Large Language Model (LLM); (ii) targeted GNN training on paired code examples with opposite labels; and (iii) graph-based interpretability to identify the crucial code statements relevant for vulnerability predictions while ignoring spurious ones. We find that VISION reduces spurious learning and enables more robust, generalizable detection, improving overall accuracy (from 51.8% to 97.8%), pairwise contrast accuracy (from 4.5% to 95.8%), and worst-group accuracy (from 0.7% to 85.5%) on the Common Weakness Enumeration (CWE)-20 vulnerability. We further demonstrate gains using proposed metrics: intra-class attribution variance, inter-class attribution distance, and node score dependency. We also release CWE-20-CFA, a benchmark of 27,556 functions (real and counterfactual) from the high-impact CWE-20 category. Finally, VISION advances transparent and trustworthy AI-based cybersecurity systems through interactive visualization for human-in-the-loop analysis.

