---
layout: default
title: RADAR: Accelerating Large Language Model Inference With RL-Based Dynamic Draft Trees
---

# RADAR: Accelerating Large Language Model Inference With RL-Based Dynamic Draft Trees

**arXiv**: [2512.14069v1](https://arxiv.org/abs/2512.14069) | [PDF](https://arxiv.org/pdf/2512.14069.pdf)

**ä½œè€…**: Junjie Ma, Jinlong Li

**åˆ†ç±»**: cs.AI

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

**å¤‡æ³¨**: 5 pages, 2 figures

**ğŸ”— ä»£ç /é¡¹ç›®**: [GITHUB](https://github.com/minaduki-sora/RADAR)

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

<<<<<<< HEAD
**æå‡ºåŸºäºå¼ºåŒ–å­¦ä¹ çš„åŠ¨æ€è‰ç¨¿æ ‘æ–¹æ³•RADARï¼Œä»¥åŠ é€Ÿå¤§è¯­è¨€æ¨¡å‹æ¨ç†è¿‡ç¨‹**
=======
**æå‡ºRADARæ–¹æ³•ï¼ŒåŸºäºå¼ºåŒ–å­¦ä¹ çš„åŠ¨æ€è‰ç¨¿æ ‘åŠ é€Ÿå¤§è¯­è¨€æ¨¡å‹æ¨ç†**
>>>>>>> 1c05e1c356e1f28c2e5e6e14cf6811c0d5120ab7

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **å¼ºåŒ–å­¦ä¹ **

**å…³é”®è¯**: `å¤§è¯­è¨€æ¨¡å‹æ¨ç†åŠ é€Ÿ` `æ¨æµ‹é‡‡æ ·` `å¼ºåŒ–å­¦ä¹ ` `åŠ¨æ€è‰ç¨¿æ ‘` `é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹` `ç¦»çº¿å¼ºåŒ–å­¦ä¹ ` `è®¡ç®—ä¼˜åŒ–` `å®æ—¶å†³ç­–`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰æ¨æµ‹é‡‡æ ·æ–¹æ³•ä¸­è‰ç¨¿æ¨¡å‹è°ƒç”¨æ¬¡æ•°å›ºå®šï¼Œç¼ºä¹çµæ´»æ€§ï¼Œå¯¼è‡´è®¡ç®—å†—ä½™å’Œæ•ˆç‡ä½ä¸‹ã€‚
2. RADARå°†è‰ç¨¿æ ‘ç”Ÿæˆå»ºæ¨¡ä¸ºMDPï¼Œåˆ©ç”¨ç¦»çº¿å¼ºåŒ–å­¦ä¹ è®­ç»ƒé¢„æµ‹æ¨¡å‹ï¼ŒåŠ¨æ€å†³å®šè‰ç¨¿æ¨¡å‹è°ƒç”¨ã€‚
<<<<<<< HEAD
3. å®éªŒæ˜¾ç¤ºRADARåœ¨å¤šä¸ªLLMå’Œä»»åŠ¡ä¸Šå®ç°3.17x-4.82xåŠ é€Ÿï¼Œæ˜¾è‘—æå‡æ¨ç†æ•ˆç‡ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

ç°ä»£å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„æ¨ç†è¿‡ç¨‹æˆæœ¬é«˜æ˜‚ä¸”é€Ÿåº¦ç¼“æ…¢ï¼Œæ¨æµ‹é‡‡æ ·å·²æˆä¸ºè§£å†³æ­¤é—®é¢˜çš„æœ‰æ•ˆæ–¹æ¡ˆã€‚ç„¶è€Œï¼Œæ¨æµ‹é‡‡æ ·ä¸­ç”¨äºç”Ÿæˆå€™é€‰æ ‡è®°çš„è‰ç¨¿æ¨¡å‹è°ƒç”¨æ¬¡æ•°æ˜¯ä¸€ä¸ªé¢„è®¾çš„è¶…å‚æ•°ï¼Œç¼ºä¹çµæ´»æ€§ã€‚ä¸ºäº†æ›´æœ‰æ•ˆåœ°ç”Ÿæˆå’Œåˆ©ç”¨å€™é€‰æ ‡è®°ï¼Œæˆ‘ä»¬æå‡ºäº†RADARï¼Œä¸€ç§åŸºäºå¼ºåŒ–å­¦ä¹ åŠ¨æ€è‰ç¨¿æ ‘çš„æ–°å‹æ¨æµ‹é‡‡æ ·æ–¹æ³•ã€‚RADARå°†è‰ç¨¿æ ‘ç”Ÿæˆè¿‡ç¨‹å»ºæ¨¡ä¸ºé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆMDPï¼‰ï¼Œå¹¶é‡‡ç”¨ç¦»çº¿å¼ºåŒ–å­¦ä¹ è®­ç»ƒé¢„æµ‹æ¨¡å‹ï¼Œä»è€Œå®ç°å¯¹è‰ç¨¿æ¨¡å‹è°ƒç”¨çš„å®æ—¶å†³ç­–ï¼Œå‡å°‘å†—ä½™è®¡ç®—å¹¶è¿›ä¸€æ­¥åŠ é€Ÿæ¨ç†ã€‚åœ¨ä¸‰ä¸ªLLMå’Œå››ä¸ªä»»åŠ¡ä¸Šçš„è¯„ä¼°è¡¨æ˜ï¼ŒRADARç›¸æ¯”è‡ªå›å½’è§£ç åŸºçº¿å®ç°äº†3.17å€è‡³4.82å€çš„åŠ é€Ÿã€‚ä»£ç å¯åœ¨https://github.com/minaduki-sora/RADARè·å–ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³å¤§è¯­è¨€æ¨¡å‹æ¨ç†é€Ÿåº¦æ…¢ã€æˆæœ¬é«˜çš„é—®é¢˜ã€‚ç°æœ‰æ¨æµ‹é‡‡æ ·æ–¹æ³•é€šè¿‡è‰ç¨¿æ¨¡å‹ç”Ÿæˆå€™é€‰æ ‡è®°æ¥åŠ é€Ÿæ¨ç†ï¼Œä½†è‰ç¨¿æ¨¡å‹è°ƒç”¨æ¬¡æ•°æ˜¯é¢„è®¾è¶…å‚æ•°ï¼Œç¼ºä¹åŠ¨æ€è°ƒæ•´èƒ½åŠ›ï¼Œå¯¼è‡´è®¡ç®—å†—ä½™å’Œæ•ˆç‡ä½ä¸‹ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡æå‡ºå°†è‰ç¨¿æ ‘ç”Ÿæˆè¿‡ç¨‹å»ºæ¨¡ä¸ºé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆMDPï¼‰ï¼Œåˆ©ç”¨ç¦»çº¿å¼ºåŒ–å­¦ä¹ è®­ç»ƒé¢„æµ‹æ¨¡å‹ï¼Œå®æ—¶å†³ç­–è‰ç¨¿æ¨¡å‹è°ƒç”¨ï¼Œä»è€ŒåŠ¨æ€ç”Ÿæˆè‰ç¨¿æ ‘ï¼Œå‡å°‘å†—ä½™è®¡ç®—ï¼Œä¼˜åŒ–æ¨ç†æ•ˆç‡ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šRADARçš„æ•´ä½“æ¶æ„åŒ…æ‹¬è‰ç¨¿æ¨¡å‹ã€ç›®æ ‡æ¨¡å‹å’Œå¼ºåŒ–å­¦ä¹ é¢„æµ‹æ¨¡å‹ã€‚æµç¨‹åˆ†ä¸ºç¦»çº¿è®­ç»ƒå’Œåœ¨çº¿æ¨ç†ä¸¤ä¸ªé˜¶æ®µï¼šç¦»çº¿é˜¶æ®µä½¿ç”¨å†å²æ•°æ®è®­ç»ƒé¢„æµ‹æ¨¡å‹ï¼Œå­¦ä¹ è‰ç¨¿æ ‘ç”Ÿæˆç­–ç•¥ï¼›åœ¨çº¿é˜¶æ®µæ ¹æ®é¢„æµ‹æ¨¡å‹åŠ¨æ€å†³å®šè‰ç¨¿æ¨¡å‹è°ƒç”¨ï¼Œç”Ÿæˆå€™é€‰æ ‡è®°åºåˆ—ï¼Œå¹¶é€šè¿‡ç›®æ ‡æ¨¡å‹éªŒè¯å’Œæ¥å—æœ‰æ•ˆæ ‡è®°ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°æ˜¯å°†è‰ç¨¿æ ‘ç”Ÿæˆè¿‡ç¨‹å½¢å¼åŒ–ä¸ºMDPï¼Œå¹¶å¼•å…¥ç¦»çº¿å¼ºåŒ–å­¦ä¹ è¿›è¡ŒåŠ¨æ€å†³ç­–ã€‚ä¸ç°æœ‰æ¨æµ‹é‡‡æ ·æ–¹æ³•çš„æœ¬è´¨åŒºåˆ«åœ¨äºï¼ŒRADARä¸å†ä¾èµ–å›ºå®šè°ƒç”¨æ¬¡æ•°ï¼Œè€Œæ˜¯æ ¹æ®ä¸Šä¸‹æ–‡å®æ—¶è°ƒæ•´è‰ç¨¿æ¨¡å‹è°ƒç”¨ï¼Œå®ç°æ›´çµæ´»çš„å€™é€‰æ ‡è®°ç”Ÿæˆã€‚

**å…³é”®è®¾è®¡**ï¼šå…³é”®è®¾è®¡åŒ…æ‹¬ï¼šå°†è‰ç¨¿æ ‘ç”ŸæˆçŠ¶æ€å®šä¹‰ä¸ºå½“å‰ä¸Šä¸‹æ–‡å’Œå·²ç”Ÿæˆæ ‡è®°ï¼ŒåŠ¨ä½œå®šä¹‰ä¸ºæ˜¯å¦è°ƒç”¨è‰ç¨¿æ¨¡å‹ï¼Œå¥–åŠ±å‡½æ•°åŸºäºåŠ é€Ÿæ¯”å’Œè®¡ç®—æˆæœ¬ï¼›ä½¿ç”¨ç¦»çº¿å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼ˆå¦‚ä¿å®ˆQå­¦ä¹ ï¼‰è®­ç»ƒé¢„æµ‹æ¨¡å‹ï¼Œé¿å…åœ¨çº¿æ¢ç´¢å¼€é”€ï¼›ç½‘ç»œç»“æ„å¯èƒ½åŸºäºTransformeræˆ–MLPï¼Œå…·ä½“ç»†èŠ‚æœªçŸ¥ï¼Œéœ€å‚è€ƒä»£ç å®ç°ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

RADARåœ¨ä¸‰ä¸ªå¤§è¯­è¨€æ¨¡å‹å’Œå››ä¸ªä»»åŠ¡ä¸Šçš„è¯„ä¼°æ˜¾ç¤ºï¼Œç›¸æ¯”è‡ªå›å½’è§£ç åŸºçº¿ï¼Œå®ç°äº†3.17å€è‡³4.82å€çš„åŠ é€Ÿã€‚å…·ä½“æ€§èƒ½æ•°æ®è¡¨æ˜ï¼Œè¯¥æ–¹æ³•åœ¨ä¸åŒæ¨¡å‹è§„æ¨¡ï¼ˆå¦‚GPT-3å˜ä½“ï¼‰å’Œä»»åŠ¡ï¼ˆå¦‚æ–‡æœ¬ç”Ÿæˆã€é—®ç­”ï¼‰ä¸Šå‡ä¿æŒé«˜æ•ˆï¼Œæå‡å¹…åº¦æ˜¾è‘—ï¼ŒéªŒè¯äº†åŠ¨æ€è‰ç¨¿æ ‘çš„æœ‰æ•ˆæ€§ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

RADARå¯å¹¿æ³›åº”ç”¨äºéœ€è¦é«˜æ•ˆå¤§è¯­è¨€æ¨¡å‹æ¨ç†çš„åœºæ™¯ï¼Œå¦‚èŠå¤©æœºå™¨äººã€ä»£ç ç”Ÿæˆã€æ–‡æœ¬æ‘˜è¦å’Œæœºå™¨ç¿»è¯‘ç­‰ã€‚å…¶å®é™…ä»·å€¼åœ¨äºæ˜¾è‘—é™ä½æ¨ç†å»¶è¿Ÿå’Œè®¡ç®—æˆæœ¬ï¼Œæå‡ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿååé‡ã€‚æœªæ¥å¯èƒ½å½±å“è¾¹ç¼˜è®¡ç®—å’Œå®æ—¶AIåº”ç”¨ï¼Œæ¨åŠ¨LLMåœ¨èµ„æºå—é™ç¯å¢ƒä¸­çš„éƒ¨ç½²ã€‚
=======
3. å®éªŒæ˜¾ç¤ºRADARåœ¨å¤šä¸ªLLMå’Œä»»åŠ¡ä¸Šå®ç°3.17-4.82å€åŠ é€Ÿï¼Œæ˜¾è‘—æå‡æ¨ç†æ•ˆç‡ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

ç°ä»£å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰çš„æ¨ç†è¿‡ç¨‹æˆæœ¬é«˜æ˜‚ä¸”é€Ÿåº¦ç¼“æ…¢ï¼Œæ¨æµ‹é‡‡æ ·å·²æˆä¸ºè§£å†³æ­¤é—®é¢˜çš„æœ‰æ•ˆæ–¹æ¡ˆã€‚ç„¶è€Œï¼Œæ¨æµ‹é‡‡æ ·ä¸­ç”¨äºç”Ÿæˆå€™é€‰æ ‡è®°çš„è‰ç¨¿æ¨¡å‹è°ƒç”¨æ¬¡æ•°æ˜¯ä¸€ä¸ªé¢„è®¾çš„è¶…å‚æ•°ï¼Œç¼ºä¹çµæ´»æ€§ã€‚ä¸ºäº†æ›´æœ‰æ•ˆåœ°ç”Ÿæˆå’Œåˆ©ç”¨å€™é€‰æ ‡è®°ï¼Œæˆ‘ä»¬æå‡ºäº†RADARï¼Œè¿™æ˜¯ä¸€ç§åŸºäºå¼ºåŒ–å­¦ä¹ åŠ¨æ€è‰ç¨¿æ ‘çš„æ–°å‹æ¨æµ‹é‡‡æ ·æ–¹æ³•ã€‚RADARå°†è‰ç¨¿æ ‘ç”Ÿæˆè¿‡ç¨‹å»ºæ¨¡ä¸ºé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆMDPï¼‰ï¼Œå¹¶é‡‡ç”¨ç¦»çº¿å¼ºåŒ–å­¦ä¹ è®­ç»ƒé¢„æµ‹æ¨¡å‹ï¼Œä»è€Œå®ç°å¯¹è‰ç¨¿æ¨¡å‹è°ƒç”¨çš„å®æ—¶å†³ç­–ï¼Œå‡å°‘å†—ä½™è®¡ç®—å¹¶è¿›ä¸€æ­¥åŠ é€Ÿæ¨ç†ã€‚åœ¨ä¸‰ä¸ªLLMå’Œå››ä¸ªä»»åŠ¡ä¸Šçš„è¯„ä¼°è¡¨æ˜ï¼ŒRADARç›¸æ¯”è‡ªå›å½’è§£ç åŸºçº¿å®ç°äº†3.17å€è‡³4.82å€çš„åŠ é€Ÿã€‚ä»£ç å¯åœ¨https://github.com/minaduki-sora/RADARè·å–ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

RADARçš„æ•´ä½“æ¡†æ¶æ˜¯åŸºäºæ¨æµ‹é‡‡æ ·çš„æ”¹è¿›æ–¹æ³•ï¼Œæ ¸å¿ƒåˆ›æ–°åœ¨äºå¼•å…¥åŠ¨æ€è‰ç¨¿æ ‘ç”Ÿæˆæœºåˆ¶ã€‚è¯¥æ–¹æ³•å°†è‰ç¨¿æ ‘ç”Ÿæˆè¿‡ç¨‹å½¢å¼åŒ–ä¸ºé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆMDPï¼‰ï¼Œå…¶ä¸­çŠ¶æ€åŒ…æ‹¬å½“å‰ä¸Šä¸‹æ–‡å’Œå€™é€‰æ ‡è®°ï¼ŒåŠ¨ä½œæ˜¯å†³å®šæ˜¯å¦ç»§ç»­è°ƒç”¨è‰ç¨¿æ¨¡å‹ç”Ÿæˆæ›´å¤šå€™é€‰æ ‡è®°ã€‚é€šè¿‡ç¦»çº¿å¼ºåŒ–å­¦ä¹ è®­ç»ƒä¸€ä¸ªé¢„æµ‹æ¨¡å‹ï¼Œè¯¥æ¨¡å‹èƒ½å¤Ÿå®æ—¶è¯„ä¼°æ¯ä¸ªå†³ç­–ç‚¹çš„ä»·å€¼ï¼Œä»è€ŒåŠ¨æ€è°ƒæ•´è‰ç¨¿æ ‘çš„æ·±åº¦å’Œç»“æ„ï¼Œå‡å°‘ä¸å¿…è¦çš„è‰ç¨¿æ¨¡å‹è°ƒç”¨ã€‚ä¸ç°æœ‰æ¨æµ‹é‡‡æ ·æ–¹æ³•çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼Œä¼ ç»Ÿæ–¹æ³•ä½¿ç”¨å›ºå®šæ¬¡æ•°çš„è‰ç¨¿æ¨¡å‹è°ƒç”¨ï¼ˆå³é™æ€è‰ç¨¿æ ‘ï¼‰ï¼Œè€ŒRADARé€šè¿‡å¼ºåŒ–å­¦ä¹ å®ç°è‡ªé€‚åº”å†³ç­–ï¼Œä¼˜åŒ–è®¡ç®—èµ„æºåˆ†é…ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

åœ¨ä¸‰ä¸ªå¤§è¯­è¨€æ¨¡å‹å’Œå››ä¸ªä»»åŠ¡ä¸Šçš„è¯„ä¼°ä¸­ï¼ŒRADARç›¸æ¯”è‡ªå›å½’è§£ç åŸºçº¿å®ç°äº†3.17å€è‡³4.82å€çš„åŠ é€Ÿï¼Œæ˜¾è‘—è¶…è¶Šä¼ ç»Ÿæ¨æµ‹é‡‡æ ·æ–¹æ³•ï¼Œè¯æ˜äº†åŠ¨æ€è‰ç¨¿æ ‘åœ¨å‡å°‘å†—ä½™è®¡ç®—å’Œæå‡æ¨ç†æ•ˆç‡æ–¹é¢çš„æœ‰æ•ˆæ€§ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

RADARå¯å¹¿æ³›åº”ç”¨äºéœ€è¦é«˜æ•ˆLLMæ¨ç†çš„åœºæ™¯ï¼Œå¦‚å®æ—¶å¯¹è¯ç³»ç»Ÿã€ä»£ç ç”Ÿæˆã€æ–‡æœ¬æ‘˜è¦å’Œæœºå™¨ç¿»è¯‘ç­‰ã€‚å…¶åŠ¨æ€å†³ç­–æœºåˆ¶èƒ½é™ä½è®¡ç®—æˆæœ¬ï¼Œæå‡å“åº”é€Ÿåº¦ï¼Œé€‚ç”¨äºäº‘æœåŠ¡å’Œè¾¹ç¼˜è®¾å¤‡éƒ¨ç½²ï¼Œå…·æœ‰å®é™…å•†ä¸šä»·å€¼ã€‚
>>>>>>> 1c05e1c356e1f28c2e5e6e14cf6811c0d5120ab7

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Inference with modern Large Language Models (LLMs) is expensive and slow, and speculative sampling has emerged as an effective solution to this problem, however, the number of the calls to the draft model for generating candidate tokens in speculative sampling is a preset hyperparameter, lacking flexibility. To generate and utilize the candidate tokens more effectively, we propose RADAR, a novel speculative sampling method with RL-based dynamic draft trees. RADAR formulates the draft tree generation process as a Markov Decision Process (MDP) and employs offline reinforcement learning to train a prediction model, which enables real-time decision on the calls to the draft model, reducing redundant computations and further accelerating inference. Evaluations across three LLMs and four tasks show that RADAR achieves a speedup of 3.17x-4.82x over the auto-regressive decoding baseline. The code is available at https://github.com/minaduki-sora/RADAR.

