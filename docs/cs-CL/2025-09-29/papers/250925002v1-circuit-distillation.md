---
layout: default
title: Circuit Distillation
---

# Circuit Distillation

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.25002" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.25002v1</a>
  <a href="https://arxiv.org/pdf/2509.25002.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.25002v1" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.25002v1', 'Circuit Distillation')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Somin Wadhwa, Silvio Amir, Byron C. Wallace

**åˆ†ç±»**: cs.CL

**å‘å¸ƒæ—¥æœŸ**: 2025-09-29

**å¤‡æ³¨**: Preprint; Under Review

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºç”µè·¯è’¸é¦æ–¹æ³•ï¼Œé€šè¿‡å¯¹é½æ¨¡å‹å†…éƒ¨è¡¨å¾å®ç°ç®—æ³•èƒ½åŠ›è¿ç§»**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸æ¶æ„ (RL & Architecture)**

**å…³é”®è¯**: `æ¨¡å‹è’¸é¦` `çŸ¥è¯†è¿ç§»` `ç”µè·¯è’¸é¦` `å†…éƒ¨è¡¨å¾` `ç®—æ³•èƒ½åŠ›` `å¿ƒæ™ºç†è®º` `å®ä½“è·Ÿè¸ª`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ä¼ ç»Ÿæ¨¡å‹è’¸é¦å¿½ç•¥äº†æ•™å¸ˆæ¨¡å‹çš„å†…éƒ¨è®¡ç®—æœºåˆ¶ï¼Œé™åˆ¶äº†ç®—æ³•èƒ½åŠ›çš„æœ‰æ•ˆè¿ç§»ã€‚
2. ç”µè·¯è’¸é¦é€šè¿‡å¯¹é½æ•™å¸ˆå’Œå­¦ç”Ÿæ¨¡å‹ä¸­åŠŸèƒ½å¯¹åº”çš„ç”µè·¯ç»„ä»¶çš„å†…éƒ¨è¡¨å¾ï¼Œå®ç°ç®—æ³•èƒ½åŠ›çš„è¿ç§»ã€‚
3. å®éªŒè¡¨æ˜ï¼Œç”µè·¯è’¸é¦ä¼˜äºæ ‡å‡†è’¸é¦ï¼Œèƒ½å¤Ÿé€šè¿‡è°ƒæ•´å°‘é‡å‚æ•°æˆåŠŸè¿ç§»ç®—æ³•èƒ½åŠ›ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æ¨¡å‹è’¸é¦é€šå¸¸ä¾§é‡äºè¡Œä¸ºæ¨¡ä»¿ï¼Œå³è®­ç»ƒå­¦ç”Ÿæ¨¡å‹å¤åˆ¶æ•™å¸ˆæ¨¡å‹çš„è¾“å‡ºï¼Œè€Œå°†å…¶å†…éƒ¨è®¡ç®—è§†ä¸ºé»‘ç›’ã€‚æœ¬æ–‡æå‡ºäº†ä¸€ç§æ›¿ä»£æ–¹æ³•ï¼šè’¸é¦æ•™å¸ˆæ¨¡å‹æ‰€å®ç°çš„åº•å±‚è®¡ç®—æœºåˆ¶ã€‚å…·ä½“è€Œè¨€ï¼Œæˆ‘ä»¬æå‡ºäº†ç”µè·¯è’¸é¦ï¼Œå¼•å…¥äº†ä¸€ä¸ªç›®æ ‡æ¥å¯¹é½æ•™å¸ˆæ¨¡å‹å’Œå­¦ç”Ÿæ¨¡å‹ä¸­ç±»ä¼¼ç”µè·¯ç»„ä»¶ä¹‹é—´çš„å†…éƒ¨è¡¨å¾ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ç§åŒ¹é…â€œåŠŸèƒ½å¯¹åº”â€ç”µè·¯ç»„ä»¶çš„æ–¹æ³•ï¼Œå¹¶å¼•å…¥ä¸€ä¸ªæŸå¤±å‡½æ•°æ¥åæ˜ è¿™äº›ç»„ä»¶æ‰€äº§ç”Ÿçš„è¡¨å¾ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚æˆ‘ä»¬ä½¿ç”¨ Llama3 ç³»åˆ—çš„æ¨¡å‹åœ¨å®ä½“è·Ÿè¸ªå’Œå¿ƒæ™ºç†è®º (ToM) ä»»åŠ¡ä¸Šè¯„ä¼°äº†ç”µè·¯è’¸é¦ã€‚ç»“æœè¡¨æ˜ï¼Œç”µè·¯è’¸é¦ä¼˜äºæ ‡å‡†è’¸é¦ï¼Œé€šè¿‡ä»…è°ƒæ•´å­¦ç”Ÿæ¨¡å‹å‚æ•°çš„ä¸€ä¸ªå°çš„ã€æœ‰é’ˆå¯¹æ€§çš„å­é›†ï¼ŒæˆåŠŸåœ°è¿ç§»äº†ç®—æ³•èƒ½åŠ›ã€‚è¿™é¡¹å·¥ä½œç¡®ç«‹äº†è¿ç§»æœºåˆ¶çš„å¯è¡Œæ€§ï¼Œè¿™åè¿‡æ¥åˆå¯ä»¥é€šè¿‡å¯è§£é‡Šå’Œå¯æ§çš„å†…éƒ¨å­¦ç”Ÿæœºåˆ¶æ¥å®ç°æœ‰é’ˆå¯¹æ€§çš„æ•™å¸ˆèƒ½åŠ›çš„æœ‰æ•ˆè’¸é¦ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šç°æœ‰æ¨¡å‹è’¸é¦æ–¹æ³•ä¸»è¦å…³æ³¨è¡Œä¸ºæ¨¡ä»¿ï¼Œå³å°†æ•™å¸ˆæ¨¡å‹çš„è¾“å‡ºä½œä¸ºè®­ç»ƒç›®æ ‡ï¼Œè€Œå¿½ç•¥äº†æ•™å¸ˆæ¨¡å‹å†…éƒ¨çš„è®¡ç®—æœºåˆ¶ã€‚è¿™ç§æ–¹æ³•æ— æ³•æœ‰æ•ˆåœ°å°†æ•™å¸ˆæ¨¡å‹çš„ç®—æ³•èƒ½åŠ›è¿ç§»åˆ°å­¦ç”Ÿæ¨¡å‹ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦å¤æ‚æ¨ç†çš„ä»»åŠ¡ä¸­ã€‚å› æ­¤ï¼Œå¦‚ä½•å°†æ•™å¸ˆæ¨¡å‹å†…éƒ¨çš„è®¡ç®—æœºåˆ¶æœ‰æ•ˆåœ°è¿ç§»åˆ°å­¦ç”Ÿæ¨¡å‹æ˜¯ä¸€ä¸ªé‡è¦çš„æŒ‘æˆ˜ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šæœ¬æ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯â€œç”µè·¯è’¸é¦â€ï¼Œå³é€šè¿‡å¯¹é½æ•™å¸ˆæ¨¡å‹å’Œå­¦ç”Ÿæ¨¡å‹ä¸­åŠŸèƒ½å¯¹åº”çš„ç”µè·¯ç»„ä»¶çš„å†…éƒ¨è¡¨å¾ï¼Œæ¥å®ç°ç®—æ³•èƒ½åŠ›çš„è¿ç§»ã€‚è¿™ç§æ–¹æ³•å‡è®¾æ•™å¸ˆæ¨¡å‹å†…éƒ¨å­˜åœ¨ä¸€äº›â€œç”µè·¯â€ï¼Œè¿™äº›ç”µè·¯è´Ÿè´£æ‰§è¡Œç‰¹å®šçš„è®¡ç®—åŠŸèƒ½ã€‚é€šè¿‡è®©å­¦ç”Ÿæ¨¡å‹å­¦ä¹ è¿™äº›ç”µè·¯çš„è¡¨å¾ï¼Œå¯ä»¥ä½¿å­¦ç”Ÿæ¨¡å‹è·å¾—ä¸æ•™å¸ˆæ¨¡å‹ç›¸ä¼¼çš„è®¡ç®—èƒ½åŠ›ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šç”µè·¯è’¸é¦çš„æŠ€æœ¯æ¡†æ¶ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š1) ç¡®å®šæ•™å¸ˆæ¨¡å‹å’Œå­¦ç”Ÿæ¨¡å‹ä¸­åŠŸèƒ½å¯¹åº”çš„ç”µè·¯ç»„ä»¶ï¼›2) æå–è¿™äº›ç”µè·¯ç»„ä»¶çš„å†…éƒ¨è¡¨å¾ï¼›3) è®¾è®¡æŸå¤±å‡½æ•°ï¼Œç”¨äºè¡¡é‡æ•™å¸ˆæ¨¡å‹å’Œå­¦ç”Ÿæ¨¡å‹ä¸­å¯¹åº”ç”µè·¯ç»„ä»¶çš„è¡¨å¾ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼›4) ä½¿ç”¨è¯¥æŸå¤±å‡½æ•°è®­ç»ƒå­¦ç”Ÿæ¨¡å‹ï¼Œä½¿å…¶å­¦ä¹ æ•™å¸ˆæ¨¡å‹çš„å†…éƒ¨è¡¨å¾ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ¬æ–‡æœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°ç‚¹åœ¨äºæå‡ºäº†â€œç”µè·¯è’¸é¦â€çš„æ¦‚å¿µï¼Œå¹¶è®¾è®¡äº†ä¸€ç§æ–¹æ³•æ¥åŒ¹é…æ•™å¸ˆæ¨¡å‹å’Œå­¦ç”Ÿæ¨¡å‹ä¸­åŠŸèƒ½å¯¹åº”çš„ç”µè·¯ç»„ä»¶ã€‚ä¸ä¼ ç»Ÿçš„è¡Œä¸ºæ¨¡ä»¿æ–¹æ³•ç›¸æ¯”ï¼Œç”µè·¯è’¸é¦èƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°å°†æ•™å¸ˆæ¨¡å‹çš„ç®—æ³•èƒ½åŠ›è¿ç§»åˆ°å­¦ç”Ÿæ¨¡å‹ã€‚æ­¤å¤–ï¼Œç”µè·¯è’¸é¦è¿˜å…·æœ‰å¯è§£é‡Šæ€§å’Œå¯æ§æ€§ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£æ¨¡å‹å†…éƒ¨çš„è®¡ç®—æœºåˆ¶ã€‚

**å…³é”®è®¾è®¡**ï¼šåœ¨ç”µè·¯è’¸é¦ä¸­ï¼Œå…³é”®çš„è®¾è®¡åŒ…æ‹¬ï¼š1) å¦‚ä½•ç¡®å®šæ•™å¸ˆæ¨¡å‹å’Œå­¦ç”Ÿæ¨¡å‹ä¸­åŠŸèƒ½å¯¹åº”çš„ç”µè·¯ç»„ä»¶ï¼Ÿæœ¬æ–‡æå‡ºäº†ä¸€ç§åŸºäºæ¿€æ´»æ¨¡å¼ç›¸ä¼¼æ€§çš„æ–¹æ³•æ¥åŒ¹é…è¿™äº›ç»„ä»¶ã€‚2) å¦‚ä½•æå–ç”µè·¯ç»„ä»¶çš„å†…éƒ¨è¡¨å¾ï¼Ÿæœ¬æ–‡ä½¿ç”¨äº†ä¸­é—´å±‚æ¿€æ´»å€¼ä½œä¸ºç”µè·¯ç»„ä»¶çš„è¡¨å¾ã€‚3) å¦‚ä½•è®¾è®¡æŸå¤±å‡½æ•°ï¼Ÿæœ¬æ–‡ä½¿ç”¨äº†ä½™å¼¦ç›¸ä¼¼åº¦ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œç”¨äºè¡¡é‡æ•™å¸ˆæ¨¡å‹å’Œå­¦ç”Ÿæ¨¡å‹ä¸­å¯¹åº”ç”µè·¯ç»„ä»¶çš„è¡¨å¾ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼Œåœ¨å®ä½“è·Ÿè¸ªå’Œå¿ƒæ™ºç†è®º (ToM) ä»»åŠ¡ä¸Šï¼Œç”µè·¯è’¸é¦ä¼˜äºæ ‡å‡†è’¸é¦ã€‚é€šè¿‡ä»…è°ƒæ•´å­¦ç”Ÿæ¨¡å‹å‚æ•°çš„ä¸€ä¸ªå°çš„ã€æœ‰é’ˆå¯¹æ€§çš„å­é›†ï¼Œç”µè·¯è’¸é¦æˆåŠŸåœ°è¿ç§»äº†ç®—æ³•èƒ½åŠ›ã€‚ä¾‹å¦‚ï¼Œåœ¨å¿ƒæ™ºç†è®ºä»»åŠ¡ä¸Šï¼Œä½¿ç”¨ç”µè·¯è’¸é¦è®­ç»ƒçš„å­¦ç”Ÿæ¨¡å‹åœ¨å‡†ç¡®ç‡ä¸Šæ¯”ä½¿ç”¨æ ‡å‡†è’¸é¦è®­ç»ƒçš„å­¦ç”Ÿæ¨¡å‹æé«˜äº† 5% ä»¥ä¸Šã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

ç”µè·¯è’¸é¦æŠ€æœ¯å¯åº”ç”¨äºå„ç§éœ€è¦æ¨¡å‹å‹ç¼©å’ŒåŠ é€Ÿçš„åœºæ™¯ï¼Œä¾‹å¦‚è¾¹ç¼˜è®¡ç®—ã€ç§»åŠ¨è®¾å¤‡å’ŒåµŒå…¥å¼ç³»ç»Ÿã€‚é€šè¿‡å°†å¤§å‹å¤æ‚æ¨¡å‹çš„ç®—æ³•èƒ½åŠ›è¿ç§»åˆ°å°å‹æ¨¡å‹ï¼Œå¯ä»¥é™ä½è®¡ç®—æˆæœ¬å’Œèƒ½æºæ¶ˆè€—ï¼ŒåŒæ—¶ä¿æŒè¾ƒé«˜çš„æ€§èƒ½ã€‚æ­¤å¤–ï¼Œè¯¥æŠ€æœ¯è¿˜å¯ä»¥ç”¨äºçŸ¥è¯†è¿ç§»ã€æ¨¡å‹è§£é‡Šå’Œå®‰å…¨é˜²å¾¡ç­‰é¢†åŸŸã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Model distillation typically focuses on behavioral mimicry, where a student model is trained to replicate a teacher's output while treating its internal computations as a black box. In this work we propose an alternative approach: Distilling the underlying computational mechanisms implemented by a teacher model. Specifically, we propose circuit distillation, which introduces an objective to align internal representations between analogous circuit components in teacher and student models. We propose a method to match ``functionally correspondent'' circuit components and introduce a loss reflecting similarities between the representations that these induce. We evaluate circuit distillation on entity tracking and theory of mind (ToM) tasks using models from the Llama3 family. Our results demonstrate that circuit distillation outperforms standard distillation, successfully transferring algorithmic capabilities by adjusting only a small, targeted subset of student model parameters. This work establishes the feasibility of transferring mechanisms, which may in turn allow for efficient distillation of targeted teacher capabilities via interpretable and controllable internal student mechanisms.

