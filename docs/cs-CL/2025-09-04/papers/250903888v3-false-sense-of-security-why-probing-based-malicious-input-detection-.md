---
layout: default
title: False Sense of Security: Why Probing-based Malicious Input Detection Fails to Generalize
---

# False Sense of Security: Why Probing-based Malicious Input Detection Fails to Generalize

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.03888" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.03888v3</a>
  <a href="https://arxiv.org/pdf/2509.03888.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.03888v3" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.03888v3', 'False Sense of Security: Why Probing-based Malicious Input Detection Fails to Generalize')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Cheng Wang, Zeming Wei, Qin Liu, Muhao Chen

**åˆ†ç±»**: cs.CL

**å‘å¸ƒæ—¥æœŸ**: 2025-09-04 (æ›´æ–°: 2025-12-15)

**ğŸ”— ä»£ç /é¡¹ç›®**: [GITHUB](https://github.com/WangCheng0116/Why-Probe-Fails)

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æ­ç¤ºåŸºäºæ¢é’ˆçš„æ¶æ„è¾“å…¥æ£€æµ‹æ–¹æ³•æ³›åŒ–æ€§ä¸è¶³çš„æ ¹æœ¬åŸå› **

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¹ï¼šå…·èº«å¤§æ¨¡å‹ (Embodied Foundation Models)**

**å…³é”®è¯**: `å¤§å‹è¯­è¨€æ¨¡å‹å®‰å…¨` `æ¶æ„è¾“å…¥æ£€æµ‹` `æ¢é’ˆæ–¹æ³•` `æ³›åŒ–èƒ½åŠ›` `è¡¨é¢æ¨¡å¼`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰åŸºäºæ¢é’ˆçš„æ¶æ„è¾“å…¥æ£€æµ‹æ–¹æ³•åœ¨æ³›åŒ–æ€§ä¸Šå­˜åœ¨ä¸è¶³ï¼Œæ— æ³•æœ‰æ•ˆè¯†åˆ«åˆ†å¸ƒå¤–çš„æ¶æ„è¾“å…¥ã€‚
2. è®ºæ–‡æå‡ºæ¢é’ˆå­¦ä¹ çš„æ˜¯è¾“å…¥ä¸­çš„è¡¨é¢æ¨¡å¼ï¼ˆå¦‚æŒ‡ä»¤æ¨¡å¼å’Œè§¦å‘è¯ï¼‰ï¼Œè€ŒéçœŸæ­£çš„è¯­ä¹‰æœ‰å®³æ€§ã€‚
3. é€šè¿‡å—æ§å®éªŒå’Œè¯¦ç»†åˆ†æï¼ŒéªŒè¯äº†æ¢é’ˆæ–¹æ³•çš„å±€é™æ€§ï¼Œå¹¶æå‡ºäº†æ”¹è¿›æ¨¡å‹å’Œè¯„ä¼°åè®®çš„å»ºè®®ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰å¯èƒ½æ‰§è¡Œæœ‰å®³æŒ‡ä»¤ï¼Œè¿™å¼•å‘äº†ä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå°½ç®¡å®ƒä»¬çš„èƒ½åŠ›ä»¤äººå°è±¡æ·±åˆ»ã€‚æœ€è¿‘çš„ç ”ç©¶åˆ©ç”¨åŸºäºæ¢é’ˆçš„æ–¹æ³•æ¥ç ”ç©¶LLMså†…éƒ¨è¡¨ç¤ºä¸­æ¶æ„å’Œè‰¯æ€§è¾“å…¥çš„å¯åˆ†ç¦»æ€§ï¼Œå¹¶ä¸”ç ”ç©¶äººå‘˜å·²ç»æå‡ºä½¿ç”¨è¿™ç§æ¢é’ˆæ–¹æ³•è¿›è¡Œå®‰å…¨æ£€æµ‹ã€‚æˆ‘ä»¬ç³»ç»Ÿåœ°é‡æ–°å®¡è§†äº†è¿™ç§èŒƒå¼ã€‚å—åˆ°è¾ƒå·®çš„åˆ†å¸ƒå¤–æ€§èƒ½çš„å¯å‘ï¼Œæˆ‘ä»¬å‡è®¾æ¢é’ˆå­¦ä¹ çš„æ˜¯è¡¨é¢æ¨¡å¼ï¼Œè€Œä¸æ˜¯è¯­ä¹‰ä¸Šçš„æœ‰å®³æ€§ã€‚é€šè¿‡å—æ§å®éªŒï¼Œæˆ‘ä»¬è¯å®äº†è¿™ä¸€å‡è®¾ï¼Œå¹¶ç¡®å®šäº†æ‰€å­¦ä¹ çš„ç‰¹å®šæ¨¡å¼ï¼šæŒ‡ä»¤æ¨¡å¼å’Œè§¦å‘è¯ã€‚æˆ‘ä»¬çš„ç ”ç©¶éµå¾ªä¸€ç§ç³»ç»Ÿçš„æ–¹æ³•ï¼Œä»å±•ç¤ºç®€å•çš„n-gramæ–¹æ³•çš„å¯æ¯”æ€§èƒ½ï¼Œåˆ°ä½¿ç”¨è¯­ä¹‰æ¸…ç†çš„æ•°æ®é›†è¿›è¡Œå—æ§å®éªŒï¼Œå†åˆ°å¯¹æ¨¡å¼ä¾èµ–æ€§çš„è¯¦ç»†åˆ†æã€‚è¿™äº›ç»“æœæ­ç¤ºäº†å½“å‰åŸºäºæ¢é’ˆçš„æ–¹æ³•å­˜åœ¨ä¸€ç§è™šå‡çš„å®‰å…¨æ„Ÿï¼Œå¹¶å¼ºè°ƒéœ€è¦é‡æ–°è®¾è®¡æ¨¡å‹å’Œè¯„ä¼°åè®®ï¼Œä¸ºæ­¤æˆ‘ä»¬æä¾›äº†è¿›ä¸€æ­¥çš„è®¨è®ºï¼Œå¸Œæœ›ä¸ºè¯¥æ–¹å‘çš„è´Ÿè´£ä»»çš„è¿›ä¸€æ­¥ç ”ç©¶æä¾›å»ºè®®ã€‚æˆ‘ä»¬å·²ç»åœ¨https://github.com/WangCheng0116/Why-Probe-Failsä¸Šå¼€æºäº†è¯¥é¡¹ç›®ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šç°æœ‰åŸºäºæ¢é’ˆçš„æ¶æ„è¾“å…¥æ£€æµ‹æ–¹æ³•æ—¨åœ¨é€šè¿‡è®­ç»ƒåˆ†ç±»å™¨ï¼ˆæ¢é’ˆï¼‰åŒºåˆ†LLMå†…éƒ¨è¡¨ç¤ºä¸­è‰¯æ€§å’Œæ¶æ„è¾“å…¥ã€‚ç„¶è€Œï¼Œè¿™äº›æ–¹æ³•åœ¨é¢å¯¹åˆ†å¸ƒå¤–çš„æ¶æ„è¾“å…¥æ—¶ï¼Œæ€§èƒ½æ˜¾è‘—ä¸‹é™ï¼Œè¡¨æ˜å…¶æ³›åŒ–èƒ½åŠ›ä¸è¶³ã€‚ç—›ç‚¹åœ¨äºæ¢é’ˆå¯èƒ½å­¦ä¹ äº†è®­ç»ƒæ•°æ®ä¸­çš„è¡¨é¢æ¨¡å¼ï¼Œè€ŒéçœŸæ­£çš„è¯­ä¹‰æœ‰å®³æ€§ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯æ¢é’ˆå­¦ä¹ çš„æ˜¯è¾“å…¥ä¸­çš„è¡¨é¢æ¨¡å¼ï¼Œä¾‹å¦‚ç‰¹å®šçš„æŒ‡ä»¤æ¨¡å¼æˆ–è§¦å‘è¯ï¼Œè€Œéæ·±å±‚çš„è¯­ä¹‰æœ‰å®³æ€§ã€‚å› æ­¤ï¼Œå³ä½¿è¾“å…¥åœ¨è¯­ä¹‰ä¸Šæ˜¯æ— å®³çš„ï¼Œåªè¦åŒ…å«è¿™äº›è¡¨é¢æ¨¡å¼ï¼Œæ¢é’ˆå°±å¯èƒ½å°†å…¶é”™è¯¯åœ°è¯†åˆ«ä¸ºæ¶æ„è¾“å…¥ã€‚åä¹‹äº¦ç„¶ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šè®ºæ–‡é‡‡ç”¨äº†ä¸€ç§ç³»ç»Ÿæ€§çš„ç ”ç©¶æ–¹æ³•ã€‚é¦–å…ˆï¼Œé€šè¿‡ç®€å•çš„n-gramæ¨¡å‹éªŒè¯äº†è¡¨é¢æ¨¡å¼çš„é‡è¦æ€§ã€‚ç„¶åï¼Œæ„å»ºäº†è¯­ä¹‰æ¸…ç†çš„æ•°æ®é›†ï¼Œé€šè¿‡æ§åˆ¶å®éªŒæ¥éš”ç¦»å’Œåˆ†æä¸åŒè¡¨é¢æ¨¡å¼çš„å½±å“ã€‚æœ€åï¼Œå¯¹æ¢é’ˆå­¦ä¹ åˆ°çš„æ¨¡å¼ä¾èµ–æ€§è¿›è¡Œäº†è¯¦ç»†åˆ†æï¼Œä»¥æ­ç¤ºå…¶æ³›åŒ–èƒ½åŠ›ä¸è¶³çš„æ ¹æœ¬åŸå› ã€‚

**å…³é”®åˆ›æ–°**ï¼šè®ºæ–‡æœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°ç‚¹åœ¨äºæ­ç¤ºäº†åŸºäºæ¢é’ˆçš„æ¶æ„è¾“å…¥æ£€æµ‹æ–¹æ³•çš„å±€é™æ€§ï¼Œå¹¶æŒ‡å‡ºäº†å…¶æ³›åŒ–èƒ½åŠ›ä¸è¶³çš„æ ¹æœ¬åŸå› ï¼šæ¢é’ˆå­¦ä¹ çš„æ˜¯è¡¨é¢æ¨¡å¼è€Œéè¯­ä¹‰æœ‰å®³æ€§ã€‚è¿™ä¸ä¹‹å‰è®¤ä¸ºæ¢é’ˆèƒ½å¤Ÿæ•è·LLMå†…éƒ¨è¡¨ç¤ºä¸­æ¶æ„è¾“å…¥çš„è¯­ä¹‰ä¿¡æ¯çš„è§‚ç‚¹å½¢æˆäº†é²œæ˜å¯¹æ¯”ã€‚

**å…³é”®è®¾è®¡**ï¼šè®ºæ–‡çš„å…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) æ„å»ºè¯­ä¹‰æ¸…ç†çš„æ•°æ®é›†ï¼Œé€šè¿‡æ§åˆ¶å®éªŒæ¥éš”ç¦»å’Œåˆ†æä¸åŒè¡¨é¢æ¨¡å¼çš„å½±å“ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡æ›¿æ¢æ¶æ„è¾“å…¥ä¸­çš„è§¦å‘è¯ï¼Œæˆ–è€…æ”¹å˜æŒ‡ä»¤çš„è¡¨è¾¾æ–¹å¼ï¼Œæ¥è§‚å¯Ÿæ¢é’ˆçš„æ€§èƒ½å˜åŒ–ã€‚2) ä½¿ç”¨ç®€å•çš„n-gramæ¨¡å‹ä½œä¸ºåŸºçº¿ï¼Œæ¥éªŒè¯è¡¨é¢æ¨¡å¼çš„é‡è¦æ€§ã€‚3) å¯¹æ¢é’ˆå­¦ä¹ åˆ°çš„æ¨¡å¼ä¾èµ–æ€§è¿›è¡Œè¯¦ç»†åˆ†æï¼Œä¾‹å¦‚é€šè¿‡å¯è§†åŒ–æ¢é’ˆçš„æƒé‡ï¼Œæˆ–è€…é€šè¿‡å¯¹æŠ—æ”»å‡»æ¥æ­ç¤ºå…¶è„†å¼±æ€§ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

è®ºæ–‡é€šè¿‡å®éªŒè¯æ˜ï¼Œç®€å•çš„n-gramæ¨¡å‹å¯ä»¥è¾¾åˆ°ä¸åŸºäºæ¢é’ˆçš„æ–¹æ³•ç›¸å½“çš„æ€§èƒ½ï¼Œè¿™è¡¨æ˜æ¢é’ˆå¯èƒ½ä¸»è¦ä¾èµ–äºè¡¨é¢æ¨¡å¼ã€‚åœ¨è¯­ä¹‰æ¸…ç†çš„æ•°æ®é›†ä¸Šè¿›è¡Œçš„å—æ§å®éªŒè¿›ä¸€æ­¥è¯å®äº†è¿™ä¸€å‡è®¾ï¼Œå¹¶æ­ç¤ºäº†æ¢é’ˆå­¦ä¹ çš„ç‰¹å®šæ¨¡å¼ï¼šæŒ‡ä»¤æ¨¡å¼å’Œè§¦å‘è¯ã€‚è¿™äº›å‘ç°æŒ‘æˆ˜äº†å½“å‰åŸºäºæ¢é’ˆçš„æ–¹æ³•çš„æœ‰æ•ˆæ€§ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæœå¯¹äºæå‡å¤§å‹è¯­è¨€æ¨¡å‹çš„å®‰å…¨æ€§å…·æœ‰é‡è¦æ„ä¹‰ã€‚é€šè¿‡ç†è§£ç°æœ‰æ¶æ„è¾“å…¥æ£€æµ‹æ–¹æ³•çš„å±€é™æ€§ï¼Œå¯ä»¥æŒ‡å¯¼ç ”ç©¶äººå‘˜è®¾è®¡æ›´é²æ£’ã€æ›´å…·æœ‰æ³›åŒ–èƒ½åŠ›çš„æ£€æµ‹æ–¹æ³•ã€‚æ­¤å¤–ï¼Œè¯¥ç ”ç©¶ä¹Ÿæé†’äººä»¬åœ¨è¯„ä¼°LLMå®‰å…¨æ€§æ—¶ï¼Œéœ€è¦æ›´åŠ å…³æ³¨è¯„ä¼°åè®®çš„åˆç†æ€§ï¼Œé¿å…äº§ç”Ÿè™šå‡çš„å®‰å…¨æ„Ÿã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Large Language Models (LLMs) can comply with harmful instructions, raising serious safety concerns despite their impressive capabilities. Recent work has leveraged probing-based approaches to study the separability of malicious and benign inputs in LLMs' internal representations, and researchers have proposed using such probing methods for safety detection. We systematically re-examine this paradigm. Motivated by poor out-of-distribution performance, we hypothesize that probes learn superficial patterns rather than semantic harmfulness. Through controlled experiments, we confirm this hypothesis and identify the specific patterns learned: instructional patterns and trigger words. Our investigation follows a systematic approach, progressing from demonstrating comparable performance of simple n-gram methods, to controlled experiments with semantically cleaned datasets, to detailed analysis of pattern dependencies. These results reveal a false sense of security around current probing-based approaches and highlight the need to redesign both models and evaluation protocols, for which we provide further discussions in the hope of suggesting responsible further research in this direction. We have open-sourced the project at https://github.com/WangCheng0116/Why-Probe-Fails.

