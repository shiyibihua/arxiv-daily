---
layout: default
title: Differentiable-by-design Nonlinear Optimization for Model Predictive Control
---

# Differentiable-by-design Nonlinear Optimization for Model Predictive Control

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.12692" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.12692v3</a>
  <a href="https://arxiv.org/pdf/2509.12692.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.12692v3" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.12692v3', 'Differentiable-by-design Nonlinear Optimization for Model Predictive Control')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Riccardo Zuliani, Efe C. Balta, John Lygeros

**åˆ†ç±»**: math.OC, eess.SY

**å‘å¸ƒæ—¥æœŸ**: 2025-09-16 (æ›´æ–°: 2025-12-01)

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºå¯å¾®éçº¿æ€§ä¼˜åŒ–æ–¹æ³•ï¼Œç”¨äºæ¨¡å‹é¢„æµ‹æ§åˆ¶ï¼Œæå‡æ¢¯åº¦ç­–ç•¥ä¼˜åŒ–æ€§èƒ½ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸€ï¼šæœºå™¨äººæ§åˆ¶ (Robot Control)**

**å…³é”®è¯**: `éçº¿æ€§ä¼˜åŒ–` `æ¨¡å‹é¢„æµ‹æ§åˆ¶` `å¯å¾®ç¼–ç¨‹` `æ¢¯åº¦ä¼˜åŒ–` `æ§åˆ¶ç­–ç•¥å­¦ä¹ `

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. éçº¿æ€§æ¨¡å‹é¢„æµ‹æ§åˆ¶ä¾èµ–åœ¨çº¿æ±‚è§£éçº¿æ€§ä¼˜åŒ–é—®é¢˜ï¼Œè®¡ç®—æˆæœ¬é«˜æ˜‚ï¼Œä¸”è§£æ˜ å°„å¯èƒ½ä¸å¯å¾®ï¼Œé˜»ç¢äº†æ¢¯åº¦ä¼˜åŒ–ã€‚
2. è®ºæ–‡æå‡ºä¸€ç§æ­£åˆ™åŒ–éçº¿æ€§ä¼˜åŒ–é—®é¢˜çš„æ–¹æ³•ï¼Œå³ä½¿åŸé—®é¢˜ä¸å¯å¾®ï¼Œä¹Ÿèƒ½è·å¾—å¯å¾®çš„æ›¿ä»£å¯¼æ•°ï¼Œä¿è¯è§£çš„ä¸€è‡´æ€§ã€‚
3. å®éªŒè¡¨æ˜ï¼Œè¯¥æ–¹æ³•åœ¨è‡ªç”±ç»ˆç‚¹æ—¶é—´æœ€ä¼˜æ§åˆ¶å’Œé€’æ¨èŒƒå›´éçº¿æ€§MPCä¸­æœ‰æ•ˆï¼ŒéªŒè¯äº†å…¶åœ¨æ¢¯åº¦ç­–ç•¥ä¼˜åŒ–ä¸­çš„æ½œåŠ›ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

è¿‘å¹´æ¥ï¼ŒåŸºäºéçº¿æ€§ä¼˜åŒ–çš„æ§åˆ¶ç­–ç•¥ï¼Œå¦‚éçº¿æ€§æ¨¡å‹é¢„æµ‹æ§åˆ¶ï¼Œå–å¾—äº†æ˜¾è‘—æˆåŠŸã€‚è¿™äº›ç­–ç•¥éœ€è¦åœ¨æ¯ä¸ªæ—¶é—´æ­¥åœ¨çº¿æ±‚è§£è®¡ç®—é‡å¤§çš„éçº¿æ€§ä¼˜åŒ–é—®é¢˜ã€‚ç”±æ­¤äº§ç”Ÿçš„è§£æ˜ å°„ï¼Œä½œä¸ºç³»ç»Ÿæµ‹é‡çŠ¶æ€å’Œè®¾è®¡å‚æ•°çš„å‡½æ•°ï¼Œå¯èƒ½ä¸å¯å¾®ï¼Œå¦‚æœæ§åˆ¶ç­–ç•¥åµŒå…¥åˆ°åŸºäºæ¢¯åº¦çš„ç­–ç•¥ä¼˜åŒ–æ–¹æ¡ˆä¸­ï¼Œè¿™å°†å¸¦æ¥é‡å¤§æŒ‘æˆ˜ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ç§åŸåˆ™æ€§çš„æ–¹æ³•æ¥æ­£åˆ™åŒ–éçº¿æ€§ä¼˜åŒ–é—®é¢˜ï¼Œå³ä½¿åœ¨åŸå§‹é—®é¢˜ä¸å¯å¾®æ—¶ä¹Ÿèƒ½è·å¾—æ›¿ä»£å¯¼æ•°ã€‚è¯¥æ›¿ä»£é—®é¢˜åœ¨è®¾è®¡ä¸Šæ˜¯å¯å¾®çš„ï¼Œå…¶è§£æ˜ å°„ä¸æœªæ­£åˆ™åŒ–é—®é¢˜çš„è§£ä¸€è‡´ã€‚æˆ‘ä»¬åœ¨è‡ªç”±ç»ˆç‚¹æ—¶é—´æœ€ä¼˜æ§åˆ¶é—®é¢˜å’Œé€’æ¨èŒƒå›´éçº¿æ€§MPCç¤ºä¾‹ä¸­è¯æ˜äº†æˆ‘ä»¬æ–¹æ³•çš„æœ‰æ•ˆæ€§ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³éçº¿æ€§æ¨¡å‹é¢„æµ‹æ§åˆ¶ï¼ˆNMPCï¼‰ä¸­ï¼Œç”±äºåœ¨çº¿æ±‚è§£çš„éçº¿æ€§ä¼˜åŒ–é—®é¢˜è§£æ˜ å°„ä¸å¯å¾®ï¼Œå¯¼è‡´æ— æ³•æœ‰æ•ˆåˆ©ç”¨æ¢¯åº¦ä¿¡æ¯è¿›è¡Œç­–ç•¥ä¼˜åŒ–çš„é—®é¢˜ã€‚ç°æœ‰æ–¹æ³•åœ¨å¤„ç†æ­¤ç±»é—®é¢˜æ—¶ï¼Œè¦ä¹ˆå¿½ç•¥ä¸å¯å¾®æ€§ï¼Œå¯¼è‡´ä¼˜åŒ–æ•ˆæœä¸ä½³ï¼Œè¦ä¹ˆé‡‡ç”¨å¤æ‚çš„è¿‘ä¼¼æ–¹æ³•ï¼Œå¼•å…¥é¢å¤–çš„è®¡ç®—è´Ÿæ‹…å’Œè¯¯å·®ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯é€šè¿‡å¯¹åŸéçº¿æ€§ä¼˜åŒ–é—®é¢˜è¿›è¡Œæ­£åˆ™åŒ–ï¼Œæ„é€ ä¸€ä¸ªè®¾è®¡ä¸Šå¯å¾®çš„æ›¿ä»£é—®é¢˜ã€‚è¯¥æ›¿ä»£é—®é¢˜çš„è§£æ˜ å°„ä¸åŸé—®é¢˜ä¸€è‡´ï¼Œä½†å…·æœ‰è‰¯å¥½çš„å¯å¾®æ€§ï¼Œä»è€Œå¯ä»¥æ–¹ä¾¿åœ°åˆ©ç”¨æ¢¯åº¦ä¿¡æ¯è¿›è¡Œç­–ç•¥ä¼˜åŒ–ã€‚è¿™ç§æ–¹æ³•é¿å…äº†ç›´æ¥å¤„ç†åŸé—®é¢˜ä¸å¯å¾®æ€§çš„å›°éš¾ï¼ŒåŒæ—¶ä¿è¯äº†ä¼˜åŒ–ç»“æœçš„æœ‰æ•ˆæ€§ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šè¯¥æ–¹æ³•ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªé˜¶æ®µï¼š1) å»ºç«‹åŸå§‹çš„éçº¿æ€§ä¼˜åŒ–é—®é¢˜ï¼Œä¾‹å¦‚NMPCä¸­çš„ä¼˜åŒ–é—®é¢˜ã€‚2) å¯¹è¯¥é—®é¢˜è¿›è¡Œæ­£åˆ™åŒ–ï¼Œå¼•å…¥é¢å¤–çš„é¡¹ï¼Œä½¿å¾—æ–°çš„ä¼˜åŒ–é—®é¢˜åœ¨è®¾è®¡ä¸Šæ˜¯å¯å¾®çš„ã€‚3) æ±‚è§£æ­£åˆ™åŒ–åçš„ä¼˜åŒ–é—®é¢˜ï¼Œå¾—åˆ°æ›¿ä»£è§£æ˜ å°„ã€‚4) åˆ©ç”¨æ›¿ä»£è§£æ˜ å°„çš„æ¢¯åº¦ä¿¡æ¯è¿›è¡Œç­–ç•¥ä¼˜åŒ–ã€‚æ•´ä¸ªæ¡†æ¶çš„å…³é”®åœ¨äºæ­£åˆ™åŒ–é¡¹çš„è®¾è®¡ï¼Œéœ€è¦ä¿è¯æ­£åˆ™åŒ–åçš„é—®é¢˜å¯å¾®ï¼Œä¸”è§£ä¸åŸé—®é¢˜ä¸€è‡´ã€‚

**å…³é”®åˆ›æ–°**ï¼šè®ºæ–‡æœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°åœ¨äºæå‡ºäº†ä¸€ç§â€œå¯å¾®è®¾è®¡â€çš„æ­£åˆ™åŒ–æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•ä¸æ˜¯ç®€å•åœ°å¯¹ç›®æ ‡å‡½æ•°æˆ–çº¦æŸæ¡ä»¶è¿›è¡Œå¹³æ»‘å¤„ç†ï¼Œè€Œæ˜¯é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„æ­£åˆ™åŒ–é¡¹ï¼Œä½¿å¾—æ•´ä¸ªä¼˜åŒ–é—®é¢˜åœ¨ç»“æ„ä¸Šå…·æœ‰å¯å¾®æ€§ã€‚è¿™ç§æ–¹æ³•é¿å…äº†ä¼ ç»Ÿå¹³æ»‘æ–¹æ³•å¯èƒ½å¼•å…¥çš„åå·®ï¼Œä¿è¯äº†ä¼˜åŒ–ç»“æœçš„å‡†ç¡®æ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šè®ºæ–‡çš„å…³é”®è®¾è®¡åœ¨äºæ­£åˆ™åŒ–é¡¹çš„å…·ä½“å½¢å¼ã€‚å…·ä½“æ¥è¯´ï¼Œæ­£åˆ™åŒ–é¡¹éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š1) ä¿è¯æ­£åˆ™åŒ–åçš„é—®é¢˜æ˜¯å‡¸çš„æˆ–å…·æœ‰è‰¯å¥½çš„å±€éƒ¨æ€§è´¨ï¼Œä»è€Œä¿è¯å¯å¾®æ€§ã€‚2) ä¿è¯æ­£åˆ™åŒ–é¡¹åœ¨åŸé—®é¢˜æœ€ä¼˜è§£å¤„ä¸ºé›¶ï¼Œä»è€Œä¿è¯æ­£åˆ™åŒ–åçš„è§£ä¸åŸé—®é¢˜ä¸€è‡´ã€‚3) æ­£åˆ™åŒ–é¡¹çš„æ¢¯åº¦å®¹æ˜“è®¡ç®—ï¼Œä»è€Œæ–¹ä¾¿è¿›è¡Œæ¢¯åº¦ä¼˜åŒ–ã€‚è®ºæ–‡å¯èƒ½é‡‡ç”¨äº†äºŒæ¬¡æƒ©ç½šé¡¹æˆ–å…¶ä»–å½¢å¼çš„æ­£åˆ™åŒ–é¡¹ï¼Œå…·ä½“å½¢å¼å–å†³äºå…·ä½“çš„ä¼˜åŒ–é—®é¢˜ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

è®ºæ–‡åœ¨è‡ªç”±ç»ˆç‚¹æ—¶é—´æœ€ä¼˜æ§åˆ¶é—®é¢˜å’Œé€’æ¨èŒƒå›´éçº¿æ€§MPCç¤ºä¾‹ä¸­éªŒè¯äº†è¯¥æ–¹æ³•çš„æœ‰æ•ˆæ€§ã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œå³ä½¿åœ¨åŸé—®é¢˜ä¸å¯å¾®çš„æƒ…å†µä¸‹ï¼Œè¯¥æ–¹æ³•ä¹Ÿèƒ½è·å¾—ä¸åŸé—®é¢˜ä¸€è‡´çš„è§£ï¼Œå¹¶ä¸”å¯ä»¥æœ‰æ•ˆåœ°åˆ©ç”¨æ¢¯åº¦ä¿¡æ¯è¿›è¡Œç­–ç•¥ä¼˜åŒ–ã€‚å…·ä½“çš„æ€§èƒ½æ•°æ®å’Œæå‡å¹…åº¦éœ€è¦åœ¨è®ºæ–‡ä¸­æŸ¥æ‰¾ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæœå¯å¹¿æ³›åº”ç”¨äºæœºå™¨äººæ§åˆ¶ã€è‡ªåŠ¨é©¾é©¶ã€è¿‡ç¨‹æ§åˆ¶ç­‰é¢†åŸŸï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦åœ¨çº¿ä¼˜åŒ–æ§åˆ¶ç­–ç•¥çš„åœºæ™¯ä¸‹ã€‚é€šè¿‡åˆ©ç”¨å¯å¾®çš„ä¼˜åŒ–è§£æ˜ å°„ï¼Œå¯ä»¥æ›´æœ‰æ•ˆåœ°è¿›è¡ŒåŸºäºæ¢¯åº¦çš„ç­–ç•¥å­¦ä¹ å’Œä¼˜åŒ–ï¼Œæå‡æ§åˆ¶ç³»ç»Ÿçš„æ€§èƒ½å’Œé²æ£’æ€§ã€‚æœªæ¥ï¼Œè¯¥æ–¹æ³•æœ‰æœ›æ¨åŠ¨æ›´å¤æ‚ã€æ›´æ™ºèƒ½çš„æ§åˆ¶ç³»ç»Ÿçš„å‘å±•ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Nonlinear optimization-based control policies, such as those those arising in nonlinear Model Predictive Control, have seen remarkable success in recent years. These policies require solving computationally demanding nonlinear optimization programs online at each time-step. The resulting solution map, viewed as a function of the measured state of the system and design parameters, may not be differentiable, which poses significant challenges if the control policy is embedded in a gradient-based policy optimization scheme. We propose a principled way to regularize the nonlinear optimization problem, obtaining a surrogate derivative even if when the original problem is not differentiable. The surrogate problem is differentiable by design and its solution map coincides with the solution of the unregularized problem. We demonstrate the effectiveness of our approach in a free-final-time optimal control problem and a receding-horizon nonlinear MPC example.

