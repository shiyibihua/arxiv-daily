---
layout: default
title: The Pitfalls of KV Cache Compression
---

# The Pitfalls of KV Cache Compression

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2510.00231" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2510.00231v1</a>
  <a href="https://arxiv.org/pdf/2510.00231.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2510.00231v1" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2510.00231v1', 'The Pitfalls of KV Cache Compression')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Alex Chen, Renato Geh, Aditya Grover, Guy Van den Broeck, Daniel Israel

**åˆ†ç±»**: cs.LG, cs.AI

**å‘å¸ƒæ—¥æœŸ**: 2025-09-30

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æ­ç¤ºKVç¼“å­˜å‹ç¼©åœ¨å¤šæŒ‡ä»¤åœºæ™¯ä¸‹çš„ç¼ºé™·ï¼Œæå‡ºæ”¹è¿›æ–¹æ¡ˆ**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¹ï¼šå…·èº«å¤§æ¨¡å‹ (Embodied Foundation Models)**

**å…³é”®è¯**: `KVç¼“å­˜å‹ç¼©` `å¤§å‹è¯­è¨€æ¨¡å‹` `å¤šæŒ‡ä»¤å­¦ä¹ ` `æç¤ºæ³„éœ²` `é©±é€ç­–ç•¥`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰KVç¼“å­˜å‹ç¼©æ–¹æ³•åœ¨å¤šæŒ‡ä»¤åœºæ™¯ä¸‹å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´éƒ¨åˆ†æŒ‡ä»¤è¢«å¿½ç•¥ï¼Œå½±å“æ¨¡å‹æ€§èƒ½ã€‚
2. é€šè¿‡åˆ†æå‹ç¼©æ–¹æ³•ã€æŒ‡ä»¤é¡ºåºå’ŒKVé©±é€åå·®ç­‰å› ç´ ï¼Œæ­ç¤ºäº†æç¤ºæ³„éœ²çš„åŸå› ã€‚
3. æå‡ºäº†æ”¹è¿›çš„KVç¼“å­˜é©±é€ç­–ç•¥ï¼Œæ—¨åœ¨å‡å°‘ä¸Šè¿°å› ç´ çš„å½±å“ï¼Œæå‡å¤šæŒ‡ä»¤ä»»åŠ¡çš„æ€§èƒ½ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

KVç¼“å­˜å‹ç¼©æ—¨åœ¨æé«˜å¤§å‹è¯­è¨€æ¨¡å‹çš„ååé‡å’Œæ•ˆç‡ï¼ŒåŒæ—¶å°½é‡å‡å°‘æ€§èƒ½æŸå¤±ã€‚å°½ç®¡ååé‡æå‡æ¯‹åº¸ç½®ç–‘ï¼Œä¸”ç°æœ‰ç ”ç©¶è¡¨æ˜åœ¨ç‰¹å®šåŸºå‡†æµ‹è¯•ä¸­æ€§èƒ½ä¸‹é™æå°ï¼Œä½†å¯¹äºå¤šæŒ‡ä»¤æç¤ºç­‰å®é™…åœºæ™¯ä¸‹å‹ç¼©çš„å½±å“ç ”ç©¶ä¸è¶³ã€‚æœ¬æ–‡æŒ‡å‡ºäº†ä»ä¸šè€…åœ¨éƒ¨ç½²KVç¼“å­˜å‹ç¼©LLMæ—¶åº”æ³¨æ„çš„å‡ ä¸ªé™·é˜±ã€‚é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å‘ç°æŸäº›æŒ‡ä»¤åœ¨å‹ç¼©åæ€§èƒ½ä¸‹é™æ›´å¿«ï¼Œå¯¼è‡´LLMå®Œå…¨å¿½ç•¥å®ƒä»¬ã€‚ä»¥ç³»ç»Ÿæç¤ºæ³„éœ²ä¸ºä¾‹ï¼Œæˆ‘ä»¬é€šè¿‡å®éªŒå±•ç¤ºäº†å‹ç¼©å¯¹æ³„éœ²å’Œé€šç”¨æŒ‡ä»¤éµå¾ªçš„å½±å“ï¼Œå¹¶æ­ç¤ºäº†å‹ç¼©æ–¹æ³•ã€æŒ‡ä»¤é¡ºåºå’ŒKVé©±é€åå·®åœ¨æç¤ºæ³„éœ²ä¸­çš„ä½œç”¨ã€‚æœ€åï¼Œæˆ‘ä»¬æå‡ºäº†KVç¼“å­˜é©±é€ç­–ç•¥çš„ç®€å•ä¿®æ”¹ï¼Œä»¥å‡å°‘è¿™äº›å› ç´ çš„å½±å“ï¼Œå¹¶æé«˜å¤šæŒ‡ä»¤ä»»åŠ¡çš„æ•´ä½“æ€§èƒ½ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡å…³æ³¨çš„æ˜¯åœ¨å¤§å‹è¯­è¨€æ¨¡å‹ä¸­ä½¿ç”¨KVç¼“å­˜å‹ç¼©æ—¶ï¼Œåœ¨å¤šæŒ‡ä»¤åœºæ™¯ä¸‹å‡ºç°çš„æ€§èƒ½é€€åŒ–é—®é¢˜ã€‚ç°æœ‰çš„ç ”ç©¶ä¸»è¦é›†ä¸­åœ¨å•æŒ‡ä»¤æˆ–ç®€å•åœºæ™¯ä¸‹ï¼Œå¿½ç•¥äº†å¤æ‚æŒ‡ä»¤ç»„åˆå¯èƒ½å¸¦æ¥çš„å½±å“ï¼Œå°¤å…¶æ˜¯åœ¨æŒ‡ä»¤ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»æ—¶ï¼Œå‹ç¼©å¯èƒ½ä¼šå¯¼è‡´å…³é”®æŒ‡ä»¤ä¸¢å¤±æˆ–è¢«å¼±åŒ–ï¼Œä»è€Œå½±å“æ¨¡å‹çš„æ•´ä½“è¡¨ç°ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯é€šè¿‡åˆ†æKVç¼“å­˜å‹ç¼©è¿‡ç¨‹ä¸­çš„ä¿¡æ¯æŸå¤±ï¼Œè¯†åˆ«å‡ºå¯¼è‡´æŒ‡ä»¤æ€§èƒ½é€€åŒ–çš„å…³é”®å› ç´ ï¼Œä¾‹å¦‚å‹ç¼©æ–¹æ³•æœ¬èº«ã€æŒ‡ä»¤çš„æ’åˆ—é¡ºåºä»¥åŠKVç¼“å­˜çš„é©±é€ç­–ç•¥ã€‚ç„¶åï¼Œé’ˆå¯¹è¿™äº›å› ç´ ï¼Œæå‡ºç›¸åº”çš„æ”¹è¿›æªæ–½ï¼Œä»¥å‡è½»å‹ç¼©å¸¦æ¥çš„è´Ÿé¢å½±å“ï¼Œä¿è¯æ¨¡å‹åœ¨å¤šæŒ‡ä»¤åœºæ™¯ä¸‹çš„æ€§èƒ½ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šè®ºæ–‡æ²¡æœ‰æå‡ºä¸€ä¸ªå…¨æ–°çš„æŠ€æœ¯æ¡†æ¶ï¼Œè€Œæ˜¯ç€é‡äºåˆ†æç°æœ‰KVç¼“å­˜å‹ç¼©æ–¹æ³•åœ¨ç‰¹å®šåœºæ™¯ä¸‹çš„ä¸è¶³ï¼Œå¹¶æå‡ºæ”¹è¿›ç­–ç•¥ã€‚å…¶ç ”ç©¶æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š1) é€‰å–ä¸åŒçš„KVç¼“å­˜å‹ç¼©æ–¹æ³•å’Œå¤šæŒ‡ä»¤ä»»åŠ¡ï¼›2) é€šè¿‡å®éªŒè§‚å¯Ÿå‹ç¼©å¯¹ä¸åŒæŒ‡ä»¤çš„å½±å“ï¼Œç‰¹åˆ«æ˜¯å¯¹ç³»ç»Ÿæç¤ºæ³„éœ²çš„å½±å“ï¼›3) åˆ†æå¯¼è‡´æŒ‡ä»¤æ€§èƒ½é€€åŒ–çš„å› ç´ ï¼Œå¦‚å‹ç¼©æ–¹æ³•ã€æŒ‡ä»¤é¡ºåºå’ŒKVé©±é€åå·®ï¼›4) æå‡ºæ”¹è¿›çš„KVç¼“å­˜é©±é€ç­–ç•¥ï¼Œå¹¶é€šè¿‡å®éªŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**å…³é”®åˆ›æ–°**ï¼šè®ºæ–‡çš„å…³é”®åˆ›æ–°åœ¨äºå‘ç°äº†KVç¼“å­˜å‹ç¼©åœ¨å¤šæŒ‡ä»¤åœºæ™¯ä¸‹çš„æ½œåœ¨é—®é¢˜ï¼Œå¹¶æ·±å…¥åˆ†æäº†å¯¼è‡´è¿™äº›é—®é¢˜çš„å› ç´ ã€‚ä»¥å¾€çš„ç ”ç©¶ä¸»è¦å…³æ³¨å‹ç¼©å¸¦æ¥çš„ååé‡æå‡å’Œèµ„æºèŠ‚çœï¼Œè€Œå¿½ç•¥äº†åœ¨å¤æ‚åœºæ™¯ä¸‹å¯èƒ½å‡ºç°çš„æ€§èƒ½é€€åŒ–ã€‚æœ¬æ–‡çš„ç ”ç©¶å¡«è¡¥äº†è¿™ä¸€ç©ºç™½ï¼Œä¸ºKVç¼“å­˜å‹ç¼©çš„å®é™…åº”ç”¨æä¾›äº†é‡è¦çš„å‚è€ƒã€‚

**å…³é”®è®¾è®¡**ï¼šè®ºæ–‡çš„å…³é”®è®¾è®¡åœ¨äºå¯¹KVç¼“å­˜é©±é€ç­–ç•¥çš„æ”¹è¿›ã€‚å…·ä½“æ¥è¯´ï¼Œè®ºæ–‡å¯èƒ½æå‡ºäº†æ›´æ™ºèƒ½çš„é©±é€ç®—æ³•ï¼Œä¾‹å¦‚ï¼Œæ ¹æ®æŒ‡ä»¤çš„é‡è¦æ€§æˆ–ä¾èµ–å…³ç³»ï¼Œå¯¹ä¸åŒçš„KVæ¡ç›®èµ‹äºˆä¸åŒçš„ä¼˜å…ˆçº§ï¼Œä»è€Œä¿è¯å…³é”®æŒ‡ä»¤çš„KVæ¡ç›®ä¸æ˜“è¢«é©±é€ã€‚æ­¤å¤–ï¼Œè®ºæ–‡å¯èƒ½è¿˜è€ƒè™‘äº†æŒ‡ä»¤é¡ºåºçš„å½±å“ï¼Œæå‡ºäº†ä¸€äº›é¢„å¤„ç†æ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¯¹æŒ‡ä»¤è¿›è¡Œæ’åºæˆ–åˆ†ç»„ï¼Œä»¥å‡å°‘å‹ç¼©å¸¦æ¥çš„ä¿¡æ¯æŸå¤±ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

è®ºæ–‡é€šè¿‡å®éªŒè¯æ˜ï¼ŒKVç¼“å­˜å‹ç¼©ä¼šå¯¼è‡´ç³»ç»Ÿæç¤ºæ³„éœ²ï¼Œå¹¶ä¸”å‹ç¼©æ–¹æ³•ã€æŒ‡ä»¤é¡ºåºå’ŒKVé©±é€åå·®éƒ½ä¼šå½±å“æ³„éœ²ç¨‹åº¦ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè®ºæ–‡æå‡ºçš„æ”¹è¿›KVç¼“å­˜é©±é€ç­–ç•¥èƒ½å¤Ÿæœ‰æ•ˆå‡å°‘è¿™äº›å› ç´ çš„å½±å“ï¼Œä»è€Œæé«˜å¤šæŒ‡ä»¤ä»»åŠ¡çš„æ•´ä½“æ€§èƒ½ã€‚å…·ä½“çš„æ€§èƒ½æå‡æ•°æ®ï¼ˆä¾‹å¦‚ï¼Œåœ¨ç‰¹å®šä»»åŠ¡ä¸Šçš„å‡†ç¡®ç‡æå‡ç™¾åˆ†æ¯”ï¼‰éœ€è¦åœ¨è®ºæ–‡ä¸­æŸ¥æ‰¾ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæœå¯åº”ç”¨äºå„ç§éœ€è¦é«˜æ•ˆåˆ©ç”¨å†…å­˜èµ„æºçš„å¤§å‹è¯­è¨€æ¨¡å‹éƒ¨ç½²åœºæ™¯ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦å¤„ç†å¤æ‚æŒ‡ä»¤æˆ–å¤šè½®å¯¹è¯çš„åº”ç”¨ä¸­ï¼Œä¾‹å¦‚æ™ºèƒ½åŠ©æ‰‹ã€èŠå¤©æœºå™¨äººã€ä»£ç ç”Ÿæˆç­‰ã€‚é€šè¿‡æ”¹è¿›KVç¼“å­˜å‹ç¼©ç­–ç•¥ï¼Œå¯ä»¥æé«˜æ¨¡å‹çš„ååé‡å’Œæ•ˆç‡ï¼ŒåŒæ—¶ä¿è¯å…¶æ€§èƒ½å’Œå¯é æ€§ï¼Œä»è€Œæå‡ç”¨æˆ·ä½“éªŒã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> KV cache compression promises increased throughput and efficiency with negligible loss in performance. While the gains in throughput are indisputable and recent literature has indeed shown minimal degradation on particular benchmarks, in general the consequences of compression in realistic scenarios such as multi-instruction prompting have been insufficiently studied. In this paper, we identify several pitfalls practitioners should be aware of when deploying KV cache compressed LLMs. Importantly, we show that certain instructions degrade much more rapidly with compression, effectively causing them to be completely ignored by the LLM. As a practical example of that, we highlight system prompt leakage as a case study, empirically showing the impact of compression on leakage and general instruction following. We show several factors that play a role in prompt leakage: compression method, instruction order, and KV eviction bias. We then propose simple changes to KV cache eviction policies that can reduce the impact of these factors and improve the overall performance in multi-instruction tasks.

