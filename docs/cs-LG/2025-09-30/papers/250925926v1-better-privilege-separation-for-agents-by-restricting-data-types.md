---
layout: default
title: Better Privilege Separation for Agents by Restricting Data Types
---

# Better Privilege Separation for Agents by Restricting Data Types

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.25926" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.25926v1</a>
  <a href="https://arxiv.org/pdf/2509.25926.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.25926v1" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.25926v1', 'Better Privilege Separation for Agents by Restricting Data Types')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Dennis Jacob, Emad Alghamdi, Zhanhao Hu, Basel Alomair, David Wagner

**åˆ†ç±»**: cs.CR, cs.LG

**å‘å¸ƒæ—¥æœŸ**: 2025-09-30

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºåŸºäºæ•°æ®ç±»å‹é™åˆ¶çš„ç‰¹æƒåˆ†ç¦»æ–¹æ³•ï¼Œç³»ç»Ÿæ€§é˜²å¾¡LLMä¸­çš„Promptæ³¨å…¥æ”»å‡»ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¹ï¼šå…·èº«å¤§æ¨¡å‹ (Embodied Foundation Models)**

**å…³é”®è¯**: `Promptæ³¨å…¥` `å¤§å‹è¯­è¨€æ¨¡å‹` `ç‰¹æƒåˆ†ç¦»` `æ•°æ®ç±»å‹` `å®‰å…¨` `AIä»£ç†` `è®¿é—®æ§åˆ¶`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰LLMæ˜“å—Promptæ³¨å…¥æ”»å‡»ï¼Œä¼ ç»Ÿé˜²å¾¡æ–¹æ³•å¦‚æ£€æµ‹å™¨å’Œå¾®è°ƒå­˜åœ¨æ˜“å—æ”»å‡»æˆ–å…¼å®¹æ€§é—®é¢˜ã€‚
2. è®ºæ–‡æå‡ºç±»å‹å¯¼å‘çš„ç‰¹æƒåˆ†ç¦»æ–¹æ³•ï¼Œé€šè¿‡é™åˆ¶LLMå¤„ç†çš„æ•°æ®ç±»å‹æ¥é˜²å¾¡Promptæ³¨å…¥ã€‚
3. å®éªŒè¡¨æ˜ï¼Œè¯¥æ–¹æ³•èƒ½åœ¨ç»´æŒLLMå®ç”¨æ€§çš„åŒæ—¶ï¼Œæœ‰æ•ˆé˜²å¾¡Promptæ³¨å…¥æ”»å‡»ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰å› å…¶ä¸éç»“æ„åŒ–å†…å®¹äº¤äº’çš„èƒ½åŠ›è€Œæ—¥ç›Šæ™®åŠã€‚LLMsç°åœ¨æ˜¯AIä»£ç†ç­‰è¯­è¨€å¤„ç†ç³»ç»Ÿè‡ªåŠ¨åŒ–çš„å…³é”®é©±åŠ¨åŠ›ã€‚ç„¶è€Œï¼Œè¿™äº›ä¼˜åŠ¿ä¹Ÿå¸¦æ¥äº†promptæ³¨å…¥çš„æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ³¨å…¥ä»»åŠ¡æ¥ç ´åLLMçš„é¢„æœŸåŠŸèƒ½ã€‚ä»¥å¾€çš„æ–¹æ³•æå‡ºäº†æ£€æµ‹å™¨å’Œå¾®è°ƒæ¥æä¾›é²æ£’æ€§ï¼Œä½†è¿™äº›æŠ€æœ¯å®¹æ˜“å—åˆ°è‡ªé€‚åº”æ”»å‡»ï¼Œæˆ–è€…æ— æ³•ä¸æœ€å…ˆè¿›çš„æ¨¡å‹ä¸€èµ·ä½¿ç”¨ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§é’ˆå¯¹LLMçš„ç±»å‹å¯¼å‘ç‰¹æƒåˆ†ç¦»æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥ç³»ç»Ÿåœ°é˜²æ­¢promptæ³¨å…¥ã€‚æˆ‘ä»¬é€šè¿‡å°†ä¸å—ä¿¡ä»»çš„å†…å®¹è½¬æ¢ä¸ºä¸€ç»„ç²¾å¿ƒç­–åˆ’çš„æ•°æ®ç±»å‹æ¥é™åˆ¶LLMä¸ç¬¬ä¸‰æ–¹æ•°æ®äº¤äº’çš„èƒ½åŠ›ï¼›ä¸åŸå§‹å­—ç¬¦ä¸²ä¸åŒï¼Œæ¯ç§æ•°æ®ç±»å‹çš„èŒƒå›´å’Œå†…å®¹éƒ½å—åˆ°é™åˆ¶ï¼Œä»è€Œæ¶ˆé™¤äº†promptæ³¨å…¥çš„å¯èƒ½æ€§ã€‚æˆ‘ä»¬åœ¨å‡ ä¸ªæ¡ˆä¾‹ç ”ç©¶ä¸­è¯„ä¼°äº†æˆ‘ä»¬çš„æ–¹æ³•ï¼Œå‘ç°åˆ©ç”¨æˆ‘ä»¬åŸåˆ™çš„è®¾è®¡å¯ä»¥ç³»ç»Ÿåœ°é˜²æ­¢promptæ³¨å…¥æ”»å‡»ï¼ŒåŒæ—¶ä¿æŒé«˜å®ç”¨æ€§ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰ä¸­æ™®éå­˜åœ¨çš„Promptæ³¨å…¥æ”»å‡»é—®é¢˜ã€‚ç°æœ‰çš„é˜²å¾¡æ–¹æ³•ï¼Œä¾‹å¦‚Promptæ³¨å…¥æ£€æµ‹å™¨å’Œæ¨¡å‹å¾®è°ƒï¼Œè¦ä¹ˆå®¹æ˜“å—åˆ°å¯¹æŠ—æ€§æ”»å‡»çš„è§„é¿ï¼Œè¦ä¹ˆæ— æ³•åº”ç”¨äºæœ€æ–°çš„LLMæ¨¡å‹ï¼Œå› æ­¤éœ€è¦ä¸€ç§æ›´æœ‰æ•ˆå’Œé€šç”¨çš„é˜²å¾¡æœºåˆ¶ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šæ ¸å¿ƒæ€è·¯æ˜¯é€šè¿‡é™åˆ¶LLMèƒ½å¤Ÿå¤„ç†çš„æ•°æ®ç±»å‹æ¥å®ç°ç‰¹æƒåˆ†ç¦»ã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯å°†æ¥è‡ªç¬¬ä¸‰æ–¹çš„ä¸å—ä¿¡ä»»çš„è¾“å…¥æ•°æ®è½¬æ¢ä¸ºé¢„å®šä¹‰çš„ã€èŒƒå›´å—é™çš„æ•°æ®ç±»å‹ï¼Œè€Œä¸æ˜¯ç›´æ¥è®©LLMå¤„ç†åŸå§‹å­—ç¬¦ä¸²ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢æ¶æ„Promptè¢«æ³¨å…¥åˆ°LLMçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä»è€Œé¿å…LLMæ‰§è¡Œéé¢„æœŸçš„æ“ä½œã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šè¯¥æ–¹æ³•çš„æ ¸å¿ƒåœ¨äºæ•°æ®ç±»å‹è½¬æ¢å’Œç‰¹æƒåˆ†ç¦»ã€‚æ•´ä½“æµç¨‹å¦‚ä¸‹ï¼š1. æ¥æ”¶æ¥è‡ªç¬¬ä¸‰æ–¹çš„ä¸å—ä¿¡ä»»çš„è¾“å…¥æ•°æ®ã€‚2. å°†è¾“å…¥æ•°æ®è½¬æ¢ä¸ºé¢„å®šä¹‰çš„ã€èŒƒå›´å—é™çš„æ•°æ®ç±»å‹ã€‚3. LLMä»…èƒ½è®¿é—®å’Œå¤„ç†è¿™äº›å—é™çš„æ•°æ®ç±»å‹ï¼Œè€Œæ— æ³•ç›´æ¥è®¿é—®åŸå§‹çš„ã€ä¸å—ä¿¡ä»»çš„è¾“å…¥æ•°æ®ã€‚4. LLMåŸºäºå—é™çš„æ•°æ®ç±»å‹æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶å°†ç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚

**å…³é”®åˆ›æ–°**ï¼šå…³é”®åˆ›æ–°åœ¨äºä½¿ç”¨æ•°æ®ç±»å‹ä½œä¸ºä¸€ç§å¼ºåˆ¶æ€§çš„è®¿é—®æ§åˆ¶æœºåˆ¶ã€‚é€šè¿‡é™åˆ¶LLMèƒ½å¤Ÿå¤„ç†çš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥æœ‰æ•ˆåœ°éš”ç¦»LLMä¸ä¸å—ä¿¡ä»»çš„è¾“å…¥æ•°æ®ï¼Œä»è€Œé˜²æ­¢Promptæ³¨å…¥æ”»å‡»ã€‚ä¸ä¼ ç»Ÿçš„æ£€æµ‹æˆ–è¿‡æ»¤æ–¹æ³•ä¸åŒï¼Œè¯¥æ–¹æ³•ä»æ ¹æœ¬ä¸Šé˜»æ­¢äº†æ¶æ„Promptçš„æ‰§è¡Œã€‚

**å…³é”®è®¾è®¡**ï¼šå…³é”®è®¾è®¡åœ¨äºå®šä¹‰åˆé€‚çš„å—é™æ•°æ®ç±»å‹ã€‚è¿™äº›æ•°æ®ç±»å‹éœ€è¦è¶³å¤Ÿè¡¨è¾¾LLMæ‰€éœ€çš„ä¿¡æ¯ï¼ŒåŒæ—¶åˆè¶³å¤Ÿå®‰å…¨ï¼Œä»¥é˜²æ­¢Promptæ³¨å…¥æ”»å‡»ã€‚å…·ä½“çš„æ•°æ®ç±»å‹è®¾è®¡å–å†³äºå…·ä½“çš„åº”ç”¨åœºæ™¯å’ŒLLMçš„ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªé—®ç­”ç³»ç»Ÿï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªâ€œé—®é¢˜â€æ•°æ®ç±»å‹ï¼Œè¯¥ç±»å‹åªå…è®¸åŒ…å«ç”¨æˆ·æå‡ºçš„é—®é¢˜ï¼Œè€Œä¸å…è®¸åŒ…å«ä»»ä½•å…¶ä»–ç±»å‹çš„æŒ‡ä»¤æˆ–ä»£ç ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

è®ºæ–‡é€šè¿‡å¤šä¸ªæ¡ˆä¾‹ç ”ç©¶éªŒè¯äº†è¯¥æ–¹æ³•çš„æœ‰æ•ˆæ€§ã€‚å®éªŒç»“æœè¡¨æ˜ï¼ŒåŸºäºæ•°æ®ç±»å‹é™åˆ¶çš„ç‰¹æƒåˆ†ç¦»æ–¹æ³•èƒ½å¤Ÿæœ‰æ•ˆåœ°é˜²å¾¡Promptæ³¨å…¥æ”»å‡»ï¼ŒåŒæ—¶ä¿æŒLLMçš„å®ç”¨æ€§ã€‚å…·ä½“çš„æ€§èƒ½æ•°æ®å’Œå¯¹æ¯”åŸºçº¿åœ¨è®ºæ–‡ä¸­è¿›è¡Œäº†è¯¦ç»†çš„æè¿°ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæœå¯åº”ç”¨äºå„ç§åŸºäºLLMçš„AIä»£ç†å’Œè‡ªåŠ¨åŒ–ç³»ç»Ÿï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦å¤„ç†æ¥è‡ªä¸å¯ä¿¡æ¥æºæ•°æ®çš„åœºæ™¯ä¸­ã€‚ä¾‹å¦‚ï¼Œæ™ºèƒ½å®¢æœã€è‡ªåŠ¨åŒ–æ–‡æ¡£å¤„ç†ã€ä»£ç ç”Ÿæˆç­‰ã€‚é€šè¿‡é˜²æ­¢Promptæ³¨å…¥æ”»å‡»ï¼Œå¯ä»¥æé«˜è¿™äº›ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œå¯é æ€§ï¼Œé™ä½æ½œåœ¨çš„é£é™©ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Large language models (LLMs) have become increasingly popular due to their ability to interact with unstructured content. As such, LLMs are now a key driver behind the automation of language processing systems, such as AI agents. Unfortunately, these advantages have come with a vulnerability to prompt injections, an attack where an adversary subverts the LLM's intended functionality with an injected task. Past approaches have proposed detectors and finetuning to provide robustness, but these techniques are vulnerable to adaptive attacks or cannot be used with state-of-the-art models. To this end we propose type-directed privilege separation for LLMs, a method that systematically prevents prompt injections. We restrict the ability of an LLM to interact with third-party data by converting untrusted content to a curated set of data types; unlike raw strings, each data type is limited in scope and content, eliminating the possibility for prompt injections. We evaluate our method across several case studies and find that designs leveraging our principles can systematically prevent prompt injection attacks while maintaining high utility.

