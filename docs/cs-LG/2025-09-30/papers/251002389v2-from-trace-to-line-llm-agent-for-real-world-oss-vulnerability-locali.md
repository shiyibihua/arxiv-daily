---
layout: default
title: From Trace to Line: LLM Agent for Real-World OSS Vulnerability Localization
---

# From Trace to Line: LLM Agent for Real-World OSS Vulnerability Localization

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2510.02389" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2510.02389v2</a>
  <a href="https://arxiv.org/pdf/2510.02389.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2510.02389v2" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2510.02389v2', 'From Trace to Line: LLM Agent for Real-World OSS Vulnerability Localization')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Haoran Xi, Minghao Shao, Brendan Dolan-Gavitt, Muhammad Shafique, Ramesh Karri

**åˆ†ç±»**: cs.SE, cs.CR, cs.LG

**å‘å¸ƒæ—¥æœŸ**: 2025-09-30 (æ›´æ–°: 2025-12-17)

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºT2L-Agentï¼Œç”¨äºå¼€æºè½¯ä»¶æ¼æ´çš„ç²¾å‡†è¡Œçº§å®šä½ä¸ä¿®å¤**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¹ï¼šå…·èº«å¤§æ¨¡å‹ (Embodied Foundation Models)**

**å…³é”®è¯**: `æ¼æ´æ£€æµ‹` `è¡Œçº§å®šä½` `å¤§å‹è¯­è¨€æ¨¡å‹` `è¿è¡Œæ—¶åˆ†æ` `ä»£ç åˆ†æ` `å¼€æºè½¯ä»¶` `è½¯ä»¶å®‰å…¨`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰æ¼æ´æ£€æµ‹æ–¹æ³•ä¾§é‡äºç²—ç²’åº¦çš„æ–‡ä»¶æˆ–å‡½æ•°çº§åˆ«ï¼Œæ— æ³•æä¾›ç²¾ç¡®çš„è¡Œçº§å®šä½ï¼Œé™åˆ¶äº†å®é™…åº”ç”¨ä»·å€¼ã€‚
2. T2L-Agenté€šè¿‡ç»“åˆè¿è¡Œæ—¶ä¿¡æ¯å’Œä»£ç åˆ†æï¼Œè¿­ä»£åœ°ç¼©å°èŒƒå›´ï¼Œæœ€ç»ˆå®šä½åˆ°æ¼æ´ä»£ç çš„å…·ä½“è¡Œã€‚
3. åœ¨T2L-ARVOåŸºå‡†æµ‹è¯•ä¸­ï¼ŒT2L-Agentåœ¨æ¼æ´æ£€æµ‹å’Œè¡Œçº§å®šä½æ–¹é¢æ˜¾è‘—ä¼˜äºç°æœ‰åŸºçº¿æ–¹æ³•ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

å¤§å‹è¯­è¨€æ¨¡å‹åœ¨æ¼æ´å‘ç°æ–¹é¢å±•ç°å‡ºæ½œåŠ›ï¼Œä½†ç°æœ‰æ–¹æ³•å­¤ç«‹åœ°æ£€æŸ¥ä»£ç ï¼Œéš¾ä»¥å¤„ç†é•¿ä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”ä¾§é‡äºç²—ç²’åº¦çš„å‡½æ•°æˆ–æ–‡ä»¶çº§åˆ«æ£€æµ‹ï¼Œè¿™ä¸ºéœ€è¦åœ¨å®é™…è½¯ä»¶å¼€å‘ä¸­è¿›è¡Œç²¾ç¡®è¡Œçº§å®šä½å’Œæœ‰é’ˆå¯¹æ€§è¡¥ä¸çš„å·¥ç¨‹å¸ˆæä¾›çš„å¯æ“ä½œæŒ‡å¯¼æœ‰é™ã€‚æˆ‘ä»¬æå‡ºäº†T2L-Agentï¼ˆTrace-to-Line Agentï¼‰ï¼Œä¸€ä¸ªé¡¹ç›®çº§åˆ«çš„ç«¯åˆ°ç«¯æ¡†æ¶ï¼Œå®ƒå¯ä»¥è§„åˆ’è‡ªå·±çš„åˆ†æï¼Œå¹¶é€æ­¥å°†èŒƒå›´ä»æ¨¡å—ç¼©å°åˆ°ç¡®åˆ‡çš„æ˜“å—æ”»å‡»è¡Œã€‚T2L-Agentå°†å¤šè½®åé¦ˆä¸Agentic Trace Analyzerï¼ˆATAï¼‰ç›¸ç»“åˆï¼ŒATAå°†è¿è¡Œæ—¶è¯æ®ï¼ˆå¦‚å´©æºƒç‚¹ã€å †æ ˆè·Ÿè¸ªå’Œè¦†ç›–ç‡å¢é‡ï¼‰ä¸åŸºäºASTçš„ä»£ç å—ç›¸ç»“åˆï¼Œä»è€Œå®ç°è¶…è¶Šå•æ¬¡é¢„æµ‹çš„è¿­ä»£æ”¹è¿›ï¼Œå¹¶å°†ç—‡çŠ¶è½¬åŒ–ä¸ºå¯æ“ä½œçš„è¡Œçº§è¯Šæ–­ã€‚ä¸ºäº†åŸºå‡†æµ‹è¯•è¡Œçº§æ¼æ´å‘ç°ï¼Œæˆ‘ä»¬å¼•å…¥äº†T2L-ARVOï¼Œè¿™æ˜¯ä¸€ä¸ªå¤šæ ·åŒ–çš„ã€ç»è¿‡ä¸“å®¶éªŒè¯çš„50ä¸ªæ¡ˆä¾‹çš„åŸºå‡†ï¼Œæ¶µç›–äº”ä¸ªå´©æºƒå®¶æ—å’ŒçœŸå®é¡¹ç›®ã€‚T2L-ARVOä¸“é—¨è®¾è®¡ç”¨äºæ”¯æŒç²—ç²’åº¦æ£€æµ‹å’Œç»†ç²’åº¦å®šä½ï¼Œä»è€Œèƒ½å¤Ÿä¸¥æ ¼è¯„ä¼°æ—¨åœ¨è¶…è¶Šæ–‡ä»¶çº§åˆ«é¢„æµ‹çš„ç³»ç»Ÿã€‚åœ¨T2L-ARVOä¸Šï¼ŒT2L-Agentå®ç°äº†é«˜è¾¾58.0%çš„æ£€æµ‹ç‡å’Œ54.8%çš„è¡Œçº§å®šä½ç‡ï¼Œå¤§å¤§ä¼˜äºåŸºçº¿ã€‚è¯¥æ¡†æ¶å’ŒåŸºå‡†å…±åŒæ¨åŠ¨äº†åŸºäºLLMçš„æ¼æ´æ£€æµ‹ä»ç²—ç•¥è¯†åˆ«è½¬å‘å¯éƒ¨ç½²çš„ã€ç¨³å¥çš„ã€ç²¾ç¡®çš„è¯Šæ–­ï¼Œä»è€Œå‡å°‘äº†å™ªå£°å¹¶åŠ é€Ÿäº†å¼€æºè½¯ä»¶å·¥ä½œæµç¨‹ä¸­çš„ä¿®è¡¥ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šç°æœ‰åŸºäºLLMçš„æ¼æ´æ£€æµ‹æ–¹æ³•é€šå¸¸åªèƒ½å®šä½åˆ°æ–‡ä»¶æˆ–å‡½æ•°çº§åˆ«ï¼Œæ— æ³•æä¾›æ¼æ´çš„å…·ä½“ä½ç½®ï¼Œè¿™ä½¿å¾—å¼€å‘äººå‘˜éš¾ä»¥å¿«é€Ÿä¿®å¤æ¼æ´ã€‚ç°æœ‰æ–¹æ³•åœ¨å¤„ç†é•¿ä¸Šä¸‹æ–‡å’Œèåˆè¿è¡Œæ—¶ä¿¡æ¯æ–¹é¢å­˜åœ¨ä¸è¶³ï¼Œå¯¼è‡´å®šä½ç²¾åº¦è¾ƒä½ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šT2L-Agentçš„æ ¸å¿ƒæ€è·¯æ˜¯å°†è¿è¡Œæ—¶ä¿¡æ¯ï¼ˆå¦‚å´©æºƒç‚¹ã€å †æ ˆè·Ÿè¸ªï¼‰ä¸é™æ€ä»£ç åˆ†æç›¸ç»“åˆï¼Œé€šè¿‡å¤šè½®è¿­ä»£çš„æ–¹å¼é€æ­¥ç¼©å°æœç´¢èŒƒå›´ï¼Œæœ€ç»ˆå®šä½åˆ°æ¼æ´ä»£ç çš„å…·ä½“è¡Œã€‚è¿™ç§æ–¹æ³•æ¨¡æ‹Ÿäº†äººå·¥è°ƒè¯•çš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°åˆ©ç”¨LLMçš„æ¨ç†èƒ½åŠ›ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šT2L-AgentåŒ…å«ä»¥ä¸‹ä¸»è¦æ¨¡å—ï¼š1) é¡¹ç›®çº§åˆ†æè§„åˆ’å™¨ï¼šè´Ÿè´£åˆ¶å®šåˆ†æç­–ç•¥ï¼Œç¡®å®šéœ€è¦åˆ†æçš„æ¨¡å—å’Œæ–‡ä»¶ã€‚2) Agentic Trace Analyzer (ATA)ï¼šæ ¸å¿ƒæ¨¡å—ï¼Œè´Ÿè´£èåˆè¿è¡Œæ—¶ä¿¡æ¯å’Œä»£ç åˆ†æï¼Œè¿­ä»£åœ°ç¼©å°æœç´¢èŒƒå›´ã€‚ATAä½¿ç”¨åŸºäºASTçš„ä»£ç å—åˆ’åˆ†æ–¹æ³•ï¼Œå°†ä»£ç åˆ†è§£ä¸ºæ›´å°çš„å•å…ƒï¼Œå¹¶ç»“åˆè¿è¡Œæ—¶ä¿¡æ¯è¿›è¡Œåˆ†æã€‚3) å¤šè½®åé¦ˆæœºåˆ¶ï¼šå…è®¸LLMæ ¹æ®åˆ†æç»“æœè¿›è¡Œè‡ªæˆ‘ä¿®æ­£å’Œä¼˜åŒ–ï¼Œæé«˜å®šä½ç²¾åº¦ã€‚

**å…³é”®åˆ›æ–°**ï¼šT2L-Agentçš„å…³é”®åˆ›æ–°åœ¨äºAgentic Trace Analyzer (ATA)çš„è®¾è®¡ï¼Œå®ƒèƒ½å¤Ÿæœ‰æ•ˆåœ°èåˆè¿è¡Œæ—¶ä¿¡æ¯å’Œä»£ç åˆ†æï¼Œå®ç°è¡Œçº§æ¼æ´å®šä½ã€‚ä¸ç°æœ‰æ–¹æ³•ç›¸æ¯”ï¼ŒT2L-Agentèƒ½å¤Ÿæ›´ç²¾ç¡®åœ°å®šä½æ¼æ´ï¼Œå¹¶æä¾›æ›´å…·å¯æ“ä½œæ€§çš„ä¿®å¤å»ºè®®ã€‚æ­¤å¤–ï¼Œå¤šè½®åé¦ˆæœºåˆ¶ä¹Ÿæé«˜äº†å®šä½çš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šATAä½¿ç”¨åŸºäºASTçš„ä»£ç å—åˆ’åˆ†æ–¹æ³•ï¼Œå°†ä»£ç åˆ†è§£ä¸ºæ›´å°çš„å•å…ƒï¼Œä»¥ä¾¿æ›´ç²¾ç¡®åœ°åˆ†æä»£ç ã€‚è¿è¡Œæ—¶ä¿¡æ¯åŒ…æ‹¬å´©æºƒç‚¹ã€å †æ ˆè·Ÿè¸ªå’Œè¦†ç›–ç‡å¢é‡ã€‚ATAä½¿ç”¨LLMè¿›è¡Œæ¨ç†ï¼Œæ ¹æ®è¿è¡Œæ—¶ä¿¡æ¯å’Œä»£ç åˆ†æç»“æœï¼Œåˆ¤æ–­ä»£ç å—æ˜¯å¦åŒ…å«æ¼æ´ã€‚å¤šè½®åé¦ˆæœºåˆ¶å…è®¸LLMæ ¹æ®åˆ†æç»“æœè¿›è¡Œè‡ªæˆ‘ä¿®æ­£å’Œä¼˜åŒ–ï¼Œæé«˜å®šä½ç²¾åº¦ã€‚å…·ä½“çš„å‚æ•°è®¾ç½®å’Œç½‘ç»œç»“æ„åœ¨è®ºæ–‡ä¸­æœªè¯¦ç»†è¯´æ˜ï¼Œå±äºæœªçŸ¥ä¿¡æ¯ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

T2L-Agentåœ¨T2L-ARVOåŸºå‡†æµ‹è¯•ä¸­å–å¾—äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼Œæ¼æ´æ£€æµ‹ç‡è¾¾åˆ°58.0%ï¼Œè¡Œçº§å®šä½ç‡è¾¾åˆ°54.8%ï¼Œå¤§å¹…ä¼˜äºç°æœ‰åŸºçº¿æ–¹æ³•ã€‚è¿™äº›ç»“æœè¡¨æ˜T2L-Agentåœ¨å®é™…åº”ç”¨ä¸­å…·æœ‰å¾ˆé«˜çš„ä»·å€¼ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°å¸®åŠ©å¼€å‘è€…å®šä½å’Œä¿®å¤æ¼æ´ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

T2L-Agentå¯åº”ç”¨äºå¼€æºè½¯ä»¶çš„æ¼æ´è‡ªåŠ¨æ£€æµ‹ä¸ä¿®å¤ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®šä½å’Œä¿®å¤å®‰å…¨æ¼æ´ï¼Œæé«˜è½¯ä»¶å®‰å…¨æ€§ã€‚è¯¥ç ”ç©¶æˆæœæœ‰æœ›é™ä½æ¼æ´ä¿®å¤æˆæœ¬ï¼Œç¼©çŸ­ä¿®å¤å‘¨æœŸï¼Œå¹¶å‡å°‘å› æ¼æ´åˆ©ç”¨é€ æˆçš„å®‰å…¨äº‹ä»¶ã€‚æœªæ¥ï¼Œè¯¥æŠ€æœ¯è¿˜å¯æ‰©å±•åˆ°å…¶ä»–ç±»å‹çš„è½¯ä»¶æ¼æ´æ£€æµ‹ï¼Œå¹¶é›†æˆåˆ°CI/CDæµç¨‹ä¸­ï¼Œå®ç°è‡ªåŠ¨åŒ–å®‰å…¨æµ‹è¯•ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Large language models show promise for vulnerability discovery, yet prevailing methods inspect code in isolation, struggle with long contexts, and focus on coarse function or file level detections which offers limited actionable guidance to engineers who need precise line-level localization and targeted patches in real-world software development. We present T2L-Agent (Trace-to-Line Agent), a project-level, end-to-end framework that plans its own analysis and progressively narrows scope from modules to exact vulnerable lines. T2L-Agent couples multi-round feedback with an Agentic Trace Analyzer (ATA) that fuses run-time evidence such as crash points, stack traces, and coverage deltas with AST-based code chunking, enabling iterative refinement beyond single pass predictions and translating symptoms into actionable, line-level diagnoses. To benchmark line-level vulnerability discovery, we introduce T2L-ARVO, a diverse, expert-verified 50-case benchmark spanning five crash families and real-world projects. T2L-ARVO is specifically designed to support both coarse-grained detection and fine-grained localization, enabling rigorous evaluation of systems that aim to move beyond file-level predictions. On T2L-ARVO, T2L-Agent achieves up to 58.0% detection and 54.8% line-level localization, substantially outperforming baselines. Together, the framework and benchmark push LLM-based vulnerability detection from coarse identification toward deployable, robust, precision diagnostics that reduce noise and accelerate patching in open-source software workflows.

