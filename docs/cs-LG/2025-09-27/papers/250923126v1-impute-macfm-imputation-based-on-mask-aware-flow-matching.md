---
layout: default
title: Impute-MACFM: Imputation based on Mask-Aware Flow Matching
---

# Impute-MACFM: Imputation based on Mask-Aware Flow Matching

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.23126" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.23126v1</a>
  <a href="https://arxiv.org/pdf/2509.23126.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.23126v1" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.23126v1', 'Impute-MACFM: Imputation based on Mask-Aware Flow Matching')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Dengyi Liu, Honggang Wang, Hua Fang

**åˆ†ç±»**: cs.LG

**å‘å¸ƒæ—¥æœŸ**: 2025-09-27

**å¤‡æ³¨**: Preprint, 2025. 9 pages (main) + appendix

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºImpute-MACFMï¼ŒåŸºäºæ©ç æ„ŸçŸ¥æµåŒ¹é…å®ç°æ›´é²æ£’é«˜æ•ˆçš„è¡¨æ ¼æ•°æ®æ’è¡¥ï¼Œå°¤å…¶é€‚ç”¨äºçºµå‘æ•°æ®ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸æ¶æ„ (RL & Architecture)**

**å…³é”®è¯**: `è¡¨æ ¼æ•°æ®æ’è¡¥` `ç¼ºå¤±å€¼å¤„ç†` `æ¡ä»¶æµåŒ¹é…` `æ©ç æ„ŸçŸ¥` `çºµå‘æ•°æ®`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰è¡¨æ ¼æ•°æ®æ’è¡¥æ–¹æ³•å­˜åœ¨å‡è®¾é™åˆ¶ã€éš¾ä»¥å¤„ç†å¤æ‚ç‰¹å¾ç»“æ„ã€ç”Ÿæˆæ¨¡å‹ä¸ç¨³å®šå’Œæ¨ç†æˆæœ¬é«˜ç­‰é—®é¢˜ã€‚
2. Impute-MACFMåˆ©ç”¨æ©ç æ„ŸçŸ¥æ¡ä»¶æµåŒ¹é…ï¼Œä»…åœ¨ç¼ºå¤±å€¼ä¸Šæ„å»ºè½¨è¿¹ï¼Œå¹¶çº¦æŸè§‚æµ‹å€¼é™„è¿‘çš„é¢„æµ‹é€Ÿåº¦ï¼Œä»è€Œè§£å†³ç¼ºå¤±æœºåˆ¶é—®é¢˜ã€‚
3. å®éªŒè¡¨æ˜ï¼ŒImpute-MACFMåœ¨å„ç§åŸºå‡†æµ‹è¯•ä¸­å®ç°äº†æœ€å…ˆè¿›çš„æ’è¡¥æ•ˆæœï¼Œå¹¶å…·æœ‰æ›´å¼ºçš„é²æ£’æ€§å’Œæ›´é«˜çš„æ•ˆç‡ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

è¡¨æ ¼æ•°æ®åœ¨è®¸å¤šåº”ç”¨ä¸­è‡³å…³é‡è¦ï¼Œå°¤å…¶æ˜¯åœ¨åŒ»ç–—ä¿å¥é¢†åŸŸçš„çºµå‘æ•°æ®ä¸­ï¼Œç¼ºå¤±å€¼æ™®éå­˜åœ¨ï¼Œé™ä½äº†æ¨¡å‹çš„ä¿çœŸåº¦å’Œå¯é æ€§ã€‚ä»¥å¾€çš„æ’è¡¥æ–¹æ³•è¦ä¹ˆæ–½åŠ é™åˆ¶æ€§å‡è®¾ï¼Œè¦ä¹ˆéš¾ä»¥å¤„ç†å¤æ‚çš„è·¨ç‰¹å¾ç»“æ„ï¼Œè€Œæœ€è¿‘çš„ç”Ÿæˆæ–¹æ³•åˆ™å­˜åœ¨ä¸ç¨³å®šæ€§å’Œé«˜æ˜‚çš„æ¨ç†æˆæœ¬ã€‚æˆ‘ä»¬æå‡ºäº†Impute-MACFMï¼Œä¸€ä¸ªç”¨äºè¡¨æ ¼æ’è¡¥çš„æ©ç æ„ŸçŸ¥æ¡ä»¶æµåŒ¹é…æ¡†æ¶ï¼Œå¯ä»¥è§£å†³å®Œå…¨éšæœºç¼ºå¤±ã€éšæœºç¼ºå¤±å’Œééšæœºç¼ºå¤±ç­‰ç¼ºå¤±æœºåˆ¶ã€‚å…¶æ©ç æ„ŸçŸ¥ç›®æ ‡ä»…åœ¨ç¼ºå¤±æ¡ç›®ä¸Šæ„å»ºè½¨è¿¹ï¼ŒåŒæ—¶ä½¿ç”¨çµæ´»çš„éçº¿æ€§è°ƒåº¦å°†é¢„æµ‹é€Ÿåº¦çº¦æŸåœ¨è§‚æµ‹æ¡ç›®é™„è¿‘ä¿æŒæ¥è¿‘äºé›¶ã€‚Impute-MACFMç»“åˆäº†ï¼šï¼ˆiï¼‰è§‚æµ‹ä½ç½®çš„ç¨³å®šæ€§æƒ©ç½šï¼Œï¼ˆiiï¼‰å¼ºåˆ¶å±€éƒ¨ä¸å˜æ€§çš„ä¸€è‡´æ€§æ­£åˆ™åŒ–ï¼Œä»¥åŠï¼ˆiiiï¼‰æ•°å€¼ç‰¹å¾çš„æ—¶é—´è¡°å‡å™ªå£°æ³¨å…¥ã€‚æ¨ç†ä½¿ç”¨çº¦æŸä¿æŒå¸¸å¾®åˆ†æ–¹ç¨‹ç§¯åˆ†ï¼Œå¹¶é€šè¿‡æ¯æ­¥æŠ•å½±æ¥å›ºå®šè§‚æµ‹å€¼ï¼Œå¯ä»¥é€‰æ‹©èšåˆå¤šä¸ªè½¨è¿¹ä»¥æé«˜é²æ£’æ€§ã€‚åœ¨å„ç§åŸºå‡†æµ‹è¯•ä¸­ï¼ŒImpute-MACFMå–å¾—äº†æœ€å…ˆè¿›çš„ç»“æœï¼ŒåŒæ—¶æä¾›äº†æ¯”ç«äº‰æ–¹æ³•æ›´é²æ£’ã€é«˜æ•ˆå’Œæ›´é«˜è´¨é‡çš„æ’è¡¥ï¼Œç¡®ç«‹äº†æµåŒ¹é…ä½œä¸ºè¡¨æ ¼ç¼ºå¤±æ•°æ®é—®é¢˜ï¼ˆåŒ…æ‹¬çºµå‘æ•°æ®ï¼‰çš„ä¸€ä¸ªæœ‰å¸Œæœ›çš„æ–¹å‘ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³è¡¨æ ¼æ•°æ®ä¸­ç¼ºå¤±å€¼æ’è¡¥çš„é—®é¢˜ï¼Œå°¤å…¶å…³æ³¨åŒ»ç–—ä¿å¥ç­‰é¢†åŸŸçš„çºµå‘æ•°æ®ã€‚ç°æœ‰æ–¹æ³•çš„ç—›ç‚¹åœ¨äºï¼Œä¼ ç»Ÿæ–¹æ³•å‡è®¾è¿‡äºä¸¥æ ¼ï¼Œæ— æ³•æ•æ‰å¤æ‚çš„ç‰¹å¾é—´å…³ç³»ï¼›è€Œæ–°å…´çš„ç”Ÿæˆæ¨¡å‹åˆ™é¢ä¸´è®­ç»ƒä¸ç¨³å®šå’Œæ¨ç†æˆæœ¬è¿‡é«˜çš„æŒ‘æˆ˜ã€‚æ­¤å¤–ï¼Œè¿˜éœ€è¦è€ƒè™‘ä¸åŒçš„ç¼ºå¤±æœºåˆ¶ï¼ˆMCAR, MAR, MNARï¼‰ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯åˆ©ç”¨æ¡ä»¶æµåŒ¹é…ï¼ˆConditional Flow Matching, CFMï¼‰æ¡†æ¶ï¼Œå­¦ä¹ ä¸€ä¸ªä»å™ªå£°åˆ°çœŸå®æ•°æ®çš„è¿ç»­å˜æ¢ã€‚é€šè¿‡å¼•å…¥æ©ç æ„ŸçŸ¥æœºåˆ¶ï¼Œæ¨¡å‹èƒ½å¤ŸåŒºåˆ†è§‚æµ‹å€¼å’Œç¼ºå¤±å€¼ï¼Œå¹¶æœ‰é’ˆå¯¹æ€§åœ°è¿›è¡Œæ’è¡¥ã€‚å…³é”®åœ¨äºï¼Œæ¨¡å‹åªåœ¨ç¼ºå¤±å€¼çš„ä½ç½®ä¸Šæ„å»ºæµï¼Œè€Œåœ¨è§‚æµ‹å€¼çš„ä½ç½®ä¸Šä¿æŒç¨³å®šï¼Œä»è€Œé¿å…ç ´åå·²æœ‰çš„ä¿¡æ¯ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šImpute-MACFMçš„æ•´ä½“æ¡†æ¶åŸºäºæ¡ä»¶æµåŒ¹é…ã€‚ç»™å®šä¸€ä¸ªåŒ…å«ç¼ºå¤±å€¼çš„è¡¨æ ¼æ•°æ®ï¼Œæ¨¡å‹é¦–å…ˆæ ¹æ®ç¼ºå¤±æ¨¡å¼ç”Ÿæˆä¸€ä¸ªæ©ç ã€‚ç„¶åï¼Œæ¨¡å‹å­¦ä¹ ä¸€ä¸ªæ¡ä»¶å‘é‡åœºï¼Œè¯¥å‘é‡åœºå®šä¹‰äº†ä»å™ªå£°åˆ†å¸ƒåˆ°æ•°æ®åˆ†å¸ƒçš„è¿ç»­è½¨è¿¹ã€‚åœ¨æ¨ç†é˜¶æ®µï¼Œä½¿ç”¨å¸¸å¾®åˆ†æ–¹ç¨‹ï¼ˆODEï¼‰æ±‚è§£å™¨æ²¿ç€è¯¥è½¨è¿¹è¿›è¡Œç§¯åˆ†ï¼Œä»è€Œç”Ÿæˆæ’è¡¥åçš„æ•°æ®ã€‚ä¸ºäº†ä¿è¯æ’è¡¥çš„è´¨é‡ï¼Œæ¨¡å‹è¿˜å¼•å…¥äº†ç¨³å®šæ€§æƒ©ç½šã€ä¸€è‡´æ€§æ­£åˆ™åŒ–å’Œæ—¶é—´è¡°å‡å™ªå£°æ³¨å…¥ç­‰æŠ€æœ¯ã€‚

**å…³é”®åˆ›æ–°**ï¼šImpute-MACFMçš„å…³é”®åˆ›æ–°åœ¨äºå…¶æ©ç æ„ŸçŸ¥æœºåˆ¶ã€‚ä¼ ç»Ÿçš„CFMæ–¹æ³•é€šå¸¸å¿½ç•¥ç¼ºå¤±æ¨¡å¼ï¼Œç›´æ¥å­¦ä¹ ä»å™ªå£°åˆ°å®Œæ•´æ•°æ®çš„æ˜ å°„ã€‚è€ŒImpute-MACFMé€šè¿‡æ˜¾å¼åœ°è€ƒè™‘æ©ç ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ›´åŠ ç²¾ç¡®åœ°æ§åˆ¶æ’è¡¥è¿‡ç¨‹ã€‚æ­¤å¤–ï¼Œè®ºæ–‡è¿˜æå‡ºäº†ä¸€ç³»åˆ—æ­£åˆ™åŒ–æŠ€æœ¯ï¼Œä»¥æé«˜æ¨¡å‹çš„ç¨³å®šæ€§å’Œé²æ£’æ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šåœ¨æŠ€æœ¯ç»†èŠ‚æ–¹é¢ï¼ŒImpute-MACFMä½¿ç”¨äº†çµæ´»çš„éçº¿æ€§è°ƒåº¦å‡½æ•°æ¥æ§åˆ¶å™ªå£°æ³¨å…¥çš„å¼ºåº¦ã€‚ä¸ºäº†ä¿è¯è§‚æµ‹å€¼çš„ç¨³å®šæ€§ï¼Œæ¨¡å‹å¼•å…¥äº†ç¨³å®šæ€§æƒ©ç½šé¡¹ï¼Œè¯¥æƒ©ç½šé¡¹é¼“åŠ±æ¨¡å‹åœ¨è§‚æµ‹å€¼çš„ä½ç½®ä¸Šä¿æŒé¢„æµ‹é€Ÿåº¦æ¥è¿‘äºé›¶ã€‚æ­¤å¤–ï¼Œæ¨¡å‹è¿˜ä½¿ç”¨äº†æ—¶é—´è¡°å‡å™ªå£°æ³¨å…¥ï¼Œä»¥æé«˜æ•°å€¼ç‰¹å¾çš„æ’è¡¥è´¨é‡ã€‚åœ¨æ¨ç†é˜¶æ®µï¼Œæ¨¡å‹ä½¿ç”¨çº¦æŸä¿æŒODEç§¯åˆ†å™¨ï¼Œå¹¶é€šè¿‡æ¯æ­¥æŠ•å½±æ¥ç¡®ä¿è§‚æµ‹å€¼ä¿æŒä¸å˜ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

Impute-MACFMåœ¨å¤šä¸ªè¡¨æ ¼æ•°æ®æ’è¡¥åŸºå‡†æµ‹è¯•ä¸­å–å¾—äº†æœ€å…ˆè¿›çš„ç»“æœã€‚ä¸ç°æœ‰æ–¹æ³•ç›¸æ¯”ï¼ŒImpute-MACFMåœ¨æ’è¡¥è´¨é‡ã€é²æ£’æ€§å’Œæ•ˆç‡æ–¹é¢å‡æœ‰æ˜¾è‘—æå‡ã€‚å…·ä½“æ€§èƒ½æ•°æ®åœ¨è®ºæ–‡ä¸­ç»™å‡ºï¼Œè¡¨æ˜è¯¥æ–¹æ³•åœ¨å¤„ç†ä¸åŒç¼ºå¤±æœºåˆ¶å’Œå¤æ‚æ•°æ®ç»“æ„æ–¹é¢å…·æœ‰ä¼˜è¶Šæ€§ã€‚å®éªŒç»“æœéªŒè¯äº†æµåŒ¹é…åœ¨è¡¨æ ¼æ•°æ®æ’è¡¥é—®é¢˜ä¸Šçš„æœ‰æ•ˆæ€§ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

Impute-MACFMåœ¨åŒ»ç–—å¥åº·ã€é‡‘èã€å¸‚åœºè¥é”€ç­‰é¢†åŸŸå…·æœ‰å¹¿æ³›çš„åº”ç”¨å‰æ™¯ã€‚ä¾‹å¦‚ï¼Œåœ¨åŒ»ç–—é¢†åŸŸï¼Œå¯ä»¥ç”¨äºå¡«è¡¥ç”µå­ç—…å†ä¸­çš„ç¼ºå¤±æ•°æ®ï¼Œä»è€Œæé«˜ç–¾ç—…è¯Šæ–­å’Œé¢„æµ‹çš„å‡†ç¡®æ€§ã€‚åœ¨é‡‘èé¢†åŸŸï¼Œå¯ä»¥ç”¨äºå¡«è¡¥ä¿¡ç”¨è¯„åˆ†æ•°æ®ä¸­çš„ç¼ºå¤±å€¼ï¼Œä»è€Œæé«˜é£é™©è¯„ä¼°çš„å¯é æ€§ã€‚è¯¥ç ”ç©¶æœ‰åŠ©äºæå‡æ•°æ®è´¨é‡ï¼Œä¸ºä¸‹æ¸¸åˆ†æå’Œå†³ç­–æä¾›æ›´å¯é çš„åŸºç¡€ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Tabular data are central to many applications, especially longitudinal data in healthcare, where missing values are common, undermining model fidelity and reliability. Prior imputation methods either impose restrictive assumptions or struggle with complex cross-feature structure, while recent generative approaches suffer from instability and costly inference. We propose Impute-MACFM, a mask-aware conditional flow matching framework for tabular imputation that addresses missingness mechanisms, missing completely at random, missing at random, and missing not at random. Its mask-aware objective builds trajectories only on missing entries while constraining predicted velocity to remain near zero on observed entries, using flexible nonlinear schedules. Impute-MACFM combines: (i) stability penalties on observed positions, (ii) consistency regularization enforcing local invariance, and (iii) time-decayed noise injection for numeric features. Inference uses constraint-preserving ordinary differential equation integration with per-step projection to fix observed values, optionally aggregating multiple trajectories for robustness. Across diverse benchmarks, Impute-MACFM achieves state-of-the-art results while delivering more robust, efficient, and higher-quality imputation than competing approaches, establishing flow matching as a promising direction for tabular missing-data problems, including longitudinal data.

