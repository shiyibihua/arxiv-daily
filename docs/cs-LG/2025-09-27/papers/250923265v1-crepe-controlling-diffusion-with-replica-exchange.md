---
layout: default
title: CREPE: Controlling Diffusion with Replica Exchange
---

# CREPE: Controlling Diffusion with Replica Exchange

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.23265" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.23265v1</a>
  <a href="https://arxiv.org/pdf/2509.23265.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.23265v1" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.23265v1', 'CREPE: Controlling Diffusion with Replica Exchange')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Jiajun He, Paul Jeha, Peter Potaptchik, Leo Zhang, JosÃ© Miguel HernÃ¡ndez-Lobato, Yuanqi Du, Saifuddin Syed, Francisco Vargas

**åˆ†ç±»**: cs.LG

**å‘å¸ƒæ—¥æœŸ**: 2025-09-27

**å¤‡æ³¨**: 29 pages, 14 figures, 3 tables

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**CREPEï¼šåˆ©ç”¨å‰¯æœ¬äº¤æ¢æ§åˆ¶æ‰©æ•£æ¨¡å‹ï¼Œå®ç°æ¨ç†æ—¶çµæ´»å¼•å¯¼ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±å››ï¼šç”Ÿæˆå¼åŠ¨ä½œ (Generative Motion)**

**å…³é”®è¯**: `æ‰©æ•£æ¨¡å‹` `å‰¯æœ¬äº¤æ¢` `æ¨ç†æ—¶æ§åˆ¶` `ç”Ÿæˆæ¨¡å‹` `åºåˆ—è’™ç‰¹å¡æ´›`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰æ‰©æ•£æ¨¡å‹æ§åˆ¶æ–¹æ³•ä¾èµ–å¯å‘å¼å¼•å¯¼æˆ–ä¸SMCè€¦åˆï¼Œå­˜åœ¨å±€é™æ€§ã€‚
2. CREPEåˆ©ç”¨å‰¯æœ¬äº¤æ¢ç®—æ³•ï¼Œé¡ºåºç”Ÿæˆç²’å­å¹¶ä¿æŒæ ·æœ¬å¤šæ ·æ€§ï¼Œå®ç°çµæ´»æ§åˆ¶ã€‚
3. å®éªŒè¡¨æ˜ï¼ŒCREPEåœ¨å¤šç§ä»»åŠ¡ä¸­è¡¨ç°å‡ºè‰²ï¼Œæ€§èƒ½ä¸SMCæ–¹æ³•ç›¸å½“ç”šè‡³æ›´ä¼˜ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æå‡ºäº†ä¸€ç§åŸºäºå‰¯æœ¬äº¤æ¢çš„çµæ´»æ–¹æ³•ï¼Œç”¨äºåœ¨æ¨ç†æ—¶æ§åˆ¶æ‰©æ•£æ¨¡å‹ï¼Œæ—¨åœ¨æ— éœ€é‡æ–°è®­ç»ƒå³å¯å¼•å¯¼æ¨¡å‹è¾“å‡ºä»¥æ»¡è¶³æ–°çš„çº¦æŸã€‚è¯¥æ–¹æ³•è¢«ç§°ä¸ºCREPEï¼ˆåˆ©ç”¨å‰¯æœ¬äº¤æ¢è¿›è¡Œæ§åˆ¶ï¼‰ã€‚ä¸åºåˆ—è’™ç‰¹å¡æ´›ï¼ˆSMCï¼‰ä¸åŒï¼ŒCREPEï¼šï¼ˆ1ï¼‰é¡ºåºç”Ÿæˆç²’å­ï¼Œï¼ˆ2ï¼‰åœ¨burn-iné˜¶æ®µåä¿æŒç”Ÿæˆæ ·æœ¬çš„é«˜åº¦å¤šæ ·æ€§ï¼Œä»¥åŠï¼ˆ3ï¼‰æ”¯æŒåœ¨çº¿ç»†åŒ–æˆ–æå‰ç»ˆæ­¢ã€‚æˆ‘ä»¬é€šè¿‡å„ç§ä»»åŠ¡å±•ç¤ºäº†å…¶å¤šåŠŸèƒ½æ€§ï¼ŒåŒ…æ‹¬æ¸©åº¦é€€ç«ã€å¥–åŠ±å€¾æ–œã€æ¨¡å‹ç»„åˆå’Œæ— åˆ†ç±»å™¨å¼•å¯¼å»åï¼Œä¸å…ˆå‰çš„SMCæ–¹æ³•ç›¸æ¯”å…·æœ‰ç«äº‰åŠ›çš„æ€§èƒ½ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šç°æœ‰æ‰©æ•£æ¨¡å‹åœ¨æ¨ç†æ—¶è¿›è¡Œæ§åˆ¶ï¼Œé€šå¸¸éœ€è¦æ»¡è¶³æ–°çš„çº¦æŸæ¡ä»¶ï¼Œè€Œæ— éœ€é‡æ–°è®­ç»ƒæ¨¡å‹ã€‚ç„¶è€Œï¼Œå…ˆå‰çš„æ–¹æ³•ä¸»è¦ä¾èµ–äºå¯å‘å¼å¼•å¯¼ï¼Œæˆ–è€…ä¸åºåˆ—è’™ç‰¹å¡æ´›ï¼ˆSMCï¼‰æ–¹æ³•è€¦åˆè¿›è¡Œåå·®æ ¡æ­£ã€‚è¿™äº›æ–¹æ³•å¯èƒ½å­˜åœ¨å¼•å¯¼æ•ˆæœä¸ä½³ã€è®¡ç®—æˆæœ¬é«˜æ˜‚æˆ–æ ·æœ¬å¤šæ ·æ€§ä¸è¶³ç­‰é—®é¢˜ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šCREPEçš„æ ¸å¿ƒæ€è·¯æ˜¯å€Ÿé‰´å‰¯æœ¬äº¤æ¢ç®—æ³•çš„æ€æƒ³ï¼Œè¯¥ç®—æ³•æœ€åˆç”¨äºè§£å†³é‡‡æ ·é—®é¢˜ã€‚é€šè¿‡ç»´æŠ¤å¤šä¸ªâ€œå‰¯æœ¬â€ï¼ˆreplicasï¼‰ï¼Œæ¯ä¸ªå‰¯æœ¬å¯¹åº”ä¸åŒçš„çº¦æŸæ¡ä»¶æˆ–ç›®æ ‡å‡½æ•°ï¼Œå¹¶åœ¨å‰¯æœ¬ä¹‹é—´è¿›è¡Œäº¤æ¢ï¼Œä»è€Œä¿ƒè¿›æ ·æœ¬çš„å¤šæ ·æ€§ï¼Œå¹¶å…è®¸æ¨¡å‹åœ¨ä¸åŒçº¦æŸä¹‹é—´è¿›è¡Œæ¢ç´¢ã€‚è¿™ç§æ–¹æ³•èƒ½å¤Ÿæ›´çµæ´»åœ°å¼•å¯¼æ‰©æ•£æ¨¡å‹çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œä»¥æ»¡è¶³ç‰¹å®šçš„éœ€æ±‚ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šCREPEçš„æ•´ä½“æ¡†æ¶åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªä¸»è¦é˜¶æ®µï¼š1ï¼‰åˆå§‹åŒ–ï¼šåˆ›å»ºå¤šä¸ªå‰¯æœ¬ï¼Œæ¯ä¸ªå‰¯æœ¬å¯¹åº”ä¸åŒçš„ç›®æ ‡æˆ–çº¦æŸã€‚2ï¼‰æ‰©æ•£è¿‡ç¨‹ï¼šåœ¨æ¯ä¸ªå‰¯æœ¬ä¸­ï¼Œè¿è¡Œæ‰©æ•£æ¨¡å‹çš„é€†è¿‡ç¨‹ï¼Œç”Ÿæˆæ ·æœ¬ã€‚3ï¼‰å‰¯æœ¬äº¤æ¢ï¼šæ ¹æ®ä¸€å®šçš„å‡†åˆ™ï¼ˆä¾‹å¦‚ï¼ŒMetropolis-Hastingså‡†åˆ™ï¼‰ï¼Œåœ¨å‰¯æœ¬ä¹‹é—´äº¤æ¢æ ·æœ¬ã€‚4ï¼‰è¿­ä»£ï¼šé‡å¤æ­¥éª¤2å’Œ3ï¼Œç›´åˆ°è¾¾åˆ°æ”¶æ•›æˆ–æ»¡è¶³åœæ­¢æ¡ä»¶ã€‚5ï¼‰è¾“å‡ºï¼šé€‰æ‹©æ»¡è¶³ç‰¹å®šçº¦æŸæˆ–ç›®æ ‡çš„å‰¯æœ¬ä¸­çš„æ ·æœ¬ä½œä¸ºæœ€ç»ˆè¾“å‡ºã€‚

**å…³é”®åˆ›æ–°**ï¼šCREPEçš„å…³é”®åˆ›æ–°åœ¨äºå°†å‰¯æœ¬äº¤æ¢ç®—æ³•åº”ç”¨äºæ‰©æ•£æ¨¡å‹çš„æ§åˆ¶ã€‚ä¸ä¼ ç»Ÿçš„SMCæ–¹æ³•ç›¸æ¯”ï¼ŒCREPEèƒ½å¤Ÿé¡ºåºç”Ÿæˆç²’å­ï¼Œå¹¶åœ¨burn-iné˜¶æ®µåä¿æŒç”Ÿæˆæ ·æœ¬çš„é«˜åº¦å¤šæ ·æ€§ã€‚æ­¤å¤–ï¼ŒCREPEè¿˜æ”¯æŒåœ¨çº¿ç»†åŒ–æˆ–æå‰ç»ˆæ­¢ï¼Œä»è€Œæé«˜äº†æ•ˆç‡å’Œçµæ´»æ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šCREPEçš„å…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1ï¼‰å‰¯æœ¬æ•°é‡çš„é€‰æ‹©ï¼šå‰¯æœ¬æ•°é‡ä¼šå½±å“æ ·æœ¬çš„å¤šæ ·æ€§å’Œè®¡ç®—æˆæœ¬ã€‚2ï¼‰äº¤æ¢å‡†åˆ™çš„è®¾è®¡ï¼šäº¤æ¢å‡†åˆ™å†³å®šäº†å‰¯æœ¬ä¹‹é—´æ ·æœ¬çš„äº¤æ¢æ¦‚ç‡ï¼Œéœ€è¦æ ¹æ®å…·ä½“ä»»åŠ¡è¿›è¡Œè°ƒæ•´ã€‚3ï¼‰ç›®æ ‡å‡½æ•°çš„å®šä¹‰ï¼šç›®æ ‡å‡½æ•°ç”¨äºè¡¡é‡æ ·æœ¬ä¸ç›®æ ‡çº¦æŸä¹‹é—´çš„åŒ¹é…ç¨‹åº¦ï¼Œéœ€è¦æ ¹æ®å…·ä½“ä»»åŠ¡è¿›è¡Œè®¾è®¡ã€‚4ï¼‰æ¸©åº¦å‚æ•°çš„è®¾ç½®ï¼šæ¸©åº¦å‚æ•°æ§åˆ¶äº†å‰¯æœ¬ä¹‹é—´çš„å·®å¼‚ç¨‹åº¦ï¼Œéœ€è¦è¿›è¡Œé€‚å½“çš„è°ƒæ•´ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼ŒCREPEåœ¨æ¸©åº¦é€€ç«ã€å¥–åŠ±å€¾æ–œã€æ¨¡å‹ç»„åˆå’Œæ— åˆ†ç±»å™¨å¼•å¯¼å»åç­‰ä»»åŠ¡ä¸­è¡¨ç°å‡ºè‰²ï¼Œä¸å…ˆå‰çš„SMCæ–¹æ³•ç›¸æ¯”å…·æœ‰ç«äº‰åŠ›çš„æ€§èƒ½ã€‚å…·ä½“æ¥è¯´ï¼ŒCREPEèƒ½å¤Ÿç”Ÿæˆæ›´å¤šæ ·åŒ–çš„æ ·æœ¬ï¼Œå¹¶æ›´å¿«åœ°æ”¶æ•›åˆ°ç›®æ ‡åˆ†å¸ƒã€‚è¿™äº›ç»“æœéªŒè¯äº†CREPEçš„æœ‰æ•ˆæ€§å’Œä¼˜è¶Šæ€§ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

CREPEåœ¨å›¾åƒç”Ÿæˆã€æ–‡æœ¬ç”Ÿæˆã€éŸ³é¢‘ç”Ÿæˆç­‰é¢†åŸŸå…·æœ‰å¹¿æ³›çš„åº”ç”¨å‰æ™¯ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ç”¨äºç”Ÿæˆå…·æœ‰ç‰¹å®šé£æ ¼æˆ–å±æ€§çš„å›¾åƒï¼Œç”Ÿæˆæ»¡è¶³ç‰¹å®šçº¦æŸæ¡ä»¶çš„æ–‡æœ¬ï¼Œæˆ–è€…ç”Ÿæˆå…·æœ‰ç‰¹å®šéŸ³è‰²çš„éŸ³é¢‘ã€‚æ­¤å¤–ï¼ŒCREPEè¿˜å¯ä»¥ç”¨äºæ¨¡å‹ç»„åˆå’Œæ— åˆ†ç±»å™¨å¼•å¯¼å»åç­‰ä»»åŠ¡ï¼Œå…·æœ‰é‡è¦çš„å®é™…ä»·å€¼å’Œæ½œåœ¨çš„æœªæ¥å½±å“ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Inference-time control of diffusion models aims to steer model outputs to satisfy new constraints without retraining. Previous approaches have mostly relied on heuristic guidance or have been coupled with Sequential Monte Carlo (SMC) for bias correction. In this paper, we propose a flexible alternative based on replica exchange, an algorithm designed initially for sampling problems. We refer to this method as the CREPE (Controlling with REPlica Exchange). Unlike SMC, CREPE: (1) generates particles sequentially, (2) maintains high diversity in the generated samples after a burn-in period, and (3) enables online refinement or early termination. We demonstrate its versatility across various tasks, including temperature annealing, reward-tilting, model composition and classifier-free guidance debiasing, with competitive performance compared to prior SMC methods.

