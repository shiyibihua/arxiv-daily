---
layout: default
title: Prompt Optimization Meets Subspace Representation Learning for Few-shot Out-of-Distribution Detection
---

# Prompt Optimization Meets Subspace Representation Learning for Few-shot Out-of-Distribution Detection

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.18111" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.18111v2</a>
  <a href="https://arxiv.org/pdf/2509.18111.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.18111v2" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.18111v2', 'Prompt Optimization Meets Subspace Representation Learning for Few-shot Out-of-Distribution Detection')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Faizul Rakib Sayem, Shahana Ibrahim

**åˆ†ç±»**: cs.LG, cs.AI, cs.CV

**å‘å¸ƒæ—¥æœŸ**: 2025-09-09 (æ›´æ–°: 2025-10-12)

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºç»“åˆå­ç©ºé—´è¡¨ç¤ºå­¦ä¹ çš„æç¤ºä¼˜åŒ–æ–¹æ³•ï¼Œç”¨äºå°‘æ ·æœ¬åˆ†å¸ƒå¤–æ£€æµ‹ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸æ¶æ„ (RL & Architecture)**

**å…³é”®è¯**: `åˆ†å¸ƒå¤–æ£€æµ‹` `å°‘æ ·æœ¬å­¦ä¹ ` `è§†è§‰è¯­è¨€æ¨¡å‹` `æç¤ºå­¦ä¹ ` `å­ç©ºé—´è¡¨ç¤ºå­¦ä¹ `

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰åŸºäºæç¤ºå­¦ä¹ çš„OODæ£€æµ‹æ–¹æ³•ä»…ä¾èµ–softmaxæ¦‚ç‡ï¼Œå¿½ç•¥äº†VLMç‰¹å¾åµŒå…¥çš„åˆ¤åˆ«èƒ½åŠ›ã€‚
2. æå‡ºç»“åˆå­ç©ºé—´è¡¨ç¤ºå­¦ä¹ çš„CoOpæ¡†æ¶ï¼Œå°†IDç‰¹å¾æŠ•å½±åˆ°æç¤ºå‘é‡å­ç©ºé—´ï¼Œå¢å¼ºID-OODå¯åˆ†ç¦»æ€§ã€‚
3. è®¾è®¡ç«¯åˆ°ç«¯å­¦ä¹ å‡†åˆ™ï¼Œç¡®ä¿OODæ£€æµ‹æ€§èƒ½å’ŒIDåˆ†ç±»ç²¾åº¦ï¼Œå¹¶åœ¨çœŸå®æ•°æ®é›†ä¸ŠéªŒè¯æœ‰æ•ˆæ€§ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

äººå·¥æ™ºèƒ½ç³»ç»Ÿåœ¨å¼€æ”¾ä¸–ç•Œç¯å¢ƒä¸­çš„å¯é æ€§é«˜åº¦ä¾èµ–äºå…¶è¯†åˆ«è®­ç»ƒæœŸé—´æœªè§è¿‡çš„åˆ†å¸ƒå¤–ï¼ˆOODï¼‰è¾“å…¥çš„èƒ½åŠ›ã€‚è¿‘å¹´æ¥ï¼Œå¤§è§„æ¨¡è§†è§‰-è¯­è¨€æ¨¡å‹ï¼ˆVLMsï¼‰çš„è¿›æ­¥ä½¿å¾—ä»…ä½¿ç”¨å°‘é‡åˆ†å¸ƒå†…ï¼ˆIDï¼‰æ ·æœ¬è¿›è¡Œå°‘æ ·æœ¬OODæ£€æµ‹æˆä¸ºå¯èƒ½ã€‚ç„¶è€Œï¼Œç°æœ‰çš„åŸºäºæç¤ºå­¦ä¹ çš„OODæ–¹æ³•ä»…ä¾èµ–äºsoftmaxæ¦‚ç‡ï¼Œå¿½ç•¥äº†åœ¨æ•°ç™¾ä¸‡æ ·æœ¬ä¸Šè®­ç»ƒçš„VLMsæ‰€å­¦ä¹ åˆ°çš„ç‰¹å¾åµŒå…¥çš„ä¸°å¯Œåˆ¤åˆ«æ½œåŠ›ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªå±€é™æ€§ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§æ–°é¢–çš„åŸºäºä¸Šä¸‹æ–‡ä¼˜åŒ–ï¼ˆCoOpï¼‰çš„æ¡†æ¶ï¼Œè¯¥æ¡†æ¶å°†å­ç©ºé—´è¡¨ç¤ºå­¦ä¹ ä¸æç¤ºè°ƒä¼˜ç›¸ç»“åˆã€‚æˆ‘ä»¬çš„æ–¹æ³•é€šè¿‡å°†IDç‰¹å¾æŠ•å½±åˆ°ç”±æç¤ºå‘é‡å¼ æˆçš„å­ç©ºé—´ä¸­ï¼ŒåŒæ—¶å°†IDæ— å…³çš„ç‰¹å¾æŠ•å½±åˆ°æ­£äº¤é›¶ç©ºé—´ä¸­ï¼Œä»è€Œæé«˜ID-OODçš„å¯åˆ†ç¦»æ€§ã€‚ä¸ºäº†è®­ç»ƒè¿™ç§OODæ£€æµ‹æ¡†æ¶ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªæ˜“äºå¤„ç†çš„ç«¯åˆ°ç«¯å­¦ä¹ å‡†åˆ™ï¼Œä»¥ç¡®ä¿å¼ºå¤§çš„OODæ£€æµ‹æ€§èƒ½ä»¥åŠé«˜IDåˆ†ç±»ç²¾åº¦ã€‚åœ¨çœŸå®ä¸–ç•Œæ•°æ®é›†ä¸Šçš„å®éªŒè¯æ˜äº†æˆ‘ä»¬æ–¹æ³•çš„æœ‰æ•ˆæ€§ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³å°‘æ ·æœ¬åˆ†å¸ƒå¤–ï¼ˆOODï¼‰æ£€æµ‹é—®é¢˜ã€‚ç°æœ‰åŸºäºæç¤ºå­¦ä¹ çš„æ–¹æ³•ä¸»è¦ä¾èµ–äºsoftmaxæ¦‚ç‡è¿›è¡ŒOODåˆ¤æ–­ï¼Œå¿½ç•¥äº†è§†è§‰-è¯­è¨€æ¨¡å‹ï¼ˆVLMï¼‰æ‰€å­¦ä¹ åˆ°çš„ç‰¹å¾åµŒå…¥ä¸­è•´å«çš„ä¸°å¯Œä¿¡æ¯ï¼Œå¯¼è‡´IDå’ŒOODæ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­åŒºåˆ†åº¦ä¸é«˜ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯å°†å­ç©ºé—´è¡¨ç¤ºå­¦ä¹ èå…¥åˆ°æç¤ºä¼˜åŒ–è¿‡ç¨‹ä¸­ã€‚é€šè¿‡å­¦ä¹ ä¸€ä¸ªå­ç©ºé—´ï¼Œä½¿å¾—åˆ†å¸ƒå†…ï¼ˆIDï¼‰æ ·æœ¬çš„ç‰¹å¾åœ¨è¯¥å­ç©ºé—´å†…å…·æœ‰æ›´å¼ºçš„è¡¨ç¤ºèƒ½åŠ›ï¼Œè€Œåˆ†å¸ƒå¤–ï¼ˆOODï¼‰æ ·æœ¬åœ¨è¯¥å­ç©ºé—´å†…çš„æŠ•å½±è¾ƒå°ï¼Œä»è€Œæé«˜IDå’ŒOODæ ·æœ¬çš„å¯åˆ†ç¦»æ€§ã€‚è¿™æ ·å¯ä»¥æ›´æœ‰æ•ˆåœ°åˆ©ç”¨VLMå­¦ä¹ åˆ°çš„ç‰¹å¾ä¿¡æ¯ï¼Œæå‡OODæ£€æµ‹çš„å‡†ç¡®ç‡ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šæ•´ä½“æ¡†æ¶åŸºäºContext Optimization (CoOp)ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ¨¡å—ï¼š1) æç¤ºä¼˜åŒ–æ¨¡å—ï¼šä½¿ç”¨CoOpæ–¹æ³•å­¦ä¹ ä¸€ç»„æç¤ºå‘é‡ï¼Œç”¨äºå¼•å¯¼VLMæå–å›¾åƒç‰¹å¾ã€‚2) å­ç©ºé—´å­¦ä¹ æ¨¡å—ï¼šå°†IDæ ·æœ¬çš„ç‰¹å¾æŠ•å½±åˆ°ç”±æç¤ºå‘é‡å¼ æˆçš„å­ç©ºé—´ä¸­ï¼ŒåŒæ—¶å°†IDæ— å…³çš„ç‰¹å¾æŠ•å½±åˆ°æ­£äº¤é›¶ç©ºé—´ä¸­ã€‚3) OODæ£€æµ‹æ¨¡å—ï¼šåŸºäºæ ·æœ¬åœ¨å­ç©ºé—´ä¸­çš„æŠ•å½±å¤§å°ï¼Œåˆ¤æ–­å…¶æ˜¯å¦ä¸ºOODæ ·æœ¬ã€‚æ•´ä¸ªæ¡†æ¶é‡‡ç”¨ç«¯åˆ°ç«¯çš„æ–¹å¼è¿›è¡Œè®­ç»ƒã€‚

**å…³é”®åˆ›æ–°**ï¼šè®ºæ–‡çš„å…³é”®åˆ›æ–°åœ¨äºå°†å­ç©ºé—´è¡¨ç¤ºå­¦ä¹ ä¸æç¤ºä¼˜åŒ–ç›¸ç»“åˆã€‚ä¸ç°æœ‰æ–¹æ³•ç›¸æ¯”ï¼Œè¯¥æ–¹æ³•ä¸ä»…åˆ©ç”¨äº†æç¤ºå­¦ä¹ çš„ä¼˜åŠ¿ï¼Œè¿˜å……åˆ†æŒ–æ˜äº†VLMç‰¹å¾åµŒå…¥çš„åˆ¤åˆ«èƒ½åŠ›ï¼Œä»è€Œæé«˜äº†OODæ£€æµ‹çš„æ€§èƒ½ã€‚æ­¤å¤–ï¼Œè®ºæ–‡è¿˜è®¾è®¡äº†ä¸€ä¸ªæ˜“äºå¤„ç†çš„ç«¯åˆ°ç«¯å­¦ä¹ å‡†åˆ™ï¼Œä½¿å¾—æ•´ä¸ªæ¡†æ¶çš„è®­ç»ƒæ›´åŠ é«˜æ•ˆã€‚

**å…³é”®è®¾è®¡**ï¼šè®ºæ–‡çš„å…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) å­ç©ºé—´çš„æ„å»ºæ–¹å¼ï¼šä½¿ç”¨æç¤ºå‘é‡ä½œä¸ºå­ç©ºé—´çš„åŸºå‘é‡ï¼Œä½¿å¾—å­ç©ºé—´èƒ½å¤Ÿæ•è·IDæ ·æœ¬çš„å…³é”®ç‰¹å¾ã€‚2) æŸå¤±å‡½æ•°çš„è®¾è®¡ï¼šè®¾è®¡äº†ä¸€ä¸ªåŒ…å«IDåˆ†ç±»æŸå¤±å’ŒOODæ£€æµ‹æŸå¤±çš„è”åˆæŸå¤±å‡½æ•°ï¼Œç”¨äºåŒæ—¶ä¼˜åŒ–IDåˆ†ç±»ç²¾åº¦å’ŒOODæ£€æµ‹æ€§èƒ½ã€‚3) ç«¯åˆ°ç«¯è®­ç»ƒæ–¹å¼ï¼šæ•´ä¸ªæ¡†æ¶é‡‡ç”¨ç«¯åˆ°ç«¯çš„æ–¹å¼è¿›è¡Œè®­ç»ƒï¼Œé¿å…äº†æ‰‹åŠ¨è®¾è®¡ç‰¹å¾æˆ–é˜ˆå€¼ï¼Œæé«˜äº†æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

è®ºæ–‡åœ¨å¤šä¸ªçœŸå®ä¸–ç•Œæ•°æ®é›†ä¸Šè¿›è¡Œäº†å®éªŒï¼Œç»“æœè¡¨æ˜æ‰€æå‡ºçš„æ–¹æ³•èƒ½å¤Ÿæ˜¾è‘—æé«˜å°‘æ ·æœ¬OODæ£€æµ‹çš„æ€§èƒ½ã€‚ä¸ç°æœ‰æ–¹æ³•ç›¸æ¯”ï¼Œè¯¥æ–¹æ³•åœ¨OODæ£€æµ‹çš„å‡†ç¡®ç‡å’Œå¬å›ç‡ä¸Šå‡å–å¾—äº†æ˜æ˜¾çš„æå‡ï¼Œè¯æ˜äº†å…¶æœ‰æ•ˆæ€§ã€‚å…·ä½“æ€§èƒ½æ•°æ®åœ¨è®ºæ–‡ä¸­ç»™å‡ºã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæœå¯åº”ç”¨äºå„ç§éœ€è¦è¯†åˆ«æœªçŸ¥æˆ–å¼‚å¸¸è¾“å…¥çš„åœºæ™¯ï¼Œä¾‹å¦‚è‡ªåŠ¨é©¾é©¶ä¸­çš„å¼‚å¸¸ç‰©ä½“æ£€æµ‹ã€åŒ»ç–—è¯Šæ–­ä¸­çš„ç½•è§ç–¾ç—…è¯†åˆ«ã€é‡‘èé£æ§ä¸­çš„æ¬ºè¯ˆäº¤æ˜“æ£€æµ‹ç­‰ã€‚é€šè¿‡æé«˜AIç³»ç»Ÿå¯¹æœªçŸ¥é£é™©çš„è¯†åˆ«èƒ½åŠ›ï¼Œå¯ä»¥æ˜¾è‘—æå‡å…¶å®‰å…¨æ€§å’Œå¯é æ€§ï¼Œå…·æœ‰é‡è¦çš„å®é™…åº”ç”¨ä»·å€¼ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> The reliability of artificial intelligence (AI) systems in open-world settings depends heavily on their ability to flag out-of-distribution (OOD) inputs unseen during training. Recent advances in large-scale vision-language models (VLMs) have enabled promising few-shot OOD detection frameworks using only a handful of in-distribution (ID) samples. However, existing prompt learning-based OOD methods rely solely on softmax probabilities, overlooking the rich discriminative potential of the feature embeddings learned by VLMs trained on millions of samples. To address this limitation, we propose a novel context optimization (CoOp)-based framework that integrates subspace representation learning with prompt tuning. Our approach improves ID-OOD separability by projecting the ID features into a subspace spanned by prompt vectors, while projecting ID-irrelevant features into an orthogonal null space. To train such OOD detection framework, we design an easy-to-handle end-to-end learning criterion that ensures strong OOD detection performance as well as high ID classification accuracy. Experiments on real-world datasets showcase the effectiveness of our approach.

