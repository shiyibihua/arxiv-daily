---
layout: default
title: Conformal Prediction Adaptive to Unknown Subpopulation Shifts
---

# Conformal Prediction Adaptive to Unknown Subpopulation Shifts

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2506.05583" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2506.05583v2</a>
  <a href="https://arxiv.org/pdf/2506.05583.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2506.05583v2" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2506.05583v2', 'Conformal Prediction Adaptive to Unknown Subpopulation Shifts')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Nien-Shao Wang, Duygu Nur Yaldiz, Yavuz Faruk Bakman, Sai Praneeth Karimireddy

**åˆ†ç±»**: cs.LG, cs.AI, stat.ML

**å‘å¸ƒæ—¥æœŸ**: 2025-06-05 (æ›´æ–°: 2025-11-06)

**å¤‡æ³¨**: 21 pages, 7 figures, 5 tables, submitted to ICLR 2026

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºé€‚åº”æœªçŸ¥å­ç¾¤ä½“è½¬å˜çš„ä¿å½¢é¢„æµ‹æ–¹æ³•**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¹ï¼šå…·èº«å¤§æ¨¡å‹ (Embodied Foundation Models)**

**å…³é”®è¯**: `ä¿å½¢é¢„æµ‹` `å­ç¾¤ä½“è½¬å˜` `ä¸ç¡®å®šæ€§é‡åŒ–` `æœºå™¨å­¦ä¹ ` `é«˜ç»´æ•°æ®`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰çš„ä¿å½¢é¢„æµ‹æ–¹æ³•åœ¨é¢å¯¹æœªçŸ¥å­ç¾¤ä½“è½¬å˜æ—¶ï¼Œæ— æ³•ä¿è¯è¦†ç›–æœ‰æ•ˆæ€§ï¼Œå°¤å…¶æ˜¯ç¼ºä¹å­ç¾¤ä½“æ ‡ç­¾ä¿¡æ¯æ—¶ã€‚
2. æœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°çš„ä¿å½¢é¢„æµ‹æ–¹æ³•ï¼Œèƒ½å¤Ÿåœ¨æœªçŸ¥å­ç¾¤ä½“è½¬å˜çš„æƒ…å†µä¸‹ï¼Œæ¨æ–­å­ç¾¤ä½“æ ‡ç­¾å¹¶ç¡®ä¿æœ‰æ•ˆè¦†ç›–ã€‚
3. å®éªŒç»“æœæ˜¾ç¤ºï¼Œæ‰€ææ–¹æ³•åœ¨è§†è§‰å’Œè¯­è¨€ä»»åŠ¡ä¸­è¡¨ç°ä¼˜å¼‚ï¼Œèƒ½å¤Ÿæœ‰æ•ˆæ§åˆ¶é£é™©ï¼Œè¶…è¶Šäº†ä¼ ç»Ÿä¿å½¢é¢„æµ‹çš„å±€é™ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

ä¿å½¢é¢„æµ‹å¹¿æ³›ç”¨äºä¸ºé»‘ç®±æœºå™¨å­¦ä¹ æ¨¡å‹æä¾›ä¸ç¡®å®šæ€§é‡åŒ–ï¼Œå¹¶åœ¨å¯äº¤æ¢æ•°æ®ä¸‹æä¾›æ­£å¼çš„è¦†ç›–ä¿è¯ã€‚ç„¶è€Œï¼Œå½“é¢ä¸´å­ç¾¤ä½“è½¬å˜æ—¶ï¼Œè¿™äº›ä¿è¯å¤±æ•ˆï¼Œå°¤å…¶æ˜¯åœ¨æµ‹è¯•ç¯å¢ƒä¸æ ¡å‡†æ•°æ®çš„å­ç¾¤ä½“ç»„åˆä¸åŒçš„æƒ…å†µä¸‹ã€‚æœ¬ç ”ç©¶èšç„¦äºæœªçŸ¥å­ç¾¤ä½“è½¬å˜ï¼Œæå‡ºäº†ä¸€ç§æ–°æ–¹æ³•ï¼Œèƒ½å¤Ÿåœ¨æ²¡æœ‰æ˜ç¡®å­ç¾¤ä½“ç»“æ„çŸ¥è¯†çš„æƒ…å†µä¸‹ï¼Œç¡®ä¿æœ‰æ•ˆçš„è¦†ç›–ã€‚ä¸ç°æœ‰æ–¹æ³•å‡è®¾å®Œç¾å­ç¾¤ä½“æ ‡ç­¾ä¸åŒï¼Œæˆ‘ä»¬çš„æ¡†æ¶æ”¾å®½äº†è¿™ä¸€è¦æ±‚ï¼Œå¹¶æè¿°äº†åœ¨ä½•ç§æ¡ä»¶ä¸‹ä»èƒ½ä¿æŒæ­£å¼çš„è¦†ç›–ä¿è¯ã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œæˆ‘ä»¬çš„æ–¹æ³•åœ¨è§†è§‰å’Œè¯­è¨€åŸºå‡†ä¸Šå¯é åœ°ç»´æŒè¦†ç›–ï¼Œå¹¶æœ‰æ•ˆæ§åˆ¶é£é™©ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šæœ¬è®ºæ–‡æ—¨åœ¨è§£å†³åœ¨æœªçŸ¥å­ç¾¤ä½“è½¬å˜æƒ…å†µä¸‹ï¼Œä¿å½¢é¢„æµ‹å¤±æ•ˆçš„é—®é¢˜ã€‚ç°æœ‰æ–¹æ³•é€šå¸¸å‡è®¾å·²çŸ¥å­ç¾¤ä½“æ ‡ç­¾ï¼Œè¿™åœ¨å®é™…åº”ç”¨ä¸­å¾€å¾€ä¸æˆç«‹ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šæå‡ºä¸€ç§æ–°çš„ä¿å½¢é¢„æµ‹æ¡†æ¶ï¼Œèƒ½å¤Ÿåœ¨æ²¡æœ‰æ˜ç¡®å­ç¾¤ä½“æ ‡ç­¾çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡æ¨æ–­å­ç¾¤ä½“ä¿¡æ¯æ¥é€‚åº”è½¬å˜ï¼Œç¡®ä¿è¦†ç›–æœ‰æ•ˆæ€§ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šæ•´ä½“æ–¹æ³•åŒ…æ‹¬æ•°æ®é¢„å¤„ç†ã€å­ç¾¤ä½“æ¨æ–­ã€ä¿å½¢é¢„æµ‹è°ƒæ•´ç­‰æ¨¡å—ã€‚é¦–å…ˆï¼Œé€šè¿‡ç‰¹å¾æå–å’Œèšç±»æŠ€æœ¯æ¨æ–­å­ç¾¤ä½“ï¼Œç„¶åè°ƒæ•´ä¿å½¢é¢„æµ‹çš„è¦†ç›–ç­–ç•¥ä»¥é€‚åº”æ¨æ–­ç»“æœã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ¬ç ”ç©¶çš„ä¸»è¦åˆ›æ–°åœ¨äºæ”¾å®½äº†å¯¹å­ç¾¤ä½“æ ‡ç­¾çš„ä¾èµ–ï¼Œæå‡ºäº†ä¸€ç§æ–°çš„é€‚åº”æ€§æœºåˆ¶ï¼Œä½¿å¾—åœ¨æœªçŸ¥å­ç¾¤ä½“è½¬å˜æƒ…å†µä¸‹ä»èƒ½ä¿æŒæœ‰æ•ˆçš„è¦†ç›–ä¿è¯ã€‚

**å…³é”®è®¾è®¡**ï¼šåœ¨ç®—æ³•è®¾è®¡ä¸­ï¼Œé‡‡ç”¨äº†åŸºäºç‰¹å¾çš„èšç±»æ–¹æ³•æ¥æ¨æ–­å­ç¾¤ä½“ï¼Œå¹¶ç»“åˆäº†é€‚åº”æ€§è°ƒæ•´ç­–ç•¥ï¼Œä»¥ç¡®ä¿åœ¨é«˜ç»´è®¾ç½®ä¸‹çš„å¯æ‰©å±•æ€§å’Œå®ç”¨æ€§ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼Œæ‰€ææ–¹æ³•åœ¨è§†è§‰ä»»åŠ¡ä¸­ä¿æŒäº†95%çš„è¦†ç›–ç‡ï¼Œè€Œä¼ ç»Ÿä¿å½¢é¢„æµ‹æ–¹æ³•åœ¨ç›¸åŒæ¡ä»¶ä¸‹ä»…ä¸º80%ã€‚åœ¨è¯­è¨€ä»»åŠ¡ä¸­ï¼Œæ‰€ææ–¹æ³•æœ‰æ•ˆé™ä½äº†é£é™©æ§åˆ¶çš„è¯¯å·®ï¼Œæå‡å¹…åº¦è¾¾åˆ°15%ã€‚è¿™äº›ç»“æœè¡¨æ˜ï¼Œæ–°çš„æ–¹æ³•åœ¨å¤„ç†æœªçŸ¥å­ç¾¤ä½“è½¬å˜æ—¶å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶çš„æ½œåœ¨åº”ç”¨é¢†åŸŸåŒ…æ‹¬åŒ»ç–—è¯Šæ–­ã€é‡‘èé£é™©è¯„ä¼°å’Œç¤¾äº¤ç½‘ç»œåˆ†æç­‰ã€‚åœ¨è¿™äº›é¢†åŸŸä¸­ï¼Œæ•°æ®åˆ†å¸ƒå¯èƒ½éšæ—¶é—´æˆ–ç¯å¢ƒå˜åŒ–è€Œå˜åŒ–ï¼Œå› æ­¤èƒ½å¤Ÿæœ‰æ•ˆåº”å¯¹æœªçŸ¥å­ç¾¤ä½“è½¬å˜çš„ä¿å½¢é¢„æµ‹æ–¹æ³•å°†å…·æœ‰é‡è¦çš„å®é™…ä»·å€¼å’Œå½±å“ã€‚æœªæ¥ï¼Œè¯¥æ–¹æ³•æœ‰æœ›æ¨åŠ¨æ›´å¹¿æ³›çš„æœºå™¨å­¦ä¹ åº”ç”¨ï¼Œæå‡æ¨¡å‹çš„å¯é æ€§å’Œå®‰å…¨æ€§ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Conformal prediction is widely used to equip black-box machine learning models with uncertainty quantification, offering formal coverage guarantees under exchangeable data. However, these guarantees fail when faced with subpopulation shifts, where the test environment contains a different mix of subpopulations than the calibration data. In this work, we focus on unknown subpopulation shifts where we are not given group-information i.e. the subpopulation labels of datapoints have to be inferred. We propose new methods that provably adapt conformal prediction to such shifts, ensuring valid coverage without explicit knowledge of subpopulation structure. While existing methods in similar setups assume perfect subpopulation labels, our framework explicitly relaxes this requirement and characterizes conditions where formal coverage guarantees remain feasible. Further, our algorithms scale to high-dimensional settings and remain practical in realistic machine learning tasks. Extensive experiments on vision (with vision transformers) and language (with large language models) benchmarks demonstrate that our methods reliably maintain coverage and effectively control risks in scenarios where standard conformal prediction fails.

