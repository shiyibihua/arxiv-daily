---
layout: default
title: Learning to Route: Per-Sample Adaptive Routing for Multimodal Multitask Prediction
---

# Learning to Route: Per-Sample Adaptive Routing for Multimodal Multitask Prediction

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.12227" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.12227v2</a>
  <a href="https://arxiv.org/pdf/2509.12227.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.12227v2" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.12227v2', 'Learning to Route: Per-Sample Adaptive Routing for Multimodal Multitask Prediction')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Marzieh Ajirak, Oded Bein, Ellen Rose Bowen, Dora Kanellopoulos, Avital Falk, Faith M. Gunning, Nili Solomonov, Logan Grosenick

**åˆ†ç±»**: cs.LG, cs.AI

**å‘å¸ƒæ—¥æœŸ**: 2025-09-06 (æ›´æ–°: 2025-09-29)

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºä¸€ç§è‡ªé€‚åº”è·¯ç”±æ¡†æ¶ï¼Œç”¨äºè§£å†³å¤šæ¨¡æ€å¤šä»»åŠ¡é¢„æµ‹ä¸­çš„æ•°æ®å¼‚æ„æ€§é—®é¢˜ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¹ï¼šå…·èº«å¤§æ¨¡å‹ (Embodied Foundation Models)**

**å…³é”®è¯**: `è‡ªé€‚åº”è·¯ç”±` `å¤šæ¨¡æ€å­¦ä¹ ` `å¤šä»»åŠ¡å­¦ä¹ ` `æ•°æ®å¼‚æ„æ€§` `å¿ƒç†æ²»ç–—`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰æ–¹æ³•éš¾ä»¥æœ‰æ•ˆå¤„ç†å¤šæ¨¡æ€å¤šä»»åŠ¡é¢„æµ‹ä¸­æ™®éå­˜åœ¨çš„æ•°æ®å¼‚æ„æ€§å’Œä»»åŠ¡ç›¸å…³æ€§ã€‚
2. æå‡ºä¸€ç§åŸºäºè·¯ç”±çš„æ¶æ„ï¼ŒåŠ¨æ€é€‰æ‹©æ¨¡æ€å¤„ç†è·¯å¾„å’Œä»»åŠ¡å…±äº«ç­–ç•¥ï¼Œå®ç°æ ·æœ¬çº§åˆ«çš„è‡ªé€‚åº”ã€‚
3. å®éªŒè¡¨æ˜ï¼Œè¯¥æ–¹æ³•åœ¨é¢„æµ‹æŠ‘éƒå’Œç„¦è™‘ç»“æœæ–¹é¢ä¼˜äºå›ºå®šå¤šä»»åŠ¡æˆ–å•ä»»åŠ¡åŸºçº¿ï¼Œå¹¶æä¾›å¯è§£é‡Šçš„æ´è§ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æå‡ºäº†ä¸€ç§ç»Ÿä¸€çš„è‡ªé€‚åº”è·¯ç”±æ¡†æ¶ï¼Œç”¨äºå¤šä»»åŠ¡ã€å¤šæ¨¡æ€é¢„æµ‹åœºæ™¯ï¼Œå…¶ä¸­æ•°æ®å¼‚æ„æ€§å’Œä»»åŠ¡äº¤äº’å› æ ·æœ¬è€Œå¼‚ã€‚å—å¿ƒç†æ²»ç–—åº”ç”¨çš„å¯å‘ï¼Œè¯¥åº”ç”¨ä¸­ç»“æ„åŒ–è¯„ä¼°å’Œéç»“æ„åŒ–ä¸´åºŠåŒ»ç”Ÿç¬”è®°ä¸éƒ¨åˆ†ç¼ºå¤±æ•°æ®å’Œç›¸å…³ç»“æœå…±å­˜ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ç§åŸºäºè·¯ç”±çš„æ¶æ„ï¼Œè¯¥æ¶æ„åŠ¨æ€åœ°é€‰æ‹©æ¨¡æ€å¤„ç†è·¯å¾„å’ŒåŸºäºæ¯ä¸ªæ ·æœ¬çš„ä»»åŠ¡å…±äº«ç­–ç•¥ã€‚æˆ‘ä»¬çš„æ¨¡å‹å®šä¹‰äº†å¤šä¸ªæ¨¡æ€è·¯å¾„ï¼ŒåŒ…æ‹¬æ–‡æœ¬å’Œæ•°å­—ç‰¹å¾çš„åŸå§‹å’Œèåˆè¡¨ç¤ºï¼Œå¹¶å­¦ä¹ é€šè¿‡æœ€å…·ä¿¡æ¯é‡çš„ä¸“å®¶ç»„åˆæ¥è·¯ç”±æ¯ä¸ªè¾“å…¥ã€‚ä»»åŠ¡ç‰¹å®šçš„é¢„æµ‹ç”±å…±äº«æˆ–ç‹¬ç«‹çš„å¤´éƒ¨äº§ç”Ÿï¼Œå…·ä½“å–å†³äºè·¯ç”±å†³ç­–ï¼Œå¹¶ä¸”æ•´ä¸ªç³»ç»Ÿæ˜¯ç«¯åˆ°ç«¯è®­ç»ƒçš„ã€‚æˆ‘ä»¬åœ¨åˆæˆæ•°æ®å’ŒçœŸå®ä¸–ç•Œçš„å¿ƒç†æ²»ç–—ç¬”è®°ä¸Šè¯„ä¼°äº†è¯¥æ¨¡å‹ï¼Œé¢„æµ‹æŠ‘éƒå’Œç„¦è™‘ç»“æœã€‚æˆ‘ä»¬çš„å®éªŒè¡¨æ˜ï¼Œæˆ‘ä»¬çš„æ–¹æ³•å§‹ç»ˆä¼˜äºå›ºå®šçš„å¤šä»»åŠ¡æˆ–å•ä»»åŠ¡åŸºçº¿ï¼Œå¹¶ä¸”å­¦ä¹ åˆ°çš„è·¯ç”±ç­–ç•¥æä¾›äº†å¯¹æ¨¡æ€ç›¸å…³æ€§å’Œä»»åŠ¡ç»“æ„çš„å¯è§£é‡Šçš„è§è§£ã€‚è¿™é€šè¿‡å¯ç”¨é’ˆå¯¹æ¯ä¸ªå—è¯•è€…çš„è‡ªé€‚åº”ä¿¡æ¯å¤„ç†æ¥è§£å†³ä¸ªæ€§åŒ–åŒ»ç–—ä¿å¥ä¸­çš„å…³é”®æŒ‘æˆ˜ï¼Œä»è€Œè§£å†³æ•°æ®å¼‚æ„æ€§å’Œä»»åŠ¡ç›¸å…³æ€§ã€‚åº”ç”¨äºå¿ƒç†æ²»ç–—ï¼Œè¯¥æ¡†æ¶å¯ä»¥é€šè¿‡ä¸ªæ€§åŒ–çš„å¹²é¢„ç­–ç•¥æ¥æ”¹å–„å¿ƒç†å¥åº·ç»“æœï¼Œæé«˜æ²»ç–—åˆ†é…çš„ç²¾ç¡®æ€§å¹¶æé«˜ä¸´åºŠæˆæœ¬æ•ˆç›Šã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³å¤šæ¨¡æ€å¤šä»»åŠ¡é¢„æµ‹é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨æ•°æ®å¼‚æ„æ€§é«˜ä¸”ä»»åŠ¡é—´äº¤äº’å¤æ‚çš„åœºæ™¯ä¸‹ã€‚ä¾‹å¦‚ï¼Œåœ¨å¿ƒç†æ²»ç–—é¢†åŸŸï¼Œéœ€è¦åŒæ—¶å¤„ç†ç»“æ„åŒ–çš„è¯„ä¼°æ•°æ®å’Œéç»“æ„åŒ–çš„ä¸´åºŠç¬”è®°ï¼Œå¹¶ä¸”æ•°æ®å¯èƒ½å­˜åœ¨ç¼ºå¤±ï¼ŒåŒæ—¶é¢„æµ‹å¤šä¸ªç›¸å…³çš„å¿ƒç†å¥åº·æŒ‡æ ‡ï¼ˆå¦‚æŠ‘éƒå’Œç„¦è™‘ï¼‰ã€‚ç°æœ‰æ–¹æ³•é€šå¸¸é‡‡ç”¨å›ºå®šçš„å¤šæ¨¡æ€èåˆå’Œä»»åŠ¡å…±äº«ç­–ç•¥ï¼Œæ— æ³•æ ¹æ®ä¸åŒæ ·æœ¬çš„ç‰¹ç‚¹è¿›è¡Œè‡ªé€‚åº”è°ƒæ•´ï¼Œå¯¼è‡´é¢„æµ‹æ€§èƒ½å—é™ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯å¼•å…¥ä¸€ä¸ªå¯å­¦ä¹ çš„è·¯ç”±æœºåˆ¶ï¼Œæ ¹æ®æ¯ä¸ªæ ·æœ¬çš„ç‰¹å¾åŠ¨æ€åœ°é€‰æ‹©æœ€åˆé€‚çš„æ¨¡æ€å¤„ç†è·¯å¾„å’Œä»»åŠ¡å…±äº«ç­–ç•¥ã€‚è¿™ç§è‡ªé€‚åº”è·¯ç”±å…è®¸æ¨¡å‹é’ˆå¯¹ä¸åŒçš„æ ·æœ¬é€‰æ‹©æ€§åœ°åˆ©ç”¨ä¸åŒçš„æ¨¡æ€ä¿¡æ¯ï¼Œå¹¶å†³å®šå“ªäº›ä»»åŠ¡åº”è¯¥å…±äº«ä¿¡æ¯ï¼Œå“ªäº›ä»»åŠ¡åº”è¯¥ç‹¬ç«‹è¿›è¡Œé¢„æµ‹ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šæ•´ä½“æ¶æ„åŒ…å«ä»¥ä¸‹å‡ ä¸ªä¸»è¦æ¨¡å—ï¼š1) å¤šä¸ªæ¨¡æ€è·¯å¾„ï¼Œç”¨äºå¤„ç†ä¸åŒæ¨¡æ€çš„è¾“å…¥æ•°æ®ï¼ˆå¦‚æ–‡æœ¬å’Œæ•°å€¼ç‰¹å¾ï¼‰ï¼Œå¹¶ç”ŸæˆåŸå§‹å’Œèåˆçš„æ¨¡æ€è¡¨ç¤ºï¼›2) ä¸€ä¸ªè·¯ç”±æ¨¡å—ï¼Œæ ¹æ®è¾“å…¥æ ·æœ¬çš„ç‰¹å¾å­¦ä¹ ä¸€ä¸ªè·¯ç”±ç­–ç•¥ï¼Œå†³å®šæ¯ä¸ªæ ·æœ¬åº”è¯¥é€šè¿‡å“ªä¸ªæ¨¡æ€è·¯å¾„ä»¥åŠå“ªäº›ä»»åŠ¡åº”è¯¥å…±äº«ä¿¡æ¯ï¼›3) å¤šä¸ªä»»åŠ¡ç‰¹å®šçš„é¢„æµ‹å¤´ï¼Œæ ¹æ®è·¯ç”±å†³ç­–ï¼Œåˆ©ç”¨å…±äº«æˆ–ç‹¬ç«‹çš„ç‰¹å¾è¡¨ç¤ºè¿›è¡Œé¢„æµ‹ã€‚æ•´ä¸ªç³»ç»Ÿé‡‡ç”¨ç«¯åˆ°ç«¯çš„æ–¹å¼è¿›è¡Œè®­ç»ƒã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„åˆ›æ–°ç‚¹åœ¨äºæå‡ºäº†ä¸€ä¸ªå¯å­¦ä¹ çš„è‡ªé€‚åº”è·¯ç”±æœºåˆ¶ï¼Œèƒ½å¤Ÿæ ¹æ®æ¯ä¸ªæ ·æœ¬çš„ç‰¹ç‚¹åŠ¨æ€åœ°é€‰æ‹©æ¨¡æ€å¤„ç†è·¯å¾„å’Œä»»åŠ¡å…±äº«ç­–ç•¥ã€‚ä¸ä¼ ç»Ÿçš„å›ºå®šèåˆå’Œå…±äº«ç­–ç•¥ç›¸æ¯”ï¼Œè¿™ç§è‡ªé€‚åº”è·¯ç”±èƒ½å¤Ÿæ›´å¥½åœ°åˆ©ç”¨æ•°æ®ä¸­çš„å¼‚æ„æ€§å’Œä»»åŠ¡é—´çš„ç›¸å…³æ€§ï¼Œä»è€Œæé«˜é¢„æµ‹æ€§èƒ½ã€‚

**å…³é”®è®¾è®¡**ï¼šè·¯ç”±æ¨¡å—çš„è®¾è®¡æ˜¯å…³é”®ã€‚å…·ä½“å®ç°ç»†èŠ‚æœªçŸ¥ï¼Œä½†å¯ä»¥æ¨æµ‹å¯èƒ½ä½¿ç”¨äº†æ³¨æ„åŠ›æœºåˆ¶æˆ–è€…é—¨æ§æœºåˆ¶æ¥å­¦ä¹ è·¯ç”±ç­–ç•¥ã€‚æŸå¤±å‡½æ•°çš„è®¾è®¡ä¹Ÿè‡³å…³é‡è¦ï¼Œéœ€è¦åŒæ—¶è€ƒè™‘é¢„æµ‹çš„å‡†ç¡®æ€§å’Œè·¯ç”±ç­–ç•¥çš„åˆç†æ€§ã€‚ç½‘ç»œç»“æ„æ–¹é¢ï¼Œå¯èƒ½é‡‡ç”¨äº†æ¨¡å—åŒ–çš„è®¾è®¡ï¼Œæ–¹ä¾¿æ‰©å±•åˆ°æ›´å¤šçš„æ¨¡æ€å’Œä»»åŠ¡ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼Œè¯¥æ–¹æ³•åœ¨åˆæˆæ•°æ®å’ŒçœŸå®ä¸–ç•Œçš„å¿ƒç†æ²»ç–—ç¬”è®°æ•°æ®é›†ä¸Šå‡å–å¾—äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼Œä¼˜äºå›ºå®šçš„å¤šä»»åŠ¡æˆ–å•ä»»åŠ¡åŸºçº¿ã€‚å…·ä½“æå‡å¹…åº¦æœªçŸ¥ï¼Œä½†æ‘˜è¦ä¸­å¼ºè°ƒäº†â€œå§‹ç»ˆä¼˜äºâ€è¿™ä¸€ç»“è®ºï¼Œè¡¨æ˜è¯¥æ–¹æ³•å…·æœ‰è¾ƒå¼ºçš„é²æ£’æ€§å’Œæ³›åŒ–èƒ½åŠ›ã€‚æ­¤å¤–ï¼Œå­¦ä¹ åˆ°çš„è·¯ç”±ç­–ç•¥æä¾›äº†å¯¹æ¨¡æ€ç›¸å…³æ€§å’Œä»»åŠ¡ç»“æ„çš„å¯è§£é‡Šæ€§æ´è§ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæœå¯åº”ç”¨äºä¸ªæ€§åŒ–åŒ»ç–—ä¿å¥é¢†åŸŸï¼Œä¾‹å¦‚å¿ƒç†æ²»ç–—ã€ç–¾ç—…è¯Šæ–­å’Œæ²»ç–—æ–¹æ¡ˆæ¨èã€‚é€šè¿‡è‡ªé€‚åº”åœ°å¤„ç†å¤šæ¨¡æ€æ•°æ®ï¼Œå¯ä»¥æ›´å‡†ç¡®åœ°é¢„æµ‹æ‚£è€…çš„å¥åº·çŠ¶å†µå’Œæ²»ç–—æ•ˆæœï¼Œä»è€Œåˆ¶å®šæ›´æœ‰æ•ˆçš„ä¸ªæ€§åŒ–å¹²é¢„ç­–ç•¥ã€‚æ­¤å¤–ï¼Œè¯¥æ–¹æ³•è¿˜å¯ä»¥åº”ç”¨äºå…¶ä»–é¢†åŸŸï¼Œå¦‚é‡‘èé£é™©è¯„ä¼°ã€æ™ºèƒ½æ¨èç³»ç»Ÿç­‰ï¼Œæé«˜é¢„æµ‹ç²¾åº¦å’Œå†³ç­–æ•ˆç‡ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> We propose a unified framework for adaptive routing in multitask, multimodal prediction settings where data heterogeneity and task interactions vary across samples. Motivated by applications in psychotherapy where structured assessments and unstructured clinician notes coexist with partially missing data and correlated outcomes, we introduce a routing-based architecture that dynamically selects modality processing pathways and task-sharing strategies on a per-sample basis. Our model defines multiple modality paths, including raw and fused representations of text and numeric features and learns to route each input through the most informative expert combination. Task-specific predictions are produced by shared or independent heads depending on the routing decision, and the entire system is trained end-to-end. We evaluate the model on both synthetic data and real-world psychotherapy notes predicting depression and anxiety outcomes. Our experiments show that our method consistently outperforms fixed multitask or single-task baselines, and that the learned routing policy provides interpretable insights into modality relevance and task structure. This addresses critical challenges in personalized healthcare by enabling per-subject adaptive information processing that accounts for data heterogeneity and task correlations. Applied to psychotherapy, this framework could improve mental health outcomes, enhance treatment assignment precision, and increase clinical cost-effectiveness through personalized intervention strategies.

