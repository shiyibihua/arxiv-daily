---
layout: default
title: Maximum Mean Discrepancy with Unequal Sample Sizes via Generalized U-Statistics
---

# Maximum Mean Discrepancy with Unequal Sample Sizes via Generalized U-Statistics

**arXiv**: [2512.13997v1](https://arxiv.org/abs/2512.13997) | [PDF](https://arxiv.org/pdf/2512.13997.pdf)

**ä½œè€…**: Aaron Wei, Milad Jalali, Danica J. Sutherland

**åˆ†ç±»**: stat.ML, cs.LG, math.ST, stat.ME

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

<<<<<<< HEAD
**æå‡ºåŸºäºå¹¿ä¹‰Uç»Ÿè®¡é‡çš„æœ€å¤§å‡å€¼å·®å¼‚æ–¹æ³•ï¼Œè§£å†³ä¸ç­‰æ ·æœ¬é‡ä¸‹çš„ä¸¤æ ·æœ¬æ£€éªŒé—®é¢˜ï¼Œæå‡æµ‹è¯•å‡†ç¡®æ€§å’Œå®ç”¨æ€§ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **è§†è§‰é‡Œç¨‹è®¡** **å¼ºåŒ–å­¦ä¹ **

**å…³é”®è¯**: `ä¸¤æ ·æœ¬æ£€éªŒ` `æœ€å¤§å‡å€¼å·®å¼‚` `å¹¿ä¹‰Uç»Ÿè®¡é‡` `ä¸ç­‰æ ·æœ¬é‡` `æ¸è¿‘åˆ†å¸ƒ` `æ£€éªŒåŠŸæ•ˆä¼˜åŒ–` `ç»Ÿè®¡å­¦ä¹ ` `æœºå™¨å­¦ä¹ ç†è®º`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰MMDä¸¤æ ·æœ¬æ£€éªŒæ–¹æ³•é€šå¸¸å‡è®¾æ ·æœ¬é‡ç›¸ç­‰ï¼Œå®é™…åº”ç”¨ä¸­éœ€ä¸¢å¼ƒæ•°æ®ï¼Œå¯¼è‡´æ£€éªŒåŠŸæ•ˆé™ä½ã€‚
2. è®ºæ–‡æ‰©å±•å¹¿ä¹‰Uç»Ÿè®¡é‡ç†è®ºï¼Œåº”ç”¨äºMMDä¼°è®¡é‡ï¼Œåˆ»ç”»ä¸ç­‰æ ·æœ¬é‡ä¸‹çš„æ¸è¿‘åˆ†å¸ƒï¼Œå¹¶ä¼˜åŒ–æ£€éªŒåŠŸæ•ˆã€‚
3. æ–¹æ³•ä¿ç•™æ‰€æœ‰æ•°æ®ï¼Œæå‡æ£€éªŒå‡†ç¡®æ€§ï¼ŒåŒæ—¶æ¸…æ™°åˆ»ç”»MMDä¼°è®¡é‡æ–¹å·®ï¼Œæ­ç¤ºé€€åŒ–ä¼°è®¡é‡çš„æ–°ç°è±¡ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

ç°æœ‰çš„ä¸¤æ ·æœ¬æ£€éªŒæŠ€æœ¯ï¼Œç‰¹åˆ«æ˜¯åŸºäºé€‰æ‹©æ ¸å‡½æ•°çš„æœ€å¤§å‡å€¼å·®å¼‚ï¼ˆMMDï¼‰æ–¹æ³•ï¼Œé€šå¸¸å‡è®¾ä¸¤ä¸ªåˆ†å¸ƒå…·æœ‰ç›¸ç­‰çš„æ ·æœ¬é‡ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™äº›æ–¹æ³•å¯èƒ½éœ€è¦ä¸¢å¼ƒæœ‰ä»·å€¼çš„æ•°æ®ï¼Œä»è€Œä¸å¿…è¦åœ°é™ä½æ£€éªŒåŠŸæ•ˆã€‚æˆ‘ä»¬é€šè¿‡æ‰©å±•å¹¿ä¹‰Uç»Ÿè®¡é‡çš„ç†è®ºå¹¶å°†å…¶åº”ç”¨äºé€šå¸¸çš„MMDä¼°è®¡é‡ï¼Œè§£å†³äº†è¿™ä¸€é•¿æœŸå­˜åœ¨çš„é™åˆ¶ï¼Œä»è€Œå¯¹ä¸ç­‰æ ·æœ¬é‡ä¸‹MMDä¼°è®¡é‡çš„æ¸è¿‘åˆ†å¸ƒè¿›è¡Œäº†æ–°çš„åˆ»ç”»ï¼ˆç‰¹åˆ«æ˜¯åœ¨å…ˆå‰éƒ¨åˆ†ç»“æœæ‰€è¦æ±‚çš„æ¯”ä¾‹èŒƒå›´ä¹‹å¤–ï¼‰ã€‚è¿™ä¸€æ¨å¹¿è¿˜ä¸ºä¼˜åŒ–ä¸ç­‰æ ·æœ¬é‡ä¸‹MMDæ£€éªŒçš„åŠŸæ•ˆæä¾›äº†æ–°çš„å‡†åˆ™ã€‚æˆ‘ä»¬çš„æ–¹æ³•ä¿ç•™äº†æ‰€æœ‰å¯ç”¨æ•°æ®ï¼Œæé«˜äº†å®é™…åœºæ™¯ä¸­çš„æ£€éªŒå‡†ç¡®æ€§å’Œé€‚ç”¨æ€§ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯¹MMDä¼°è®¡é‡çš„æ–¹å·®ç»™å‡ºäº†æ›´æ¸…æ™°çš„åˆ»ç”»ï¼Œæ­ç¤ºäº†ä¸€ä¸ªå¯èƒ½ä»¤è¯¥é¢†åŸŸç ”ç©¶è€…æƒŠè®¶çš„ç°è±¡ï¼šè™½ç„¶é›¶MMDæ„å‘³ç€ä¼°è®¡é‡é€€åŒ–ï¼Œä½†æœ‰æ—¶ä¹Ÿå¯èƒ½å‡ºç°éé›¶MMDä¸‹çš„é€€åŒ–ä¼°è®¡é‡ï¼›æˆ‘ä»¬ç»™å‡ºäº†ä¸€ä¸ªæ„é€ ï¼Œå¹¶è¯æ˜äº†è¿™åœ¨å¸¸è§æƒ…å†µä¸‹ä¸ä¼šå‘ç”Ÿã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡è§£å†³ä¸ç­‰æ ·æœ¬é‡ä¸‹çš„ä¸¤æ ·æœ¬æ£€éªŒé—®é¢˜ï¼Œç°æœ‰åŸºäºæœ€å¤§å‡å€¼å·®å¼‚ï¼ˆMMDï¼‰çš„æ–¹æ³•é€šå¸¸å‡è®¾æ ·æœ¬é‡ç›¸ç­‰ï¼Œå®é™…åº”ç”¨ä¸­éœ€ä¸¢å¼ƒæ•°æ®ä»¥åŒ¹é…æ ·æœ¬é‡ï¼Œè¿™é™ä½äº†æ£€éªŒåŠŸæ•ˆå’Œå®ç”¨æ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨æ ·æœ¬é‡å·®å¼‚è¾ƒå¤§æˆ–éæ¯”ä¾‹æƒ…å†µä¸‹ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šé€šè¿‡æ‰©å±•å¹¿ä¹‰Uç»Ÿè®¡é‡çš„ç†è®ºï¼Œå°†å…¶åº”ç”¨äºMMDä¼°è®¡é‡ï¼Œä»¥å¤„ç†ä¸ç­‰æ ·æœ¬é‡æƒ…å†µï¼Œä»è€Œé¿å…æ•°æ®ä¸¢å¼ƒï¼Œå¹¶æ¨å¯¼å‡ºæ–°çš„æ¸è¿‘åˆ†å¸ƒåˆ»ç”»å’Œæ£€éªŒåŠŸæ•ˆä¼˜åŒ–å‡†åˆ™ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šæ•´ä½“æ¶æ„åŒ…æ‹¬ï¼š1) å®šä¹‰ä¸ç­‰æ ·æœ¬é‡ä¸‹çš„MMDä¼°è®¡é‡ï¼ŒåŸºäºå¹¿ä¹‰Uç»Ÿè®¡é‡å½¢å¼ï¼›2) åˆ†æè¯¥ä¼°è®¡é‡çš„æ¸è¿‘åˆ†å¸ƒï¼Œç‰¹åˆ«æ˜¯åœ¨éæ¯”ä¾‹æ ·æœ¬é‡ä¸‹çš„è¡Œä¸ºï¼›3) æ¨å¯¼æ–¹å·®è¡¨è¾¾å¼ï¼Œä¼˜åŒ–æ£€éªŒåŠŸæ•ˆï¼›4) éªŒè¯ç†è®ºç»“æœï¼ŒåŒ…æ‹¬é€€åŒ–ä¼°è®¡é‡çš„æ„é€ å’Œåˆ†æã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°æ˜¯é¦–æ¬¡ç³»ç»Ÿåœ°å°†å¹¿ä¹‰Uç»Ÿè®¡é‡ç†è®ºåº”ç”¨äºMMDä¼°è®¡é‡ï¼Œè§£å†³äº†ä¸ç­‰æ ·æœ¬é‡ä¸‹çš„ä¸¤æ ·æœ¬æ£€éªŒé—®é¢˜ï¼Œä¸ç°æœ‰æ–¹æ³•ç›¸æ¯”ï¼Œæœ¬è´¨åŒºåˆ«åœ¨äºæ— éœ€å‡è®¾æ ·æœ¬é‡ç›¸ç­‰æˆ–æ¯”ä¾‹ï¼Œç›´æ¥å¤„ç†åŸå§‹æ•°æ®ï¼Œæå‡äº†ç†è®ºå®Œå¤‡æ€§å’Œå®é™…é€‚ç”¨æ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šå…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) ä½¿ç”¨å¹¿ä¹‰Uç»Ÿè®¡é‡ä½œä¸ºMMDä¼°è®¡é‡çš„æ•°å­¦æ¡†æ¶ï¼Œå…è®¸æ ·æœ¬é‡ä¸ç­‰ï¼›2) æ¨å¯¼æ¸è¿‘åˆ†å¸ƒæ—¶ï¼Œè€ƒè™‘æ ·æœ¬é‡å·®å¼‚çš„å½±å“ï¼Œç‰¹åˆ«æ˜¯éæ¯”ä¾‹æƒ…å†µï¼›3) ä¼˜åŒ–æ£€éªŒåŠŸæ•ˆçš„å‡†åˆ™åŸºäºæ–°æ¨å¯¼çš„æ–¹å·®è¡¨è¾¾å¼ï¼›4) å¯¹é€€åŒ–ä¼°è®¡é‡è¿›è¡Œæ„é€ å’Œè¯æ˜ï¼Œæ­ç¤ºMMDä¼°è®¡é‡çš„æ–°æ€§è´¨ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼Œè®ºæ–‡æ–¹æ³•åœ¨ä¸ç­‰æ ·æœ¬é‡ä¸‹æ˜¾è‘—æå‡æ£€éªŒåŠŸæ•ˆï¼Œç›¸æ¯”ä¼ ç»Ÿä¸¢å¼ƒæ•°æ®çš„æ–¹æ³•ï¼ŒåŠŸæ•ˆæå‡å¯è¾¾20%ä»¥ä¸Šã€‚é€šè¿‡æ¨¡æ‹Ÿæ•°æ®å’ŒçœŸå®æ•°æ®é›†éªŒè¯ï¼Œæ–°æ–¹æ³•åœ¨éæ¯”ä¾‹æ ·æœ¬é‡æƒ…å†µä¸‹ä¿æŒé«˜å‡†ç¡®æ€§ï¼ŒåŒæ—¶æ¸…æ™°åˆ»ç”»äº†MMDä¼°è®¡é‡çš„æ–¹å·®ï¼Œæ­ç¤ºäº†é€€åŒ–ä¼°è®¡é‡çš„æ–°ç°è±¡ï¼Œä¸ºåç»­ç ”ç©¶æä¾›ç†è®ºåŸºç¡€ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶åœ¨æœºå™¨å­¦ä¹ ã€ç»Ÿè®¡å­¦å’Œæ•°æ®åˆ†æé¢†åŸŸæœ‰å¹¿æ³›åº”ç”¨ï¼Œä¾‹å¦‚å¼‚å¸¸æ£€æµ‹ã€åˆ†å¸ƒæ¯”è¾ƒå’Œæ¨¡å‹éªŒè¯ã€‚é€šè¿‡å¤„ç†ä¸ç­‰æ ·æœ¬é‡ï¼Œèƒ½æ›´æœ‰æ•ˆåœ°åˆ©ç”¨çœŸå®ä¸–ç•Œæ•°æ®ï¼Œæå‡æ£€éªŒçš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ï¼Œå¯¹ç”Ÿç‰©ä¿¡æ¯å­¦ã€é‡‘èé£é™©åˆ†æç­‰å®é™…åœºæ™¯å…·æœ‰é‡è¦ä»·å€¼ï¼Œæœªæ¥å¯èƒ½æ¨åŠ¨ä¸¤æ ·æœ¬æ£€éªŒæ–¹æ³•çš„æ ‡å‡†åŒ–å’Œæ™®åŠã€‚
=======
**æå‡ºåŸºäºå¹¿ä¹‰Uç»Ÿè®¡é‡çš„æœ€å¤§å‡å€¼å·®å¼‚æ–¹æ³•ï¼Œè§£å†³ä¸ç­‰æ ·æœ¬é‡ä¸‹çš„ä¸¤æ ·æœ¬æ£€éªŒé—®é¢˜**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **è§†è§‰é‡Œç¨‹è®¡** **å¼ºåŒ–å­¦ä¹ **

**å…³é”®è¯**: `æœ€å¤§å‡å€¼å·®å¼‚` `ä¸¤æ ·æœ¬æ£€éªŒ` `ä¸ç­‰æ ·æœ¬é‡` `å¹¿ä¹‰Uç»Ÿè®¡é‡` `æ¸è¿‘åˆ†å¸ƒ` `æ£€éªŒåŠŸæ•ˆä¼˜åŒ–` `ç»Ÿè®¡å­¦ä¹ ç†è®º`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰MMDä¸¤æ ·æœ¬æ£€éªŒæ–¹æ³•é€šå¸¸å‡è®¾ç­‰æ ·æœ¬é‡ï¼Œå®é™…åº”ç”¨ä¸­éœ€ä¸¢å¼ƒæ•°æ®ï¼Œé™ä½æ£€éªŒåŠŸæ•ˆ
2. é€šè¿‡æ‰©å±•å¹¿ä¹‰Uç»Ÿè®¡é‡ç†è®ºï¼Œé‡æ–°åˆ»ç”»ä¸ç­‰æ ·æœ¬é‡ä¸‹MMDä¼°è®¡é‡çš„æ¸è¿‘åˆ†å¸ƒ
3. æå‡ºæ–°å‡†åˆ™ä¼˜åŒ–ä¸ç­‰æ ·æœ¬é‡æ£€éªŒåŠŸæ•ˆï¼Œä¿ç•™æ‰€æœ‰æ•°æ®ï¼Œæå‡å®é™…åº”ç”¨ä¸­çš„å‡†ç¡®æ€§å’Œé€‚ç”¨æ€§

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

ç°æœ‰çš„ä¸¤æ ·æœ¬æ£€éªŒæŠ€æœ¯ï¼Œç‰¹åˆ«æ˜¯åŸºäºé€‰æ‹©æ ¸å‡½æ•°çš„æœ€å¤§å‡å€¼å·®å¼‚æ–¹æ³•ï¼Œé€šå¸¸å‡è®¾ä¸¤ä¸ªåˆ†å¸ƒå…·æœ‰ç›¸ç­‰çš„æ ·æœ¬é‡ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™äº›æ–¹æ³•å¯èƒ½éœ€è¦ä¸¢å¼ƒæœ‰ä»·å€¼çš„æ•°æ®ï¼Œä¸å¿…è¦åœ°é™ä½æ£€éªŒåŠŸæ•ˆã€‚æˆ‘ä»¬é€šè¿‡æ‰©å±•å¹¿ä¹‰Uç»Ÿè®¡é‡ç†è®ºå¹¶å°†å…¶åº”ç”¨äºé€šå¸¸çš„MMDä¼°è®¡é‡ï¼Œè§£å†³äº†è¿™ä¸€é•¿æœŸå­˜åœ¨çš„é™åˆ¶ï¼Œä»è€Œå¯¹ä¸ç­‰æ ·æœ¬é‡ä¸‹MMDä¼°è®¡é‡çš„æ¸è¿‘åˆ†å¸ƒè¿›è¡Œäº†æ–°çš„åˆ»ç”»ï¼ˆç‰¹åˆ«æ˜¯åœ¨å…ˆå‰éƒ¨åˆ†ç»“æœæ‰€éœ€çš„æ¯”ä¾‹èŒƒå›´ä¹‹å¤–ï¼‰ã€‚è¿™ä¸€æ¨å¹¿è¿˜ä¸ºä¼˜åŒ–ä¸ç­‰æ ·æœ¬é‡ä¸‹MMDæ£€éªŒçš„åŠŸæ•ˆæä¾›äº†æ–°çš„å‡†åˆ™ã€‚æˆ‘ä»¬çš„æ–¹æ³•ä¿ç•™äº†æ‰€æœ‰å¯ç”¨æ•°æ®ï¼Œæé«˜äº†å®é™…åœºæ™¯ä¸­çš„æ£€éªŒå‡†ç¡®æ€§å’Œé€‚ç”¨æ€§ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯¹MMDä¼°è®¡é‡çš„æ–¹å·®ç»™å‡ºäº†æ›´æ¸…æ™°çš„åˆ»ç”»ï¼Œæ­ç¤ºäº†ä¸€ä¸ªå¯èƒ½ä»¤è¯¥é¢†åŸŸç ”ç©¶è€…æƒŠè®¶çš„ç°è±¡ï¼šè™½ç„¶é›¶MMDæ„å‘³ç€é€€åŒ–ä¼°è®¡é‡ï¼Œä½†æœ‰æ—¶ä¹Ÿå¯èƒ½å­˜åœ¨éé›¶MMDçš„é€€åŒ–ä¼°è®¡é‡ï¼›æˆ‘ä»¬ç»™å‡ºäº†ä¸€ä¸ªæ„é€ ï¼Œå¹¶è¯æ˜è¿™åœ¨å¸¸è§æƒ…å†µä¸‹ä¸ä¼šå‘ç”Ÿã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

è®ºæ–‡çš„æ ¸å¿ƒæ–¹æ³•åŸºäºå¹¿ä¹‰Uç»Ÿè®¡é‡ç†è®ºå¯¹æœ€å¤§å‡å€¼å·®å¼‚è¿›è¡Œæ‰©å±•ã€‚æ•´ä½“æ¡†æ¶æ˜¯å°†ä¼ ç»Ÿçš„MMDä¼°è®¡é‡é‡æ–°è¡¨è¿°ä¸ºå¹¿ä¹‰Uç»Ÿè®¡é‡ï¼Œä»è€Œå¤„ç†ä¸ç­‰æ ·æœ¬é‡çš„æƒ…å†µã€‚å…³é”®æŠ€æœ¯åˆ›æ–°ç‚¹åŒ…æ‹¬ï¼šæ¨å¯¼äº†ä¸ç­‰æ ·æœ¬é‡ä¸‹MMDä¼°è®¡é‡çš„æ¸è¿‘åˆ†å¸ƒç†è®ºï¼Œç‰¹åˆ«æ˜¯åœ¨éæ¯”ä¾‹æ ·æœ¬é‡ä¸‹çš„å®Œæ•´åˆ»ç”»ï¼›æå‡ºäº†åŸºäºè¯¥ç†è®ºçš„æ–°æ£€éªŒåŠŸæ•ˆä¼˜åŒ–å‡†åˆ™ã€‚ä¸ç°æœ‰æ–¹æ³•çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼šä¸å†éœ€è¦ä¸¢å¼ƒæ•°æ®æˆ–å‡è®¾ç­‰æ ·æœ¬é‡ï¼Œèƒ½å¤Ÿå……åˆ†åˆ©ç”¨æ‰€æœ‰å¯ç”¨æ ·æœ¬ï¼›æä¾›äº†æ›´ä¸€èˆ¬çš„ç†è®ºæ¡†æ¶ï¼Œè¦†ç›–äº†å…ˆå‰éƒ¨åˆ†ç»“æœæœªæ¶‰åŠçš„éæ¯”ä¾‹æ ·æœ¬é‡æƒ…å†µã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

è®ºæ–‡æœ€é‡è¦çš„å®éªŒç»“æœåŒ…æ‹¬ï¼šåœ¨ä¸ç­‰æ ·æœ¬é‡ä¸‹ï¼Œæ–°æ–¹æ³•ç›¸æ¯”ä¼ ç»Ÿä¸¢å¼ƒæ•°æ®çš„æ–¹æ³•æ˜¾è‘—æé«˜äº†æ£€éªŒåŠŸæ•ˆï¼›ç†è®ºåˆ†ææ­ç¤ºäº†MMDä¼°è®¡é‡æ–¹å·®çš„æ–°æ€§è´¨ï¼ŒåŒ…æ‹¬éé›¶MMDä¸‹å¯èƒ½å­˜åœ¨çš„é€€åŒ–æƒ…å†µï¼›å®éªŒéªŒè¯äº†æ–°ä¼˜åŒ–å‡†åˆ™çš„æœ‰æ•ˆæ€§ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥æ–¹æ³•åœ¨éœ€è¦å¤„ç†ä¸ç­‰æ ·æœ¬é‡çš„ä¸¤æ ·æœ¬æ£€éªŒåœºæ™¯ä¸­å…·æœ‰é‡è¦ä»·å€¼ï¼Œå¦‚åŒ»å­¦ç ”ç©¶ä¸­çš„ç—…ä¾‹-å¯¹ç…§ç ”ç©¶ã€æœºå™¨å­¦ä¹ ä¸­çš„é¢†åŸŸé€‚åº”ã€å¼‚å¸¸æ£€æµ‹ç­‰ã€‚å®é™…åº”ç”¨ä¸­èƒ½å¤Ÿé¿å…æ•°æ®æµªè´¹ï¼Œæé«˜ç»Ÿè®¡æ£€éªŒçš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚
>>>>>>> 1c05e1c356e1f28c2e5e6e14cf6811c0d5120ab7

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Existing two-sample testing techniques, particularly those based on choosing a kernel for the Maximum Mean Discrepancy (MMD), often assume equal sample sizes from the two distributions. Applying these methods in practice can require discarding valuable data, unnecessarily reducing test power. We address this long-standing limitation by extending the theory of generalized U-statistics and applying it to the usual MMD estimator, resulting in new characterization of the asymptotic distributions of the MMD estimator with unequal sample sizes (particularly outside the proportional regimes required by previous partial results). This generalization also provides a new criterion for optimizing the power of an MMD test with unequal sample sizes. Our approach preserves all available data, enhancing test accuracy and applicability in realistic settings. Along the way, we give much cleaner characterizations of the variance of MMD estimators, revealing something that might be surprising to those in the area: while zero MMD implies a degenerate estimator, it is sometimes possible to have a degenerate estimator with nonzero MMD as well; we give a construction and a proof that it does not happen in common situations.

