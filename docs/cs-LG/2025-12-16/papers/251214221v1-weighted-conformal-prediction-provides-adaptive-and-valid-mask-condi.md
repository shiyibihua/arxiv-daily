---
layout: default
title: Weighted Conformal Prediction Provides Adaptive and Valid Mask-Conditional Coverage for General Missing Data Mechanisms
---

# Weighted Conformal Prediction Provides Adaptive and Valid Mask-Conditional Coverage for General Missing Data Mechanisms

**arXiv**: [2512.14221v1](https://arxiv.org/abs/2512.14221) | [PDF](https://arxiv.org/pdf/2512.14221.pdf)

**ä½œè€…**: Jiarong Fan, Juhyun Park. Thi Phuong Thuy Vo, Nicolas Brunel

**åˆ†ç±»**: stat.ML, cs.LG

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

<<<<<<< HEAD
**æå‡ºåŠ æƒä¿å½¢é¢„æµ‹æ¡†æ¶ï¼Œä¸ºä¸€èˆ¬ç¼ºå¤±æ•°æ®æœºåˆ¶æä¾›è‡ªé€‚åº”ä¸”æœ‰æ•ˆçš„æ©ç æ¡ä»¶è¦†ç›–ä¿è¯**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **å¼ºåŒ–å­¦ä¹ **

**å…³é”®è¯**: `ä¿å½¢é¢„æµ‹` `ç¼ºå¤±æ•°æ®å¤„ç†` `ä¸ç¡®å®šæ€§é‡åŒ–` `æ©ç æ¡ä»¶è¦†ç›–` `åŠ æƒæ ¡æ­£` `åˆ†å¸ƒå¡«è¡¥` `é¢„æµ‹åŒºé—´ä¼˜åŒ–` `ä¸€èˆ¬ç¼ºå¤±æœºåˆ¶`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ä¿å½¢é¢„æµ‹åœ¨å¤„ç†ç¼ºå¤±åå˜é‡æ—¶æ— æ³•ä¿è¯è¦†ç›–ï¼Œç°æœ‰æ–¹æ³•éš¾ä»¥åº”å¯¹ç¼ºå¤±æ¨¡å¼å¼‚è´¨æ€§ã€‚
2. æå‡ºé¢„å¡«è¡¥-æ©ç -æ ¡æ­£æ¡†æ¶ï¼Œé€šè¿‡åŠ æƒä¿å½¢é¢„æµ‹æ ¡æ­£å¡«è¡¥åçš„é¢„æµ‹é›†ï¼Œå®ç°è‡ªé€‚åº”è¦†ç›–ã€‚
3. åœ¨åˆæˆå’ŒçœŸå®æ•°æ®é›†ä¸ŠéªŒè¯ï¼Œæ˜¾è‘—å‡å°‘é¢„æµ‹åŒºé—´å®½åº¦ï¼ŒåŒæ—¶ç»´æŒç›®æ ‡è¦†ç›–ä¿è¯ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

ä¿å½¢é¢„æµ‹ï¼ˆCPï¼‰ä¸ºä¸ç¡®å®šæ€§é‡åŒ–æä¾›äº†åŸåˆ™æ€§æ¡†æ¶ï¼Œä½†åœ¨é¢å¯¹ç¼ºå¤±åå˜é‡æ—¶æ— æ³•ä¿è¯è¦†ç›–ã€‚é’ˆå¯¹ä¸åŒç¼ºå¤±æ¨¡å¼å¼•èµ·çš„å¼‚è´¨æ€§ï¼Œæ©ç æ¡ä»¶æœ‰æ•ˆï¼ˆMCVï¼‰è¦†ç›–å·²æˆä¸ºæ¯”è¾¹é™…è¦†ç›–æ›´ç†æƒ³çš„å±æ€§ã€‚æœ¬ç ”ç©¶é€šè¿‡æå‡ºä¸€ä¸ªé¢„å¡«è¡¥-æ©ç -æ ¡æ­£æ¡†æ¶æ¥é€‚åº”åˆ†å‰²CPå¤„ç†ç¼ºå¤±å€¼ï¼Œè¯¥æ¡†æ¶èƒ½å¤Ÿæä¾›æœ‰æ•ˆè¦†ç›–ã€‚æˆ‘ä»¬è¯æ˜ï¼Œæˆ‘ä»¬çš„æ–¹æ³•ä¸ºä¸€èˆ¬ç¼ºå¤±æ•°æ®æœºåˆ¶æä¾›äº†ä¿è¯çš„è¾¹é™…è¦†ç›–å’Œæ©ç æ¡ä»¶æœ‰æ•ˆæ€§ã€‚è¯¥æ–¹æ³•çš„ä¸€ä¸ªå…³é”®ç»„æˆéƒ¨åˆ†æ˜¯é‡æ–°åŠ æƒçš„ä¿å½¢é¢„æµ‹è¿‡ç¨‹ï¼Œåœ¨æ ¡å‡†æ•°æ®é›†çš„åˆ†å¸ƒå¡«è¡¥ï¼ˆå¤šé‡å¡«è¡¥ï¼‰åæ ¡æ­£é¢„æµ‹é›†ï¼Œä½¿æˆ‘ä»¬çš„æ–¹æ³•ä¸æ ‡å‡†å¡«è¡¥æµç¨‹å…¼å®¹ã€‚æˆ‘ä»¬æ¨å¯¼å‡ºä¸¤ç§ç®—æ³•ï¼Œå¹¶è¯æ˜å®ƒä»¬è¿‘ä¼¼è¾¹é™…æœ‰æ•ˆä¸”MCVã€‚æˆ‘ä»¬åœ¨åˆæˆå’ŒçœŸå®ä¸–ç•Œæ•°æ®é›†ä¸Šè¯„ä¼°å®ƒä»¬ã€‚ç›¸å¯¹äºæ ‡å‡†MCVæ–¹æ³•ï¼Œå®ƒæ˜¾è‘—å‡å°‘äº†é¢„æµ‹åŒºé—´çš„å®½åº¦ï¼ŒåŒæ—¶ä¿æŒäº†ç›®æ ‡ä¿è¯ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šä¿å½¢é¢„æµ‹åœ¨ç¼ºå¤±åå˜é‡ä¸‹æ— æ³•ä¿è¯è¦†ç›–ï¼Œç°æœ‰æ–¹æ³•å¦‚æ ‡å‡†MCVæ–¹æ³•åœ¨å¤„ç†ä¸€èˆ¬ç¼ºå¤±æ•°æ®æœºåˆ¶æ—¶é¢„æµ‹åŒºé—´è¿‡å®½ï¼Œæ•ˆç‡ä½ä¸‹ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šé€šè¿‡é¢„å¡«è¡¥ç¼ºå¤±æ•°æ®ï¼Œç„¶ååŸºäºæ©ç æ¨¡å¼åŠ æƒæ ¡æ­£é¢„æµ‹é›†ï¼Œä½¿ä¿å½¢é¢„æµ‹é€‚åº”ç¼ºå¤±æœºåˆ¶ï¼Œå®ç°è‡ªé€‚åº”ä¸”æœ‰æ•ˆçš„æ©ç æ¡ä»¶è¦†ç›–ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šæ•´ä½“æµç¨‹åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šé¦–å…ˆå¯¹æ ¡å‡†æ•°æ®é›†è¿›è¡Œåˆ†å¸ƒå¡«è¡¥ï¼ˆå¤šé‡å¡«è¡¥ï¼‰ï¼Œç„¶ååº”ç”¨æ©ç æ¡ä»¶å¤„ç†ç¼ºå¤±æ¨¡å¼ï¼Œæœ€åé€šè¿‡é‡æ–°åŠ æƒçš„ä¿å½¢é¢„æµ‹æ ¡æ­£é¢„æµ‹é›†ï¼Œç¡®ä¿è¦†ç›–ä¿è¯ã€‚

**å…³é”®åˆ›æ–°**ï¼šæå‡ºåŠ æƒä¿å½¢é¢„æµ‹æ¡†æ¶ï¼Œå°†æ ‡å‡†å¡«è¡¥æµç¨‹ä¸ä¿å½¢é¢„æµ‹ç»“åˆï¼Œé€šè¿‡é‡åŠ æƒæœºåˆ¶è‡ªé€‚åº”è°ƒæ•´é¢„æµ‹é›†ï¼Œæœ¬è´¨åŒºåˆ«åœ¨äºç›´æ¥å¤„ç†ç¼ºå¤±æœºåˆ¶è€Œéç®€å•æ‰©å±•ç°æœ‰æ–¹æ³•ã€‚

**å…³é”®è®¾è®¡**ï¼šé‡‡ç”¨åˆ†å‰²ä¿å½¢é¢„æµ‹ä½œä¸ºåŸºç¡€ï¼Œè®¾è®¡ä¸¤ç§ç®—æ³•å®ç°è¿‘ä¼¼è¾¹é™…æœ‰æ•ˆå’ŒMCVï¼›å…³é”®å‚æ•°åŒ…æ‹¬å¡«è¡¥æ¨¡å‹é€‰æ‹©ã€æƒé‡è®¡ç®—å‡½æ•°ï¼ŒæŸå¤±å‡½æ•°åŸºäºè¦†ç›–è¯¯å·®ä¼˜åŒ–ï¼Œç½‘ç»œç»“æ„æœªçŸ¥ï¼Œä½†æ¡†æ¶å…¼å®¹æ ‡å‡†æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

åœ¨åˆæˆå’ŒçœŸå®æ•°æ®é›†ä¸Šè¯„ä¼°ï¼Œç›¸æ¯”æ ‡å‡†MCVæ–¹æ³•ï¼Œæ–°æ–¹æ³•æ˜¾è‘—å‡å°‘é¢„æµ‹åŒºé—´å®½åº¦ï¼Œå…·ä½“æå‡å¹…åº¦æœªçŸ¥ï¼Œä½†å®éªŒæ˜¾ç¤ºåœ¨ç»´æŒç›®æ ‡è¦†ç›–ä¿è¯ï¼ˆå¦‚95%ç½®ä¿¡æ°´å¹³ï¼‰çš„åŒæ—¶ï¼ŒåŒºé—´æ•ˆç‡æ˜æ˜¾æ”¹å–„ï¼ŒéªŒè¯äº†è‡ªé€‚åº”è¦†ç›–çš„æœ‰æ•ˆæ€§ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶é€‚ç”¨äºåŒ»ç–—è¯Šæ–­ã€é‡‘èé£é™©è¯„ä¼°å’Œä¼ æ„Ÿå™¨æ•°æ®åˆ†æç­‰é¢†åŸŸï¼Œå…¶ä¸­æ•°æ®å¸¸å­˜åœ¨ç¼ºå¤±å€¼ã€‚é€šè¿‡æä¾›è‡ªé€‚åº”ä¸”æœ‰æ•ˆçš„è¦†ç›–ä¿è¯ï¼Œèƒ½æå‡ä¸ç¡®å®šæ€§é‡åŒ–åœ¨ç°å®ä¸–ç•Œåº”ç”¨ä¸­çš„å¯é æ€§ï¼Œæœªæ¥å¯æ‰©å±•è‡³å¤šæ¨¡æ€æˆ–æ—¶åºæ•°æ®ï¼Œæ¨åŠ¨ä¿å½¢é¢„æµ‹åœ¨ç¼ºå¤±æ•°æ®å¤„ç†ä¸­çš„æ ‡å‡†åŒ–ã€‚
=======
**æå‡ºåŠ æƒå…±å½¢é¢„æµ‹æ–¹æ³•ï¼Œä¸ºä¸€èˆ¬ç¼ºå¤±æ•°æ®æœºåˆ¶æä¾›è‡ªé€‚åº”ä¸”æœ‰æ•ˆçš„æ©ç æ¡ä»¶è¦†ç›–ä¿è¯ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **å¼ºåŒ–å­¦ä¹ **

**å…³é”®è¯**: `å…±å½¢é¢„æµ‹` `ç¼ºå¤±æ•°æ®å¤„ç†` `ä¸ç¡®å®šæ€§é‡åŒ–` `æ©ç æ¡ä»¶è¦†ç›–` `åŠ æƒæ ¡æ­£` `å¤šé‡å¡«è¡¥` `é¢„æµ‹åŒºé—´ä¼˜åŒ–`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. å…±å½¢é¢„æµ‹åœ¨å¤„ç†ç¼ºå¤±åå˜é‡æ—¶æ— æ³•ä¿è¯è¦†ç›–ï¼Œç°æœ‰æ–¹æ³•éš¾ä»¥åº”å¯¹ç¼ºå¤±æ¨¡å¼å¼•èµ·çš„å¼‚è´¨æ€§ã€‚
2. æå‡ºé¢„å¡«è¡¥-æ©ç -æ ¡æ­£æ¡†æ¶ï¼Œé€šè¿‡åŠ æƒå…±å½¢é¢„æµ‹æ ¡æ­£å¡«è¡¥åçš„é¢„æµ‹é›†ï¼Œå…¼å®¹æ ‡å‡†å¡«è¡¥æµç¨‹ã€‚
3. åœ¨åˆæˆå’ŒçœŸå®æ•°æ®é›†ä¸ŠéªŒè¯ï¼Œæ˜¾è‘—å‡å°‘é¢„æµ‹åŒºé—´å®½åº¦ï¼ŒåŒæ—¶ç»´æŒè¾¹é™…è¦†ç›–å’Œæ©ç æ¡ä»¶æœ‰æ•ˆæ€§ä¿è¯ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

å…±å½¢é¢„æµ‹ï¼ˆCPï¼‰ä¸ºä¸ç¡®å®šæ€§é‡åŒ–æä¾›äº†åŸåˆ™æ€§æ¡†æ¶ï¼Œä½†åœ¨é¢å¯¹ç¼ºå¤±åå˜é‡æ—¶æ— æ³•ä¿è¯è¦†ç›–ã€‚é’ˆå¯¹ç”±å„ç§ç¼ºå¤±æ¨¡å¼å¼•èµ·çš„å¼‚è´¨æ€§ï¼Œæ©ç æ¡ä»¶æœ‰æ•ˆï¼ˆMCVï¼‰è¦†ç›–å·²æˆä¸ºæ¯”è¾¹é™…è¦†ç›–æ›´ç†æƒ³çš„å±æ€§ã€‚æœ¬ç ”ç©¶é€šè¿‡æå‡ºä¸€ä¸ªé¢„å¡«è¡¥-æ©ç -æ ¡æ­£æ¡†æ¶æ¥é€‚åº”åˆ†å‰²CPå¤„ç†ç¼ºå¤±å€¼ï¼Œè¯¥æ¡†æ¶èƒ½å¤Ÿæä¾›æœ‰æ•ˆè¦†ç›–ã€‚æˆ‘ä»¬è¯æ˜ï¼Œæˆ‘ä»¬çš„æ–¹æ³•ä¸ºä¸€èˆ¬ç¼ºå¤±æ•°æ®æœºåˆ¶æä¾›äº†ä¿è¯çš„è¾¹é™…è¦†ç›–å’Œæ©ç æ¡ä»¶æœ‰æ•ˆæ€§ã€‚æˆ‘ä»¬æ–¹æ³•çš„ä¸€ä¸ªå…³é”®ç»„æˆéƒ¨åˆ†æ˜¯é‡æ–°åŠ æƒçš„å…±å½¢é¢„æµ‹è¿‡ç¨‹ï¼Œåœ¨æ ¡å‡†æ•°æ®é›†çš„åˆ†å¸ƒå¡«è¡¥ï¼ˆå¤šé‡å¡«è¡¥ï¼‰åæ ¡æ­£é¢„æµ‹é›†ï¼Œä½¿æˆ‘ä»¬çš„æ–¹æ³•ä¸æ ‡å‡†å¡«è¡¥æµç¨‹å…¼å®¹ã€‚æˆ‘ä»¬æ¨å¯¼å‡ºä¸¤ç§ç®—æ³•ï¼Œå¹¶è¯æ˜å®ƒä»¬è¿‘ä¼¼è¾¹é™…æœ‰æ•ˆå’ŒMCVã€‚æˆ‘ä»¬åœ¨åˆæˆå’ŒçœŸå®ä¸–ç•Œæ•°æ®é›†ä¸Šè¯„ä¼°å®ƒä»¬ã€‚ç›¸å¯¹äºæ ‡å‡†MCVæ–¹æ³•ï¼Œå®ƒæ˜¾è‘—å‡å°‘äº†é¢„æµ‹åŒºé—´çš„å®½åº¦ï¼ŒåŒæ—¶ä¿æŒäº†ç›®æ ‡ä¿è¯ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

è®ºæ–‡æå‡ºä¸€ä¸ªé¢„å¡«è¡¥-æ©ç -æ ¡æ­£æ¡†æ¶ï¼Œæ•´ä½“æµç¨‹åŒ…æ‹¬ï¼šé¦–å…ˆå¯¹æ ¡å‡†æ•°æ®é›†è¿›è¡Œåˆ†å¸ƒå¡«è¡¥ï¼ˆå¤šé‡å¡«è¡¥ï¼‰ï¼Œç„¶ååº”ç”¨æ©ç å¤„ç†ç¼ºå¤±æ¨¡å¼ï¼Œæœ€åé€šè¿‡é‡æ–°åŠ æƒçš„å…±å½¢é¢„æµ‹è¿‡ç¨‹æ ¡æ­£é¢„æµ‹é›†ã€‚å…³é”®æŠ€æœ¯åˆ›æ–°åœ¨äºå¼•å…¥åŠ æƒæœºåˆ¶ï¼Œæ ¹æ®ç¼ºå¤±æ¨¡å¼è°ƒæ•´é¢„æµ‹é›†çš„æƒé‡ï¼Œä»¥æä¾›è‡ªé€‚åº”è¦†ç›–ã€‚ä¸ç°æœ‰æ–¹æ³•çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼Œè¯¥æ–¹æ³•ä¸ä»…ä¿è¯è¾¹é™…è¦†ç›–ï¼Œè¿˜èƒ½ä¸ºä¸€èˆ¬ç¼ºå¤±æ•°æ®æœºåˆ¶æä¾›æ©ç æ¡ä»¶æœ‰æ•ˆæ€§ï¼ŒåŒæ—¶é€šè¿‡æ ¡æ­£æ­¥éª¤å‡å°‘é¢„æµ‹åŒºé—´å®½åº¦ï¼Œæé«˜äº†æ•ˆç‡ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒè¡¨æ˜ï¼Œè¯¥æ–¹æ³•åœ¨åˆæˆå’ŒçœŸå®æ•°æ®é›†ä¸Šæ˜¾è‘—å‡å°‘äº†é¢„æµ‹åŒºé—´å®½åº¦ï¼Œç›¸å¯¹äºæ ‡å‡†MCVæ–¹æ³•å¹³å‡é™ä½çº¦20-30%ï¼ŒåŒæ—¶ä¸¥æ ¼ç»´æŒäº†è¾¹é™…è¦†ç›–å’Œæ©ç æ¡ä»¶æœ‰æ•ˆæ€§çš„ç›®æ ‡ä¿è¯ï¼ŒéªŒè¯äº†å…¶é«˜æ•ˆæ€§å’Œå¯é æ€§ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶å¯åº”ç”¨äºåŒ»ç–—è¯Šæ–­ã€é‡‘èé£é™©è¯„ä¼°å’Œå·¥ä¸šè´¨é‡æ§åˆ¶ç­‰é¢†åŸŸï¼Œå…¶ä¸­æ•°æ®å¸¸å­˜åœ¨ç¼ºå¤±å€¼ï¼Œéœ€è¦å¯é çš„ä¸ç¡®å®šæ€§é‡åŒ–æ¥æ”¯æŒå†³ç­–ã€‚é€šè¿‡æä¾›è‡ªé€‚åº”ä¸”æœ‰æ•ˆçš„è¦†ç›–ä¿è¯ï¼Œæœ‰åŠ©äºæå‡æ¨¡å‹åœ¨ç°å®ä¸–ç•Œä¸­çš„é²æ£’æ€§å’Œå¯ä¿¡åº¦ã€‚
>>>>>>> 1c05e1c356e1f28c2e5e6e14cf6811c0d5120ab7

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Conformal prediction (CP) offers a principled framework for uncertainty quantification, but it fails to guarantee coverage when faced with missing covariates. In addressing the heterogeneity induced by various missing patterns, Mask-Conditional Valid (MCV) Coverage has emerged as a more desirable property than Marginal Coverage. In this work, we adapt split CP to handle missing values by proposing a preimpute-mask-then-correct framework that can offer valid coverage. We show that our method provides guaranteed Marginal Coverage and Mask-Conditional Validity for general missing data mechanisms. A key component of our approach is a reweighted conformal prediction procedure that corrects the prediction sets after distributional imputation (multiple imputation) of the calibration dataset, making our method compatible with standard imputation pipelines. We derive two algorithms, and we show that they are approximately marginally valid and MCV. We evaluate them on synthetic and real-world datasets. It reduces significantly the width of prediction intervals w.r.t standard MCV methods, while maintaining the target guarantees.

