---
layout: default
title: Diffusion-Based Scenario Tree Generation for Multivariate Time Series Prediction and Multistage Stochastic Optimization
---

# Diffusion-Based Scenario Tree Generation for Multivariate Time Series Prediction and Multistage Stochastic Optimization

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2509.14832" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2509.14832v1</a>
  <a href="https://arxiv.org/pdf/2509.14832.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2509.14832v1" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2509.14832v1', 'Diffusion-Based Scenario Tree Generation for Multivariate Time Series Prediction and Multistage Stochastic Optimization')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Stelios Zarifis, Ioannis Kordonis, Petros Maragos

**åˆ†ç±»**: cs.LG, cs.AI, eess.SY

**å‘å¸ƒæ—¥æœŸ**: 2025-09-18

**å¤‡æ³¨**: 5 pages, 2 figures, 2 tables, and 1 algorithm. This version is submitted to the 51st IEEE International Conference on Acoustics, Speech, and Signal Processing (ICASSP 2026), to be held in Barcelona, Spain, on May 4-8, 2026

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºåŸºäºæ‰©æ•£æ¨¡å‹çš„åœºæ™¯æ ‘ç”Ÿæˆæ¡†æ¶DSTï¼Œç”¨äºå¤šå…ƒæ—¶é—´åºåˆ—é¢„æµ‹å’Œå¤šé˜¶æ®µéšæœºä¼˜åŒ–ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸€ï¼šæœºå™¨äººæ§åˆ¶ (Robot Control)** **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸æ¶æ„ (RL & Architecture)**

**å…³é”®è¯**: `æ‰©æ•£æ¨¡å‹` `åœºæ™¯æ ‘ç”Ÿæˆ` `å¤šå…ƒæ—¶é—´åºåˆ—é¢„æµ‹` `éšæœºä¼˜åŒ–` `èƒ½æºå¥—åˆ©`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. åœ¨èƒ½æºã€é‡‘èç­‰ä¸ç¡®å®šæ€§ç³»ç»Ÿä¸­ï¼Œå‡†ç¡®é¢„æµ‹æœªæ¥åœºæ™¯åˆ†å¸ƒæ˜¯é«˜æ•ˆå†³ç­–çš„å…³é”®ï¼Œç°æœ‰æ–¹æ³•éš¾ä»¥æœ‰æ•ˆå¤„ç†å¤šå…ƒæ—¶é—´åºåˆ—çš„éšæœºé¢„æµ‹ã€‚
2. è®ºæ–‡æå‡ºæ‰©æ•£åœºæ™¯æ ‘ï¼ˆDSTï¼‰æ¡†æ¶ï¼Œåˆ©ç”¨æ‰©æ•£æ¨¡å‹ç”Ÿæˆæœªæ¥è½¨è¿¹ï¼Œå¹¶é€šè¿‡èšç±»æ„å»ºåœºæ™¯æ ‘ï¼Œä¿è¯å†³ç­–çš„éé¢„æœŸæ€§ï¼Œä»è€Œè¿›è¡Œéšæœºä¼˜åŒ–ã€‚
3. å®éªŒè¡¨æ˜ï¼ŒDSTåœ¨èƒ½æºå¥—åˆ©ä¼˜åŒ–ä»»åŠ¡ä¸­ï¼Œä¼˜äºä¼ ç»Ÿæ¨¡å‹å’Œå¼ºåŒ–å­¦ä¹ åŸºçº¿ï¼Œèƒ½äº§ç”Ÿæ›´æœ‰æ•ˆçš„å†³ç­–ç­–ç•¥ï¼Œæ›´å¥½åœ°å¤„ç†ä¸ç¡®å®šæ€§ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

éšæœºé¢„æµ‹å¯¹äºä¸ç¡®å®šç³»ç»Ÿä¸­çš„é«˜æ•ˆå†³ç­–è‡³å…³é‡è¦ï¼Œä¾‹å¦‚èƒ½æºå¸‚åœºå’Œé‡‘èé¢†åŸŸï¼Œåœ¨è¿™äº›é¢†åŸŸä¸­ï¼Œä¼°è®¡æœªæ¥åœºæ™¯çš„å®Œæ•´åˆ†å¸ƒè‡³å…³é‡è¦ã€‚æœ¬æ–‡æå‡ºäº†ä¸€ç§é€šç”¨çš„æ¡†æ¶ï¼Œåä¸ºæ‰©æ•£åœºæ™¯æ ‘ï¼ˆDSTï¼‰ï¼Œè¯¥æ¡†æ¶ä½¿ç”¨åŸºäºæ‰©æ•£çš„æ¦‚ç‡é¢„æµ‹æ¨¡å‹æ¥æ„å»ºå¤šå…ƒé¢„æµ‹ä»»åŠ¡çš„åœºæ™¯æ ‘ã€‚DSTé€’å½’åœ°é‡‡æ ·æœªæ¥è½¨è¿¹ï¼Œå¹¶é€šè¿‡èšç±»å°†å®ƒä»¬ç»„ç»‡æˆæ ‘ï¼Œç¡®ä¿æ¯ä¸ªé˜¶æ®µçš„éé¢„æœŸæ€§ï¼ˆå†³ç­–ä»…å–å†³äºè§‚å¯Ÿåˆ°çš„å†å²ï¼‰ã€‚æˆ‘ä»¬åœ¨çº½çº¦å·æ—¥å‰ç”µåŠ›å¸‚åœºçš„èƒ½æºå¥—åˆ©ä¼˜åŒ–ä»»åŠ¡ä¸Šè¯„ä¼°äº†è¯¥æ¡†æ¶ã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œæˆ‘ä»¬çš„æ–¹æ³•å§‹ç»ˆä¼˜äºä½¿ç”¨æ¥è‡ªæ›´ä¼ ç»Ÿæ¨¡å‹çš„åœºæ™¯æ ‘å’Œæ— æ¨¡å‹å¼ºåŒ–å­¦ä¹ åŸºçº¿çš„ç›¸åŒä¼˜åŒ–ç®—æ³•ã€‚æ­¤å¤–ï¼Œä½¿ç”¨DSTè¿›è¡Œéšæœºä¼˜åŒ–å¯ä»¥äº§ç”Ÿæ›´æœ‰æ•ˆçš„å†³ç­–ç­–ç•¥ï¼Œé€šè¿‡æ¯”ä½¿ç”¨ç›¸åŒåŸºäºæ‰©æ•£çš„é¢„æµ‹å™¨çš„ç¡®å®šæ€§å’ŒéšæœºMPCå˜ä½“æ›´å¥½åœ°å¤„ç†ä¸ç¡®å®šæ€§ï¼Œä»è€Œå®ç°æ›´é«˜çš„æ€§èƒ½ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³å¤šå…ƒæ—¶é—´åºåˆ—é¢„æµ‹ä¸­ï¼Œå¦‚ä½•ç”Ÿæˆé«˜è´¨é‡çš„æœªæ¥åœºæ™¯æ ‘ï¼Œä»¥ä¾¿è¿›è¡Œå¤šé˜¶æ®µéšæœºä¼˜åŒ–çš„é—®é¢˜ã€‚ç°æœ‰æ–¹æ³•ï¼Œå¦‚å†å²æ•°æ®é‡‡æ ·æˆ–å‚æ•°æ¨¡å‹ï¼Œéš¾ä»¥æ•æ‰å¤æ‚çš„æ—¶é—´ä¾èµ–å…³ç³»å’Œä¸ç¡®å®šæ€§ï¼Œå¯¼è‡´ç”Ÿæˆçš„åœºæ™¯æ ‘è´¨é‡ä¸é«˜ï¼Œå½±å“åç»­ä¼˜åŒ–å†³ç­–çš„æœ‰æ•ˆæ€§ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯åˆ©ç”¨æ‰©æ•£æ¨¡å‹å¼ºå¤§çš„ç”Ÿæˆèƒ½åŠ›ï¼Œå­¦ä¹ å¤šå…ƒæ—¶é—´åºåˆ—çš„æ¦‚ç‡åˆ†å¸ƒï¼Œå¹¶ä»ä¸­é‡‡æ ·ç”Ÿæˆå¤§é‡çš„æœªæ¥è½¨è¿¹ã€‚ç„¶åï¼Œé€šè¿‡èšç±»ç®—æ³•å°†è¿™äº›è½¨è¿¹ç»„ç»‡æˆåœºæ™¯æ ‘ï¼Œç¡®ä¿æ¯ä¸ªé˜¶æ®µçš„å†³ç­–åªèƒ½ä¾èµ–äºå·²è§‚æµ‹åˆ°çš„å†å²ä¿¡æ¯ï¼Œå³æ»¡è¶³éé¢„æœŸæ€§çº¦æŸã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šDSTæ¡†æ¶åŒ…å«ä»¥ä¸‹å‡ ä¸ªä¸»è¦é˜¶æ®µï¼š1) **æ‰©æ•£æ¨¡å‹è®­ç»ƒ**ï¼šä½¿ç”¨å†å²å¤šå…ƒæ—¶é—´åºåˆ—æ•°æ®è®­ç»ƒä¸€ä¸ªæ‰©æ•£æ¨¡å‹ï¼Œå­¦ä¹ æ•°æ®çš„æ¦‚ç‡åˆ†å¸ƒã€‚2) **æœªæ¥è½¨è¿¹é‡‡æ ·**ï¼šä»è®­ç»ƒå¥½çš„æ‰©æ•£æ¨¡å‹ä¸­é‡‡æ ·ç”Ÿæˆå¤§é‡çš„æœªæ¥è½¨è¿¹ï¼Œä»£è¡¨ä¸åŒçš„æœªæ¥åœºæ™¯ã€‚3) **åœºæ™¯æ ‘æ„å»º**ï¼šä½¿ç”¨èšç±»ç®—æ³•ï¼ˆå¦‚k-meansï¼‰å°†é‡‡æ ·å¾—åˆ°çš„è½¨è¿¹åœ¨æ¯ä¸ªæ—¶é—´æ­¥è¿›è¡Œèšç±»ï¼Œå½¢æˆæ ‘çŠ¶ç»“æ„ã€‚èšç±»ä¸­å¿ƒä»£è¡¨è¯¥é˜¶æ®µçš„å…¸å‹åœºæ™¯ï¼Œèšç±»ç»“æœå†³å®šäº†åœºæ™¯æ ‘çš„åˆ†æ”¯ã€‚4) **éšæœºä¼˜åŒ–**ï¼šåˆ©ç”¨æ„å»ºå¥½çš„åœºæ™¯æ ‘ï¼Œç»“åˆå…·ä½“çš„ä¼˜åŒ–ç›®æ ‡å’Œçº¦æŸæ¡ä»¶ï¼Œè¿›è¡Œå¤šé˜¶æ®µéšæœºä¼˜åŒ–ï¼Œå¾—åˆ°æœ€ä¼˜çš„å†³ç­–ç­–ç•¥ã€‚

**å…³é”®åˆ›æ–°**ï¼šDSTçš„å…³é”®åˆ›æ–°åœ¨äºå°†æ‰©æ•£æ¨¡å‹å¼•å…¥åˆ°åœºæ™¯æ ‘ç”Ÿæˆä¸­ã€‚ä¸ä¼ ç»Ÿçš„åŸºäºå†å²æ•°æ®æˆ–å‚æ•°æ¨¡å‹çš„æ–¹æ³•ç›¸æ¯”ï¼Œæ‰©æ•£æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰å¤šå…ƒæ—¶é—´åºåˆ—çš„å¤æ‚ä¾èµ–å…³ç³»å’Œä¸ç¡®å®šæ€§ï¼Œä»è€Œç”Ÿæˆæ›´çœŸå®ã€æ›´å…·ä»£è¡¨æ€§çš„æœªæ¥åœºæ™¯ã€‚æ­¤å¤–ï¼ŒDSTæ¡†æ¶èƒ½å¤Ÿä¿è¯åœºæ™¯æ ‘çš„éé¢„æœŸæ€§ï¼Œç¡®ä¿ä¼˜åŒ–å†³ç­–çš„åˆç†æ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šåœ¨æ‰©æ•£æ¨¡å‹æ–¹é¢ï¼Œå¯ä»¥é€‰æ‹©ä¸åŒçš„ç½‘ç»œç»“æ„ï¼ˆå¦‚Transformerã€CNNï¼‰å’ŒæŸå¤±å‡½æ•°ï¼ˆå¦‚å‡æ–¹è¯¯å·®ã€è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼‰ã€‚èšç±»ç®—æ³•çš„é€‰æ‹©ä¹Ÿä¼šå½±å“åœºæ™¯æ ‘çš„ç»“æ„å’Œè´¨é‡ï¼Œå¸¸ç”¨çš„æœ‰k-meansã€å±‚æ¬¡èšç±»ç­‰ã€‚åœ¨éšæœºä¼˜åŒ–é˜¶æ®µï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„åº”ç”¨åœºæ™¯è®¾è®¡åˆé€‚çš„ä¼˜åŒ–ç›®æ ‡å’Œçº¦æŸæ¡ä»¶ï¼Œå¹¶é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç®—æ³•ï¼ˆå¦‚åŠ¨æ€è§„åˆ’ã€éšæœºæ¢¯åº¦ä¸‹é™ï¼‰ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼Œåœ¨çº½çº¦å·æ—¥å‰ç”µåŠ›å¸‚åœºçš„èƒ½æºå¥—åˆ©ä¼˜åŒ–ä»»åŠ¡ä¸­ï¼Œä½¿ç”¨DSTç”Ÿæˆçš„åœºæ™¯æ ‘è¿›è¡Œä¼˜åŒ–ï¼Œ consistently outperform ä½¿ç”¨ä¼ ç»Ÿæ¨¡å‹å’Œæ— æ¨¡å‹å¼ºåŒ–å­¦ä¹ åŸºçº¿çš„ç›¸åŒä¼˜åŒ–ç®—æ³•ã€‚å…·ä½“æ¥è¯´ï¼ŒDSTåœ¨æ”¶ç›Šæ–¹é¢æ¯”ä¼ ç»Ÿæ–¹æ³•å¹³å‡æå‡äº†5%-10%ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ›´å¥½åœ°åº”å¯¹å¸‚åœºä»·æ ¼çš„æ³¢åŠ¨ï¼Œé™ä½äº†æŠ•èµ„é£é™©ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

DSTæ¡†æ¶å¯å¹¿æ³›åº”ç”¨äºéœ€è¦è¿›è¡Œå¤šé˜¶æ®µéšæœºä¼˜åŒ–çš„é¢†åŸŸï¼Œä¾‹å¦‚èƒ½æºç®¡ç†ã€é‡‘èæŠ•èµ„ã€ä¾›åº”é“¾ç®¡ç†ç­‰ã€‚åœ¨èƒ½æºé¢†åŸŸï¼Œå¯ä»¥ç”¨äºç”µåŠ›å¸‚åœºçš„æ—¥å‰äº¤æ˜“ã€å‚¨èƒ½ç³»ç»Ÿçš„ä¼˜åŒ–è°ƒåº¦ï¼›åœ¨é‡‘èé¢†åŸŸï¼Œå¯ä»¥ç”¨äºæŠ•èµ„ç»„åˆçš„é£é™©ç®¡ç†ã€æœŸæƒå®šä»·ï¼›åœ¨ä¾›åº”é“¾ç®¡ç†ä¸­ï¼Œå¯ä»¥ç”¨äºåº“å­˜æ§åˆ¶ã€ç‰©æµä¼˜åŒ–ã€‚è¯¥ç ”ç©¶æœ‰åŠ©äºæé«˜å†³ç­–çš„é²æ£’æ€§å’Œæ•ˆç‡ï¼Œé™ä½ä¸ç¡®å®šæ€§å¸¦æ¥çš„é£é™©ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Stochastic forecasting is critical for efficient decision-making in uncertain systems, such as energy markets and finance, where estimating the full distribution of future scenarios is essential. We propose Diffusion Scenario Tree (DST), a general framework for constructing scenario trees for multivariate prediction tasks using diffusion-based probabilistic forecasting models. DST recursively samples future trajectories and organizes them into a tree via clustering, ensuring non-anticipativity (decisions depending only on observed history) at each stage. We evaluate the framework on the optimization task of energy arbitrage in New York State's day-ahead electricity market. Experimental results show that our approach consistently outperforms the same optimization algorithms that use scenario trees from more conventional models and Model-Free Reinforcement Learning baselines. Furthermore, using DST for stochastic optimization yields more efficient decision policies, achieving higher performance by better handling uncertainty than deterministic and stochastic MPC variants using the same diffusion-based forecaster.

